---
output:
  xaringan::moon_reader:
    seal: false
    lib_dir: libs
    css: 
      - default
      - default-fonts
      - duke-blue
      - hygge-duke
      - libs/cc-fonts.css
      - libs/figure-captions.css
    nature:
      highlightStyle: github
      highlightLines: true
      countIncrementalSlides: false
---
background-image: url("pic/slide-front-page.jpg")
class: center,middle

# è®¡é‡ç»æµå­¦(Econometrics)

### èƒ¡åå¹³

### è¥¿åŒ—å†œæ—ç§‘æŠ€å¤§å­¦

### ç»æµç®¡ç†å­¦é™¢æ•°é‡ç»æµæ•™ç ”å®¤

### huhuaping01@hotmail.com

### `r Sys.Date()`

```{r global_options, echo=F,message=FALSE,warning=F}
knitr::opts_chunk$set(fig.align='center',echo = FALSE,message = FALSE,fig.width=10, fig.height=6) # Places figures on their own pages
options(
  htmltools.dir.version = FALSE, 
  formatR.indent = 2, width = 55, 
  digits = 2,scipen=999,tinytex.verbose = TRUE,
  knitr.kable.NA = '',
  echo=FALSE, warning=FALSE, message=FALSE)
library('bookdown')
library('knitr')
library('xlsx')
library("openxlsx")
#install.packages('tidyr')
#install.packages('plyr')
library('tidyr')
library('dplyr')
library('stringr')
library('tidyverse')
library('ggplot2')
library("scales")
#install.packages("gridExtra")
library("gridExtra")
#install.packages("magrittr")
library("magrittr")
#install.packages("ggthemes")
#install.packages("ggrepel")
require("ggthemes")
require("ggrepel")
require("lubridate")
require("DT")
require("wooldridge")
require("png")
require("jpeg")
require("latex2exp")
#require(kableExtra)
```

```{r ex-math-eq}
source("external-math-equation.R")
```

<style type="text/css">
.remark-slide-content {
    font-size: 22px;
    padding: 1em 4em 1em 4em;
}
</style>

---
class: center, middle,inverse
# ç¬¬2ç« ï¼šä¸€å…ƒå›å½’çš„åŸºæœ¬æ€æƒ³

## å†…å®¹ç›®å½•

.pull-left[
â€œå›å½’â€çš„å†å²æ¸Šæº

æœ¯è¯­ä¸ç¬¦å·

æ•°æ®çš„ç±»å‹å’Œæ€§è´¨

ä¸€ä¸ªå‡æƒ³çš„å¾®å‹æ€»ä½“

ä¸€äº›é‡è¦çš„æ¦‚å¿µ
]
.pull-right[

æ€»ä½“å›å½’çº¿

æ€»ä½“å›å½’å‡½æ•°

æ€»ä½“å›å½’æ¨¡å‹

æ ·æœ¬å›å½’çº¿

æ ·æœ¬å›å½’å‡½æ•°

æ ·æœ¬å›å½’æ¨¡å‹
]

---
# â€œå›å½’â€çš„å†å²æ¸Šæº

é«˜å°”é¡¿çš„å‘ç°:

- çˆ¶æ¯é«˜ï¼Œå„¿å¥³ä¹Ÿé«˜ï¼›çˆ¶æ¯çŸ®ï¼Œå„¿å¥³ä¹ŸçŸ®

- ä½†ç»™å®šçˆ¶æ¯çš„èº«é«˜ï¼Œå„¿å¥³çš„å¹³å‡èº«é«˜å´è¶‹å‘äºæˆ–è€…"å›å½’"åˆ°å…¨ä½“äººå£çš„å¹³å‡èº«é«˜ã€‚

çš®å°”é€Šçš„è¯å®:

- æ”¶é›†ä¸€äº›å®¶åº­ç¾¤ä½“çš„ä¸€åƒå¤šåæˆå‘˜çš„èº«é«˜è®°å½•ã€‚

- ä¸¤ç»„æ ·æœ¬ï¼šçˆ¶äº²é«˜çš„ç¾¤ä½“VSçˆ¶äº²çŸ®çš„ç¾¤ä½“

    - çˆ¶äº²é«˜çš„ç¾¤ä½“ï¼Œå­è¾ˆå¹³å‡èº«é«˜è¦ä½äºå…¶çˆ¶è¾ˆï¼›
    
    - çˆ¶äº²çŸ®çš„ç¾¤ä½“ï¼Œå­è¾ˆå¹³å‡èº«é«˜è¦é«˜äºå…¶çˆ¶è¾ˆã€‚

â€˜å›å½’åˆ°ä¸­ç­‰â€™(regression to mediocrity)çš„è¶‹åŠ¿ï¼Œå›å½’ç”±æ­¤è€Œå¾—å

---
# â€œå›å½’â€çš„ç°ä»£è§£é‡Š

æˆ‘ä»¬ç°åœ¨å¯èƒ½å…³å¿ƒçš„æ˜¯è¿™æ ·ä¸€ä¸ªé—®é¢˜ï¼šç»™å®šçˆ¶è¾ˆèº«é«˜ï¼Œå­è¾ˆèº«é«˜æ˜¯æ€æ ·çš„ã€‚

å›å½’åˆ†æçš„æœ¬è´¨ï¼šæ˜¯å…³äºç ”ç©¶åº”å˜é‡å¯¹å¦ä¸€ä¸ªæˆ–å¤šä¸ªè§£é‡Šå˜é‡çš„ä¾èµ–å…³ç³»ï¼Œå…¶ç”¨æ„åœ¨äºï¼šé€šè¿‡è§£é‡Šå˜é‡ï¼ˆåœ¨é‡å¤æŠ½æ ·ä¸­ï¼‰çš„å·²çŸ¥æˆ–è®¾å®šå€¼ï¼Œå»ä¼°è®¡å’Œï¼ˆæˆ–ï¼‰é¢„æµ‹åº”å˜é‡ï¼ˆæ€»ä½“ï¼‰å‡å€¼ã€‚

---
class: duke-softblue

## æ¡ˆä¾‹è¯´æ˜ï¼šå­è¾ˆèº«é«˜

- ç»™å®šçˆ¶äº²èº«é«˜ï¼Œåœ¨ä¸€ä¸ªå‡æƒ³äººå£æ€»ä½“ä¸­çš„å­è¾ˆèº«é«˜åˆ†å¸ƒã€‚

```{r, fig.cap= "ç»™å®šçˆ¶äº²èº«é«˜æ—¶å„¿å­èº«é«˜çš„å‡æƒ³åˆ†å¸ƒ"}
include_graphics("pic/chpt2-1-case1-height.png",dpi=120)
```

---
class: duke-softblue
## æ¡ˆä¾‹è¯´æ˜ï¼šå¹´é¾„èº«é«˜

- ç»™å®šå¹´é¾„ï¼Œç”·å­©å­èº«é«˜æ€»ä½“çš„åˆ†å¸ƒã€‚

```{r, fig.cap= "å¯¹åº”äºé€‰å®šå¹´é¾„çš„å‡æƒ³èº«é«˜åˆ†å¸ƒ"}
include_graphics("pic/chpt2-1-case2-age.png", dpi=120)
```

---
class: duke-softblue

## æ¡ˆä¾‹è¯´æ˜ï¼šæ¶ˆè´¹å‡½æ•°

ç»™å®šç¨åæˆ–å¯æ”¯é…æ”¶å…¥ï¼Œä¸ªäººæ¶ˆè´¹æ˜¯å¦‚ä½•åˆ†å¸ƒçš„ã€‚è¿™ç§åˆ†ææœ‰åŠ©äºä¼°è®¡è¾¹é™…æ¶ˆè´¹å€¾å‘ï¼ˆMPCï¼‰ï¼Œå°±æ˜¯å®é™…æ”¶å…¥æ¯ç¾å…ƒä»·å€¼çš„å˜åŒ–æ‰€å¼•èµ·çš„æ¶ˆè´¹æ”¯å‡ºçš„å¹³å‡å˜åŒ–ã€‚

```{r, fig.cap="çº¿æ€§å½¢å¼çš„å‡¯æ©æ–¯æ¶ˆè´¹æ¨¡å‹"}
include_graphics("pic/chp1-model-eco.png",dpi=120)
```

---
class: duke-softblue

## æ¡ˆä¾‹è¯´æ˜ï¼šè´§å¸å·¥èµ„

å¤±ä¸šç‡æ˜¯æ€æ ·å½±å“è´§å¸å·¥èµ„å˜åŒ–çš„ã€‚

```{r, fig.cap="å‡æƒ³çš„è²åˆ©æ™®æ–¯æ›²çº¿"}
include_graphics("pic/chpt2-1-case3-philips-curve.png",dpi=120)
```

---
class: duke-softblue

## æ¡ˆä¾‹è¯´æ˜ï¼šè´§å¸æŒæœ‰

é€šè´§è†¨èƒ€ç‡å¦‚ä½•å½±å“äººä»¬ä»¥è´§å¸å½¢å¼æŒæœ‰çš„æ”¶å…¥æ¯”ä¾‹çš„å˜åŒ–ã€‚æ ¹æ®è´§å¸ç»æµå­¦ï¼Œå…¶ä»–æ¡ä»¶ä¸å˜ï¼Œé€šè´§è†¨èƒ€ç‡
$\pi$è¶Šé«˜ï¼Œäººä»¬æ„¿æ„ä»¥è´§å¸å½¢å¼æŒæœ‰çš„æ”¶å…¥æ¯”ä¾‹
$k$è¶Šä½


```{r, fig.cap="è´§å¸æŒæœ‰ä¸é€šè´§è†¨èƒ€ç‡çš„å…³ç³»"}
include_graphics("pic/chpt2-1-case4-inflation.png",dpi=120)
```

---
# æœ¯è¯­ä¸ç¬¦å·ï¼šXå’ŒY

```{r}
name_list <- tribble(
  ~Y,	~X,
"åº”å˜é‡(Dependent variable)",	"è§£é‡Šå˜é‡(Explanatory variable)",
"è¢«è§£é‡Šå˜é‡(Explained variable)",	"è‡ªå˜é‡(Independent variable)",
"é¢„æµ‹å­(Predictand)",	"é¢„æµ‹å…ƒ(Predictor)",
"å›å½’å­(Regressand)",	"å›å½’å…ƒ(Regressor)",
"å“åº”å˜é‡(Response variable)",	"åˆºæ¿€å˜é‡ (Stimulus  variable)",
"å†…ç”Ÿ(Endogenous)",	"å¤–ç”Ÿ(Exogenous)",
"ç»“æœå˜é‡(Outcome)",	"åå˜é‡(Covariate)",
"è¢«æ§å˜é‡(Controlled variable)",	"æ§åˆ¶å˜é‡(Control variable)"
)

# datatable(name_list, options = list(pageLength =8, dom  = 'tip'))

kable(name_list, caption="Xå’ŒYçš„å„ç§æœ¯è¯­çº¦å®š")
```

---
# æœ¯è¯­ä¸ç¬¦å·ï¼šï¼Ÿå…ƒå›å½’

åŒå˜é‡å›å½’åˆ†æ(two-variable regression analysis)ï¼š

- ç ”ç©¶ä¸€ä¸ªå˜é‡å¯¹ä»…ä»…ä¸€ä¸ªè§£é‡Šå˜é‡çš„ä¾èµ–å…³ç³»

- å¦‚æ¶ˆè´¹æ”¯å‡ºå¯¹å®é™…æ”¶å…¥çš„ä¾èµ–å…³ç³»

å¤šå…ƒå›å½’åˆ†æ(multiple regression analysis)ï¼š

- ç ”ç©¶ä¸€ä¸ªå˜é‡å¯¹å¤šäºä¸€ä¸ªè§£é‡Šå˜é‡çš„ä¾èµ–å…³ç³»

- å¦‚å†œä½œç‰©æ”¶æˆä¾èµ–äºæ°”æ¸©ã€é™é›¨é‡ã€é˜³å…‰å’Œæ–½è‚¥é‡ç­‰ï¼›

---

# æœ¯è¯­ä¸ç¬¦å·ï¼šæ¨¡å‹ç¬¦å·

æ¨¡å‹ç¬¦å·ï¼š

- å› å˜é‡ï¼š
$Y$ï¼Œå…·ä½“è®°ä¸º
$Y_i$,

- è§£é‡Šå˜é‡ï¼š
$X$ï¼Œè®°ä¸º
$X_1,X_2,\cdots,X_k$.
    - 
    $X_k$å…·ä½“è®°ä¸ºï¼š
    $X_{k1},X_{k2},\cdots,X_{kn}$.
    - 
    $X_k$ä»£è¡¨ç¬¬
    $k$ä¸ªè§£é‡Šå˜é‡ï¼Œä¸‹æ ‡
    $i$ï¼ˆæˆ–
    $t$ï¼‰åˆ™è¡¨ç¤ºç¬¬
    $i$ï¼ˆæˆ–
    $t$ï¼‰ä¸ªè§‚æµ‹å€¼ã€‚

---

# æœ¯è¯­ä¸ç¬¦å·ï¼šæƒ…æ™¯ç¬¦å·

æƒ…å¢ƒç¬¦å·ï¼š

- æ€»ä½“å®¹é‡ï¼šå³æ€»ä½“ä¸­çš„è§‚æµ‹å€¼æ€»ä¸ªæ•°

    - 
    $N$ï¼ˆæ¨ªæˆªé¢æ•°æ®ä¸‹ä½¿ç”¨ï¼‰
    
    - 
    $T$ï¼ˆæ—¶é—´åºåˆ—æ•°æ®ä¸‹ä½¿ç”¨ï¼‰

- æ ·æœ¬å®¹é‡ï¼šå³æ ·æœ¬ä¸­çš„è§‚æµ‹å€¼æ€»ä¸ªæ•°

    - 
    $n$ï¼ˆæ¨ªæˆªé¢æ•°æ®ä¸‹ä½¿ç”¨ï¼‰
    - 
    $t$ï¼ˆæ—¶é—´åºåˆ—æ•°æ®ä¸‹ä½¿ç”¨ï¼‰

æ¨ªæˆªé¢æ•°æ®(cross-sectional data)ï¼šç”¨è§‚æµ‹å€¼ä¸‹æ ‡iæ¥è¡¨ç¤ºï¼Œè¿™æ˜¯æŒ‡åœ¨ä¸€ä¸ªæ—¶é—´ç‚¹ä¸Šæœé›†çš„æ•°æ®ã€‚
æ—¶é—´åºåˆ—æ•°æ®(time series data)ï¼Œç”¨ä¸‹æ ‡tæ¥è¡¨ç¤ºï¼Œè¿™æ˜¯ä¸€ä¸ªæ—¶æœŸå†…æ”¶é›†çš„æ•°æ®ã€‚

---

# æœ¯è¯­ä¸ç¬¦å·ï¼šä¸¤å¥—ä½“ç³»

æå­å¥ˆçš„kå…ƒå›å½’ï¼š

$$\begin{align}
Y_i &=  \beta_0 +\beta_1X_{i1} +\beta_2X_{i2} + \cdots +\beta_kX_{ik}+ u_i 
\end{align}$$

å¤æ‰æ‹‰è’‚çš„kå˜é‡å›å½’ï¼š

$$\begin{align}
Y_i &=  \beta_1 +\beta_2X_{2i} +\beta_3X_{3i} + \cdots +\beta_kX_{ki}+ u_i
\end{align}$$



---
class: inverse, middle, center
# æ•°æ®çš„ç±»å‹

---

## Type1ï¼šæ—¶é—´åºåˆ—æ•°æ®(time series data)ï¼š

æ—¶é—´åºåˆ—æ•°æ®ï¼šå¯¹ä¸€ä¸ªå˜é‡åœ¨ä¸åŒæ—¶é—´å–å€¼çš„ä¸€ç»„è§‚æµ‹ç»“æœã€‚

- å®æ—¶ç‰Œä»·ï¼šå¦‚è‚¡ç¥¨ä»·æ ¼

- æ¯æ—¥(dailyï¼‰ï¼šå¦‚å¤©æ°”é¢„æŠ¥

- æ¯å‘¨(weeklyï¼‰ï¼šå¦‚è´§å¸ä¾›ç»™æ•°å­—

- æ¯æœˆ(monthlyï¼‰ï¼šå¦‚å¤±ä¸šç‡å’Œæ¶ˆè´¹è€…ä»·æ ¼æŒ‡æ•°

- æ¯å­£åº¦(quarterlyï¼‰ï¼šå¦‚GDP

- æ¯å¹´(annuallyï¼‰ï¼šå¦‚æ”¿åºœé¢„ç®—

- æ¯5 å¹´(quinquenniallyï¼‰ï¼šå¦‚åˆ¶é€ ä¸šæ™®æŸ¥èµ„æ–™

- æ¯10 å¹´( decenniallyï¼‰ï¼šå¦‚äººå£æ™®æŸ¥èµ„æ–™

---

## Type1ï¼šæ—¶é—´åºåˆ—æ•°æ®(time series data)ï¼š

å¹³ç¨³æ€§(stationary)ï¼šå¦‚æœä¸€ä¸ªæ—¶é—´åºåˆ—çš„å‡å€¼å’Œæ–¹å·®ä¸éšæ—¶é—´è€Œç³»ç»Ÿåœ°å˜åŒ–ï¼Œé‚£å®ƒå°±æ˜¯å¹³ç¨³çš„(stationary) ã€‚

```{r, fig.cap="1951å¹´1æœˆ-1999å¹´9æœˆç¾å›½çš„M1è´§å¸ä¾›ç»™"}
include_graphics("pic/chpt2-1-data-series-M1.png", dpi=120)
```

---
## Type2ï¼šæˆªé¢æ•°æ®(cross-section data)ï¼š

æ¨ªæˆªé¢æ•°æ®ï¼šå¯¹ä¸€ä¸ªæˆ–å¤šä¸ªå˜é‡åœ¨åŒä¸€æ—¶é—´ç‚¹ä¸Šæ”¶é›†çš„æ•°æ®

å¼‚è´¨æ€§(heterogeneity) ï¼šå½“æˆ‘ä»¬çš„ç»Ÿè®¡åˆ†æåŒ…å«æœ‰å¼‚è´¨çš„å•ä½æ—¶ï¼Œæˆ‘ä»¬å¿…é¡»è€ƒè™‘å°ºåº¦(size)æˆ–è§„æ¨¡æ•ˆåº”(scale effect) ä»¥é¿å…é€ æˆæ··ä¹±ã€‚

---

### æ¡ˆä¾‹ï¼šé¸¡è›‹ä»·æ ¼ä¸é¸¡è›‹äº§é‡

```{r}
eggs <- as.tibble(read.xlsx("data/Table-1-1-eggs.xlsx"))
eggs %>%
  select(STATE, Y1, X1) %>%
  datatable(options = list(pageLength=5, dom="tip"),
            caption = "ç¾å›½50ä¸ªå·çš„è›‹ç±»ç”Ÿäº§å’Œä»·æ ¼æ•°æ®")
```

å…¶ä¸­ï¼Œ
$Y_1$ä»£è¡¨1990å¹´é¸¡è›‹äº§é‡(ç™¾ä¸‡ä¸ª)ï¼›
$X_1$ä»£è¡¨1990å¹´æ¯æ‰“é¸¡è›‹çš„ä»·æ ¼(ç¾åˆ†/æ‰“)ã€‚

---

### æ¡ˆä¾‹ï¼šé¸¡è›‹ä»·æ ¼ä¸é¸¡è›‹äº§é‡


```{r, fig.cap= "1990å¹´è›‹äº§é‡ä¸ä»·æ ¼çš„å…³ç³»",fig.height=6, fig.width=10}
eggs %>%
  select(STATE, X1, Y1) %>%
  ggplot(aes(x=Y1, y=X1)) +
  geom_point(color="blue", size=2) +
  theme(text = element_text(size=16)) +
  labs(x="é¸¡è›‹äº§é‡(ç™¾ä¸‡ä¸ª)", y="é¸¡è›‹ä»·æ ¼(ç¾åˆ†/æ‰“)")

```

.content-box-blue[æ€è€ƒæé—®ï¼š]

???

- å›¾ä¸­ç‰¹å¾ç¬¦åˆç»æµå­¦ç†è®ºä¹ˆï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ

- å›¾ä¸­åæ˜ äº†æ•°æ®å¯èƒ½å­˜åœ¨å“ªäº›æ½œåœ¨é—®é¢˜ï¼Ÿ


---
## Type3ï¼šé¢æ¿æ•°æ®(Panel Data)

é¢æ¿æ•°æ®ï¼šæ˜¯å…¼æœ‰æ—¶é—´åºåˆ—å’Œæ¨ªæˆªé¢æ•°æ®ä¸¤ç§æˆä»½ï¼ŒæŒ‡å¯¹ç›¸åŒçš„æ¨ªæˆªé¢å•å…ƒåœ¨æ—¶é—´è½´ä¸Šè¿›è¡Œè·Ÿè¸ªè°ƒæŸ¥çš„æ•°æ®ã€‚

- å¹³è¡¡é¢æ¿(balanced panel)ï¼šæ‰€æœ‰æˆªé¢å•å…ƒéƒ½å…·æœ‰ç›¸åŒçš„è§‚æµ‹æ¬¡æ•°

- éå¹³è¡¡é¢æ¿(unbalanced panel)ï¼šå¹¶éæ‰€æœ‰æˆªé¢å•å…ƒéƒ½å…·æœ‰ç›¸åŒçš„è§‚æµ‹æ¬¡æ•°

æ•°æ®ç‚¹ï¼ˆè§‚æµ‹æ•°ï¼‰
$n$ï¼š

- æ•°æ®ç‚¹ï¼ˆè§‚æµ‹æ•°ï¼‰=æˆªé¢å•å…ƒæ•°*æ—¶æœŸæ•°

- 
$n=q*t$

å¯èƒ½å­˜åœ¨çš„é—®é¢˜ï¼š

- â€œå¹³ç¨³æ€§â€é—®é¢˜ï¼š

- â€œå¼‚æ–¹å·®â€é—®é¢˜ï¼š

---

### æ¡ˆä¾‹ï¼šé’¢é“å…¬å¸

ä¸¤å®¶é’¢é“å…¬å¼çš„æ•°æ®æ¡ˆä¾‹ï¼š

- å…¬å¸ï¼šGE=é€šç”¨å…¬å¸ï¼›US=ç¾å›½é’¢é“

- I=çœŸå®æ€»æŠ•èµ„ï¼ˆç™¾ä¸‡ç¾å…ƒï¼‰

- F=å‰ä¸€å¹´çš„ä¼ä¸šçœŸå®ä»·å€¼ ï¼ˆç™¾ä¸‡ç¾å…ƒï¼‰

- C=å‰ä¸€å¹´çš„çœŸå®èµ„æœ¬å­˜é‡ï¼ˆç™¾ä¸‡ç¾å…ƒï¼‰


```{r}
steel <- as.tibble(read.xlsx("data/Table-1-2-steel.xlsx"))
steel_wide <-steel %>%
  filter(company =="US"| company =="GE") %>%
  gather(key= "var", value="value",I:C) %>%
  unite(col="var", company, var, sep=".") %>%
  spread(key=var, value= value, sep= "_") 

names(steel_wide)<- c("year",
                           "GE.C", "GE.F", "GE.I", 
                           "US.C", "US.F", "US.I")
steel_long <-steel %>%
  filter(company =="US"| company =="GE") 
  
```

---

### æ¡ˆä¾‹ï¼šé’¢é“å…¬å¸

æ‰æ•°æ®å½¢å¼ï¼š

```{r}
datatable(steel_wide, 
          options = list(pageLength=7, dom="tip"),
          caption = "1935-1954å¹´é—´ç¾å›½ä¸¤å¤§é’¢é“å…¬å¸çš„æ•°æ®(æ‰æ•°æ®)")
```

---

### æ¡ˆä¾‹ï¼šé’¢é“å…¬å¸

```{r, fig.cap="ä¸¤å®¶å…¬å¸çš„ä¼ä¸šæŠ•èµ„æƒ…å†µ"}
ggplot(data = steel_long, 
       aes(x=year, y=I, group=company,color=company)) +
  geom_line()+
  geom_point() +
  labs(x="å¹´ä»½", y="ä¼ä¸šæŠ•èµ„ï¼ˆç™¾ä¸‡ç¾å…ƒï¼‰")
```

---

### æ¡ˆä¾‹ï¼šé’¢é“å…¬å¸

é•¿æ•°æ®å½¢å¼ï¼š

```{r}
datatable(steel_long, 
          options = list(pageLength=7, dom="tip"),
          caption = "1935-1954å¹´é—´ç¾å›½ä¸¤å¤§é’¢é“å…¬å¸çš„æ•°æ®(é•¿æ•°æ®)")
```


---

### æ¡ˆä¾‹ï¼šé’¢é“å…¬å¸

ç¼ºå¤±éƒ¨åˆ†æ•°æ®ï¼š

```{r}
steel_wide %>%
  mutate(US.C=ifelse(year %in% c(1940,1953), NA, US.C),
         US.F=ifelse(year %in% c(1940,1953), NA, US.F),
         US.I=ifelse(year %in% c(1940,1953), NA, US.I)) %>%
  datatable(options = list(pageLength=7, dom="tip"),
          caption = "1935-1954å¹´é—´ç¾å›½ä¸¤å¤§é’¢é“å…¬å¸çš„æ•°æ®(ç¼ºå¤±éƒ¨åˆ†æ•°æ®)")
```

.content-box-blue[è¯¾å ‚æµ‹è¯•ï¼š]

???

- é—®1ï¼šå¹³è¡¡é¢æ¿è¿˜æ˜¯éå¹³è¡¡é¢æ¿ï¼Ÿ

- é—®2ï¼šå¤šå°‘æ•°æ®ç‚¹ï¼Ÿ

- é—®3ï¼šä¸¤ä¸ªå…¬å¸æŠ•èµ„å‡½æ•°æ˜¯å¦ç›¸åŒï¼Ÿ

---
class: inverse, middle, center
# æ•°æ®çš„æ€§è´¨å’Œå±‚æ¬¡

---

## åä¹‰å°ºåº¦(nominal scale) 

åä¹‰å°ºåº¦å˜é‡åªè¡¨ç¤ºä¸åŒçš„ç±»åˆ«ï¼Œå®ƒä¸èƒ½åŠ å‡ä¹˜é™¤ï¼Œä¹Ÿä¸èƒ½æ¯”è¾ƒå¤§å°ã€‚

- å¦‚æ€§åˆ«(ç”·ã€å¥³ï¼‰å’Œå©šå§»çŠ¶å†µï¼ˆå·²å©šã€æœªå©šã€ç¦»å©šã€åˆ†å±…ï¼‰ä¹‹ç±»çš„å˜é‡ã€‚

---

## åºæ•°å°ºåº¦(ordinal scale)

åä¹‰å°ºåº¦å˜é‡åªèƒ½æ¯”è¾ƒå¤§å°(å³è‡ªç„¶é¡ºåº)ï¼Œä¸èƒ½åŠ å‡ä¹˜é™¤ã€‚

- äº”åˆ†é‡è¡¨

```{r, fig.cap="æå…‹ç‰¹é‡è¡¨"}
include_graphics("pic/chpt2-1-data-scale-order1.png", dpi=60)
```

---

## åºæ•°å°ºåº¦(ordinal scale)

- æ— å·®å¼‚æ›²çº¿

```{r, fig.cap="ä¸¤ç§å•†å“æ¶ˆè´¹ä¸‹çš„æ— å·®å¼‚æ›²çº¿"}
include_graphics("pic/chpt2-1-data-scale-order-curve.png", dpi=60)
```

---

## åŒºé—´å°ºåº¦( interval scale) 

åŒºé—´å°ºåº¦å˜é‡æ¯”ç‡å°ºåº¦å˜é‡å¯ä»¥æ¯”è¾ƒå¤§å°ï¼Œä¹Ÿèƒ½åŠ å‡ï¼Œä½†ä¸èƒ½ä¹˜é™¤ã€‚ã€‚

- ä¸¤ä¸ªæ—¶æœŸä¹‹å†…çš„è·ç¦»(å¦‚2000 â€“ 1995)æ˜¯æœ‰æ„ä¹‰çš„ï¼Œä½†ä¸¤ä¸ªæ—¶æœŸçš„æ¯”ç‡(2000/1995) å°±æ²¡æœ‰ä»€ä¹ˆæ„ä¹‰ã€‚

- 2013å¹´8 æœˆ11 æ—¥ä¸Šåˆ11ç‚¹å¤©æ°”é¢„æŠ¥è¯´æ¨å‡Œçš„æ¸©åº¦æ˜¯åæ°60åº¦ï¼Œè€Œé•¿æ²™è¾¾åˆ°åæ°90åº¦ã€‚è¯´é•¿æ²™æ¯”æ¨å‡Œæš–å’Œ50%æ²¡æœ‰æ„ä¹‰ï¼Œæ‰€ä»¥ï¼Œæ¸©åº¦ä¸æ˜¯æ¯”ä¾‹å°ºåº¦ã€‚è¿™ä¸»è¦æ˜¯å› ä¸ºåæ°æ¸©æ ‡ä¸æ˜¯ä»¥0åº¦ä½œä¸ºèµ·ç‚¹æ‰€è‡´ã€‚

---

## æ¯”ç‡å°ºåº¦(ratio scale)ï¼š

æ¯”ç‡å°ºåº¦å˜é‡å¯ä»¥æ¯”è¾ƒå¤§å°ï¼Œä¹Ÿèƒ½åŠ å‡ä¹˜é™¤ã€‚

- å¯¹äºä¸€ä¸ªå˜é‡Xï¼Œå–å…¶ä¸¤ä¸ªå€¼
$X_1$å’Œ
$X_2$ï¼Œæ¯”ç‡
$X_1/X_2$å’Œè·ç¦»
$(X_2-X_1)$éƒ½æ˜¯æœ‰æ„ä¹‰çš„é‡ã€‚

- æ­¤å¤–ï¼Œè¿™äº›å€¼åœ¨è¿™ç§å°ºåº¦ä¸‹å­˜åœ¨ç€ä¸€ç§è‡ªç„¶é¡ºåºï¼ˆä¸Šå‡æˆ–ä¸‹é™) (æ€§è´¨3) ã€‚å› æ­¤å¦‚
$X_2â‰¤X_1$æˆ–
$X_2â‰¥X_1$ä¹‹ç±»çš„æ¯”è¾ƒä¹Ÿæ˜¯æœ‰æ„ä¹‰çš„ã€‚

- å¦‚ï¼šGDP(äº¿å…ƒ)ã€ä¸ªäººæ”¶å…¥(å…ƒ)ç­‰

---
# ä¸€ä¸ªå‡æƒ³çš„å¾®å‹ä¸–ç•Œ

```{r}
families60 <- as.tibble(read.xlsx("data/Table-2-1-60families.xlsx", sheet = 1))

col_sum_f60 <- families60 %>% 
  colSums(na.rm=T)
col_mean_f60 <- families60 %>% 
  colMeans(na.rm=T)

cond_mean <- families60 %>% 
  add_column(`80 `=rep(c(1/5,NA),times=c(5,2)), .before = "100") %>%
  add_column(`100 `=rep(c(1/6,NA),times=c(6,1)), .before = "120") %>%
  add_column(`120 `=rep(c(1/5,NA),times=c(5,2)), .before = "140") %>%
   add_column(`140 `=rep(c(1/7),times=c(7)), .before = "160") %>%
   add_column(`160 `=rep(c(1/6,NA),times=c(6,1)), .before = "180") %>%
  add_column(`180 `=rep(c(1/6,NA),times=c(6,1)), .before = "200") %>%
  add_column(`200 `=rep(c(1/5,NA),times=c(5,2)), .before = "200") %>%
  add_column(`220 `=rep(c(1/7),times=c(7)), .before = "240") %>%
  add_column(`240 `=rep(c(1/6,NA),times=c(6,1)), .before = "260") %>%
  add_column(`260 `=rep(c(1/7),times=c(7))) 

col_cond_mean <- cond_mean %>%
  colMeans(na.rm = T) %>%
  rbind(cond_mean, .)


```


```{r, eval=FALSE, warning=FALSE}
datatable(families60, options = list(pageLength=7, dom="tip"))
```


```{r, eval=FALSE}
col_sum_f60 %>%
  rbind(families60, . , col_mean_f60) %>%
  add_column(id=c(paste0("f",1:7),"åˆ—æ±‚å’Œ", "åˆ—å‡å€¼"), .before = "80") %>%
  datatable(col_sum_f60, options = list(pageLength=9, dom="tip"))
```

<!---æ–°æ•°æ®è¡¨--->

```{r}
fams60<- as.tibble(read.xlsx("data/Table-2-1-60families-new.xlsx",sheet = "Sheet1"))

fams60_long <- as.tibble(read.xlsx("data/Table-2-1-60families-new.xlsx", sheet = "Sheet2"))

```

ç›´è§‚åˆ—è¡¨ï¼š

```{r, fig.cap="60ä¸ªå®¶åº­çš„æ”¶å…¥å’Œæ”¯å‡ºæƒ…å†µï¼šå‡è®¾çš„æ€»ä½“"}
include_graphics("pic/chpt2-1-60families-pop.png",dpi=150)
```

???
æé—®ï¼š

- æ€»ä½“æ˜¯ä»€ä¹ˆï¼Ÿ

- æœ‰å¤šå°‘æ€»ä½“å•ä½ï¼Ÿ

---
# ä¸€ä¸ªå‡æƒ³çš„å¾®å‹ä¸–ç•Œï¼š

æ‰æ•°æ®å½¢æ€ï¼šâ€œéæ ‡å‡†â€æ•°æ®å½¢æ€ï¼ˆä½†å¾ˆç›´è§‚ï¼‰

```{r}
datatable(fams60, options = list(pageLength =9, dom ="tip"), caption = "60ä¸ªå®¶åº­çš„æ”¶å…¥å’Œæ”¯å‡ºæƒ…å†µï¼šå‡è®¾çš„æ€»ä½“")
```

---
# ä¸€ä¸ªå‡æƒ³çš„å¾®å‹ä¸–ç•Œï¼š

é•¿æ•°æ®å½¢æ€ï¼šæ ‡å‡†æ•°æ®å½¢æ€ï¼ˆä½†ä¸ç›´è§‚ï¼‰

```{r}
datatable(fams60_long, options = list(pageLength =7, dom ="tip"), caption = "60ä¸ªå®¶åº­çš„æ”¶å…¥å’Œæ”¯å‡ºæƒ…å†µï¼šå‡è®¾çš„æ€»ä½“")
```

---

# é‡è¦æ¦‚å¿µ

**æ— æ¡ä»¶æ¦‚ç‡**ï¼š

- å®šä¹‰ï¼šä¸å—
$X_i$å˜é‡å–å€¼å½±å“ä¸‹ï¼Œ
$Y_i$å‡ºç°çš„å¯èƒ½æ€§ã€‚

- è®°å·ï¼šç¦»æ•£å˜é‡
$P(Y_i)$ï¼›è¿ç»­å˜é‡
$g(Y)$

**æ— æ¡ä»¶æœŸæœ›**ï¼š

- å®šä¹‰ï¼šä¸å—
$X_i$å˜é‡å–å€¼å½±å“ä¸‹ï¼Œå˜é‡
$Y_i$çš„æœŸæœ›å€¼ã€‚

- è®°å·ï¼š
$g(Y_i)$è¡¨ç¤ºè¿ç»­å˜é‡çš„æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆcdfï¼‰

$$\begin{align}
E(Y) &= \sum_1^N{Y_i \cdot P(Y_i)} &&\text{(discrete vars)} \\
E(Y) &= \int{Y_i \cdot g(Y_i)dY} &&\text{(continue vars)} 
\end{align}$$

---

# é‡è¦æ¦‚å¿µ

æ— æ¡ä»¶æ¦‚ç‡å’Œæ— æ¡ä»¶æœŸæœ›çš„å®ä¾‹è®¡ç®—ï¼š

```{r, fig.cap="æ— æ¡ä»¶æ¦‚ç‡å’Œæ— æ¡ä»¶æœŸæœ›"}
include_graphics("pic/chpt2-1-60fams-unconditional-mean.png")
```

---

# é‡è¦æ¦‚å¿µ

æ— æ¡ä»¶æœŸæœ›çš„è®¡ç®—è¿‡ç¨‹ï¼š

$$\begin{align}
E(Y) &= \sum_1^N{Y_i \cdot P(Y_i)} \\
     &= \sum_1^{60}\left( 55*\frac{1}{60} + 60*\frac{1}{60} + \cdots + 191*\frac{1}{60} \right) \\
     &=\frac{1}{60}\sum_1^{60}Y_i\\
     &=\frac{7272}{60}\\
     &=121.2
\end{align}$$

---

# é‡è¦æ¦‚å¿µ

**æ¡ä»¶æ¦‚ç‡**ï¼š

- å®šä¹‰ï¼šç»™å®šå˜é‡
$X_i$çš„å–å€¼æ¡ä»¶ä¸‹ï¼Œ
$Y_i$å‡ºç°çš„å¯èƒ½æ€§ã€‚

- è®°å·ï¼šç¦»æ•£å˜é‡
$P(Y_i|X_i)$ï¼›è¿ç»­å˜é‡
$g(Y|X)$


**æ¡ä»¶æœŸæœ›**ï¼š

- åœ¨ç»™å®šå˜é‡
$X_i$çš„å–å€¼æ¡ä»¶ä¸‹ï¼Œ
$Y_i$çš„æœŸæœ›å€¼ã€‚

- è®°å·ï¼š
$g(Y|X)$è¡¨ç¤ºè¿ç»­å˜é‡çš„æ¡ä»¶æ¦‚ç‡å¯†åº¦å‡½æ•°ï¼ˆcdfï¼‰

$$\begin{align}
E(Y|X_i) &= \sum_1^N{(Y_i|X_i) \cdot P(Y_i|X_i)} &&\text{(discrete vars)} \\
E(Y|X_i) &= \int{(Y|X) \cdot g(Y|X)dY} &&\text{(continue vars)} \end{align}$$

---

# é‡è¦æ¦‚å¿µ

æ¡ä»¶æ¦‚ç‡å’Œæ¡ä»¶æœŸæœ›çš„å®ä¾‹è®¡ç®—ï¼š

```{r, fig.cap="æ¡ä»¶æ¦‚ç‡å’Œæ¡ä»¶æœŸæœ›"}
include_graphics("pic/chpt2-1-60fams-conditional-mean.png")
```

---

# é‡è¦æ¦‚å¿µ

æ¡ä»¶æœŸæœ›çš„è®¡ç®—è¿‡ç¨‹ï¼š

$$\begin{align}
E(Y|80) &= \sum_1^N{Y_i \cdot P(Y_i|X=80)} \\
     &= \sum_1^{5}\left( 55*\frac{1}{5} + 60*\frac{1}{5} + \cdots + 75*\frac{1}{5} \right) \\
     &=\frac{1}{5}\sum_1^{5}Y_i\\
     &=\frac{325}{5}\\
     &=65
\end{align}$$

---

### å‡æƒ³æ€»ä½“çš„å…¨éƒ¨æ•°æ®å±•ç¤º

```{r}
exp_cond <- fams60 %>%
  filter(Mark!="X") %>%
  select(-Mark) %>%
  colMeans(.,na.rm = T) %>%
  rbind(fams60[1,-1], .) %>%
  add_column(var = c("X","E(Y|X)"), .before = "G1")

pivot_exp <- as.tibble(t(exp_cond))[-1,] %>%
  dplyr::rename( X=V1,exp.Y="V2") %>%
  type_convert(cols(X=col_double(),
                    exp.Y= col_double()))
```


```{r}

# the population points
p1<- ggplot() +
  geom_point(data = fams60_long,
             aes(x=X,  y=Y,color= "Y", shape="Y"),size=3) +
  scale_colour_manual(name= "",
                      values =c("blue")) +
  scale_shape_manual(name= "",
                      values =c(1)) +
  scale_x_continuous(breaks=seq(80,260, length=10)) +
  labs(x="å®¶åº­æ”¶å…¥X", y="å®¶åº­æ”¯å‡ºY") +
  theme(text = element_text(size=16))

p1
```


---
### ç»™å®šä¸åŒXæ°´å¹³ä¸‹Yæ¡ä»¶æœŸæœ›å€¼

```{r}
# the expect points
p2 <- p1 +
  geom_point(data = pivot_exp, 
             aes(x=X, y=exp.Y,
                 color= "E(Y|X)",shape= "E(Y|X)"), size=3) +
  scale_colour_manual(name= "",
                      values =c("red","blue")) +
  scale_shape_manual(name= "",values =c(19,1)) 

p2
```

```{r}
knitr::kable(exp_cond)
```

---
### ç»™å®šä¸åŒXæ°´å¹³ä¸‹Yæ¡ä»¶æœŸæœ›å€¼

```{r , warning=FALSE,message=FALSE}
# the specified point
X_spc <- 120
Y_spc <- pivot_exp$exp.Y[which(pivot_exp$X==X_spc)]
p2_1 <- p2 +
  geom_vline(aes(xintercept = X_spc), lty="dashed")+
  geom_hline(aes(yintercept = Y_spc), lty="dashed")+
  geom_text(aes(x=X_spc-22, y=Y_spc+10), label=TeX("$(X_i,E(Y|X_i))=(120,89)$"),
            color="red",size=5)

p2_1
```

ç»™å®š
$X=120$æ°´å¹³ä¸‹
$Y$æ¡ä»¶æœŸæœ›å€¼
$E(Y|X_i=120)$= `r pivot_exp$exp.Y[which(pivot_exp$X==X_spc)]`

---
### Xå‡å€¼å’ŒYçš„æ— æ¡ä»¶æœŸæœ›å€¼

```{r, fig.cap="Xå‡å€¼å’ŒYçš„æ— æ¡ä»¶æœŸæœ›å€¼", warning=FALSE,message=FALSE}
# the center point
X_bar <- mean(fams60_long$X)
Y_bar <- mean(fams60_long$Y)
p3 <- p2 +
  geom_vline(aes(xintercept = X_bar), lty="dashed")+
  geom_hline(aes(yintercept = Y_bar), lty="dashed")+
  geom_text(aes(x=X_bar-20, y=Y_bar+10), label=TeX("$(\\bar{X},\\bar{Y})=(174, 121)$"),color="orange",size=5)+
  #geom_text(aes(x=15, y=mean(fams60_long$Y)+5), label=TeX("$E(Y)=\\bar{Y}$"))+
  geom_point(aes(x=X_bar, y=Y_bar,
                 color="center", shape="center"),size=3) +
  scale_colour_manual(name= "",
                      values =c("E(Y|X)"="red", "Y"="blue", "center" ="orange")) +
  scale_shape_manual(name= "",
                      values =c("E(Y|X)"=19,"Y"=1,"center" =17)) 
p3
```

Xçš„å‡å€¼
$\bar{X}$
=`r X_bar`å’ŒYçš„æ— æ¡ä»¶æœŸæœ›å€¼
$E(Y)=$
`r Y_bar`

---

# æ€»ä½“å›å½’çº¿ï¼ˆPRLï¼‰

- å‡ ä½•ï¼šç»™å®šXå€¼æ—¶Yçš„æ¡ä»¶æœŸæœ›å€¼çš„è½¨è¿¹ã€‚

- ç»Ÿè®¡ï¼šå®è´¨ä¸Šå°±æ˜¯Yå¯¹Xçš„å›å½’ã€‚

æ€»ä½“å›å½’æ›²çº¿(Population Regression Curveï¼ŒPRC)ï¼šæ¡ä»¶æœŸæœ›å€¼çš„è½¨è¿¹è¡¨ç°ä¸ºä¸€æ¡æ›²çº¿(Curve)ã€‚

æ€»ä½“å›å½’çº¿(Population Regression Lineï¼ŒPRL)ï¼šæ¡ä»¶æœŸæœ›å€¼çš„è½¨è¿¹è¡¨ç°ä¸ºä¸€æ¡ç›´çº¿(Line)ã€‚

---

# æ€»ä½“å›å½’çº¿ï¼ˆPRLï¼‰

```{r, fig.cap="æ€»ä½“å›å½’çº¿PRL"}
p_PRL <- p2 +
  geom_line(data = pivot_exp,aes(x=X, y=exp.Y),color="purple", size=0.75)
p_PRL
```

---
# æ€»ä½“å›å½’å‡½æ•°ï¼ˆPRFï¼‰

æ€»ä½“å›å½’å‡½æ•°ï¼ˆPopulation Regression Functionï¼ŒPRFï¼‰ï¼šå®ƒæ˜¯å¯¹æ€»ä½“å›å½’æ›²çº¿(PRC)çš„æ•°å­¦å‡½æ•°è¡¨ç°å½¢å¼ã€‚

å¦‚æœä¸çŸ¥é“æ€»ä½“å›å½’æ›²çº¿çš„å…·ä½“å½¢å¼ï¼Œåˆ™æ€»ä½“å›å½’å‡½æ•°PRFè¡¨è¾¾ä¸ºå¦‚ä¸‹éšå‡½æ•°å½¢å¼ï¼ˆPRFï¼‰ï¼š

$$\begin{align}
E(Y|X_i) & = f(X_i)  && \text{(PRF)}
\end{align}$$

å¦‚æœæ€»ä½“å›å½’æ›²çº¿æ˜¯ç›´çº¿å½¢å¼ï¼Œåˆ™æ€»ä½“å›å½’å‡½æ•°PRFè¡¨è¾¾ä¸ºå¦‚ä¸‹æ˜¾å‡½æ•°å½¢å¼ï¼ˆPRF_Lï¼‰ï¼š

$$\begin{align}
E(Y|X_i) &= \beta_1 +\beta_2X_i && \text{(PRF_L)}
\end{align}$$

- $\beta_1,\beta_2$åˆ†åˆ«ç§°ä¸ºæˆªè·(intercept)å’Œæ–œç‡ç³»æ•°(slope coefficient)ã€‚

- $\beta_1,\beta_2$ç§°ä¸ºæ€»ä½“å‚æ•°æˆ–å›å½’ç³»æ•°(regression coefficients)ã€‚

- $\beta_1,\beta_2$ä¸ºæœªçŸ¥ä½†å´æ˜¯å›ºå®šçš„å‚æ•°ã€‚

---
# æ€»ä½“å›å½’å‡½æ•°ï¼ˆPRFï¼‰

```{r, fig.cap="æ€»ä½“å›å½’çº¿PRLä¸æ€»ä½“å›å½’å‡½æ•°PRF", warning=FALSE,message=FALSE}
lm_pop<- lm(data = pivot_exp, formula = exp.Y~X)
b1 <- coef(lm_pop)[1]
b0 <- coef(lm_pop)[2]
p_PRF <- p_PRL +
  geom_text(aes(x=120, y=200),
            label=TeX("$PRF:E(Y|X_i)=\\beta_1+\\beta_2X_i$"),
            color="purple", size=5) +
    geom_text(aes(x=120, y=190),
            label=TeX("$E(Y|X_i)=17+0.6X_i$"),
            color="purple", size=5) 
p_PRF
```

---
# æ€»ä½“å›å½’æ¨¡å‹ï¼ˆPRMï¼‰

**æ€»ä½“å›å½’æ¨¡å‹**ï¼ˆPopulation Regression model, PRMï¼‰ï¼šæŠŠæ€»ä½“å›å½’å‡½æ•°è¡¨è¾¾æˆ**éšæœºè®¾å®š**å½¢å¼ã€‚

å¦‚æœæ€»ä½“å›å½’å‡½æ•°ä¸ºéšå‡½æ•°ï¼Œåˆ™**æ€»ä½“å›å½’æ¨¡å‹**è®°ä¸ºï¼š

$$\begin{align}
Y_i &=  E(Y|X_i) + u_i \\
    &=  f(X_i) +u_i
\end{align}$$

å¦‚æœæ€»ä½“å›å½’å‡½æ•°ä¸ºçº¿æ€§å‡½æ•°ï¼Œåˆ™**æ€»ä½“å›å½’æ¨¡å‹**è®°ä¸ºï¼š

$$\begin{align}
Y_i &=  E(Y|X_i) + u_i \\
    &= \beta_1 +\beta_2X_i + u_i
\end{align}$$

- æ€»ä½“å›å½’æ¨¡å‹ï¼ˆPRMï¼‰å±äº**è®¡é‡ç»æµå­¦æ¨¡å‹**ï¼Œè€Œæ€»ä½“å›å½’å‡½æ•°ï¼ˆPRFï¼‰æ˜¯**æ•°é‡ç»æµå­¦æ¨¡å‹**ï¼ˆæˆ–æ•°å­¦æ¨¡å‹ï¼‰ã€‚

- æ€»ä½“å›å½’æ¨¡å‹ï¼ˆPRMï¼‰èƒ½å……åˆ†è¡¨è¾¾çš„æ˜¯ç°å®ä¸–ç•Œä¸­
$Y_i$å˜é‡çš„è¡Œä¸ºç‰¹å¾ã€‚


---
## éšæœºå¹²æ‰°é¡¹

æ€»ä½“å›å½’æ¨¡å‹ï¼ˆPRMï¼‰è®¾å®šä¸‹ï¼Œ
$Y_i$å°†ç”±ä¸¤ä¸ªéƒ¨åˆ†ç»„æˆã€‚

.content-box-blue[
ç‰¹å®šå®¶åº­çš„æ”¯å‡ºï¼ˆ
$Y_i$ï¼‰ = ç³»ç»Ÿæ€§éƒ¨åˆ†ï¼ˆ
$E(Y|X_i)$ + éšæœºéƒ¨åˆ†ï¼ˆ
$u_i$ï¼‰]

ç‰¹å®šå®¶åº­çš„æ”¯å‡ºï¼ˆ
$Y_i$ï¼‰ = ç³»ç»Ÿæ€§éƒ¨åˆ†ï¼ˆ
$\beta_1+\beta_2X_i$ï¼‰ + éšæœºéƒ¨åˆ†ï¼ˆ
$u_i$ï¼‰


**éšæœºå¹²æ‰°é¡¹**ï¼š

- ä¹Ÿè¢«ç§°ä¸ºéšæœºè¯¯å·®é¡¹(stochastic error term)ï¼šæ€»ä½“å›å½’å‡½æ•°ä¸­å¿½ç•¥æ‰çš„ä½†åˆå½±å“ç€Yçš„å…¨éƒ¨å˜é‡çš„æ›¿ä»£ç‰©ï¼Œå®ƒæ˜¯
$Y_i$ä¸æ¡ä»¶æœŸæœ›ï¼ˆ
$E(Y|X_i)$ï¼‰çš„ç¦»å·®ã€‚

$$\begin{align}
u_i &= Y_i - E(Y|X_i) 
\end{align}$$

---
## éšæœºå¹²æ‰°é¡¹

éšæœºå¹²æ‰°é¡¹çš„æ¥æºï¼š

- ç†è®ºçš„å«ç³Šï¼šé™¤äº†ä¸»å˜é‡ä¹‹å¤–ï¼Œè¿˜æœ‰å…¶å®ƒå˜é‡çš„å½±å“ï¼Œä½†ä¸æ¸…æ¥šï¼Œåªèƒ½ç”¨ğœ‡_ğ‘–ä»£æ›¿å®ƒä»¬ã€‚ï¼ˆå®¶åº­æ”¶å…¥ä»¥å¤–ï¼Ÿï¼‰

- æ•°æ®çš„ä¸å……åˆ†ï¼šå¯èƒ½çŸ¥é“è¢«å¿½ç•¥çš„å˜é‡ï¼Œä½†ä¸èƒ½å¾—åˆ°è¿™äº›å˜é‡çš„æ•°é‡ä¿¡æ¯ã€‚ï¼ˆå¦‚å®¶åº­è´¢å¯Œæ•°æ®ä¸å¯å¾—ï¼‰

- æ ¸å¿ƒå˜é‡ä¸å…¶å®ƒå˜é‡ï¼šå…¶å®ƒå˜é‡å…¨éƒ¨æˆ–å…¶ä¸­ä¸€äº›åˆèµ·æ¥å½±å“è¿˜æ˜¯å¾ˆå°çš„ã€‚ï¼ˆå¦‚å­å¥³ã€æ•™è‚²ã€æ€§åˆ«ã€å®—æ•™ç­‰ï¼‰

- äººç±»è¡Œä¸ºçš„å†…åœ¨éšæœºæ€§ã€‚ï¼ˆå®¢è§‚å­˜åœ¨ã€å›ºæœ‰çš„ï¼‰

- å˜é‡è¢«â€œç§»èŠ±æ¥æœ¨â€è€Œäº§ç”Ÿæµ‹é‡è¯¯å·®ï¼ˆå¦‚å¼—é‡Œå¾·æ›¼çš„æŒä¹…æ”¶å…¥å’Œæ¶ˆè´¹ï¼‰

- èŠ‚çœåŸåˆ™ï¼šä¸ºäº†ä¿æŒä¸€ä¸ªå°½å¯èƒ½ç®€å•çš„å›å½’æ¨¡å‹

- é”™è¯¯çš„å‡½æ•°å½¢å¼ï¼šæœ‰æ—¶æ ¹æ®æ•°æ®åŠç»éªŒæ— æ³•ç¡®å®šä¸€ä¸ªæ­£ç¡®çš„å‡½æ•°å½¢å¼ ï¼ˆå¤šå…ƒå›å½’å°¤å…¶å¦‚æ­¤ï¼‰

---
## éšæœºå¹²æ‰°é¡¹

ä¸ºä½•æ˜¯â€œéšæœºçš„â€ï¼Ÿ

- æµ‹ä¸å‡†ï¼Ÿï¼ˆè¯¯å·®ï¼‰

- æµ‹é”™äº†ï¼Ÿï¼ˆè¯¯å¯¼ï¼‰

- å…ä¸äº†!ï¼ˆå†…åœ¨æ€§ï¼‰

æ‹¥æŠ±éšæœºä¸–ç•Œ

- é£ç­ï¼š$Y_i$

- é£ç­çº¿ï¼š$E(Y|X_i)$

- é£ï¼š$u_i$



---

## ç†è§£PRMå’ŒPRFçš„å…³ç³»


```{r, warning=FALSE,message=FALSE}
Y_spc2 <- min(fams60_long$Y[which(fams60_long$X==X_spc)])

p_PRM_demo<- p_PRF +
  geom_point(aes(x=X_spc,y=Y_spc), shape=2,size=3)+
  geom_point(aes(x=X_spc,y=Y_spc2), shape=1, color="black",size=3)+
  geom_hline(aes(yintercept = Y_spc), lty= "dashed") +
  geom_text(aes(x=X_spc+25,y=Y_spc+4),
             label=paste0("E(Y|",X_spc,")=",Y_spc),size=5) +
  geom_hline(aes(yintercept = Y_spc2), lty= "dashed") +
  geom_text(aes(x=X_spc+25,y=Y_spc2-4),
             label=paste0("(Yi|", X_spc,")=",Y_spc2),size=5) 
  
p_PRM_demo
```

.pull-left[
è‹¥ç»™å®šä¸€ä¸ªç‰¹å®šå®¶åº­
$(X_i=120, Y_i=79)$ã€‚
]

.pull-right[
ç»™å®šæ¡ä»¶ä¸‹ï¼Œæ¡ä»¶æœŸæœ›ä¸º
$E(Y|120)=89$
]

---

## ç†è§£PRMå’ŒPRFçš„å…³ç³»

è‹¥ç»™å®š
$X_i=$
`r X_spc`ï¼Œåˆ™5ä¸ªå®¶åº­çš„çœŸå®æ¶ˆè´¹æ”¯å‡ºåˆ†åˆ«ä¸ºï¼š

$$\begin{align}
(Y_1|X=120) = 79 = \beta_1 + \beta_2 \cdot 120 +u_1\\
(Y_2|X=120) = 84 = \beta_1 + \beta_2 \cdot 120 +u_2\\
(Y_3|X=120) = 90 = \beta_1 + \beta_2 \cdot 120 +u_3\\
(Y_4|X=120) = 94 = \beta_1 + \beta_2 \cdot 120 +u_4\\
(Y_5|X=120) = 98 = \beta_1 + \beta_2 \cdot 120 +u_5
\end{align}$$


---
## ç†è§£PRMå’ŒPRFçš„å…³ç³»

ä¸»è¦ç»“è®ºï¼š

- æ€»ä½“æœŸæœ›åˆ»ç”»æ€»ä½“çš„â€œè¶‹åŠ¿â€ï¼Œæ€»ä½“å›å½’çº¿è®©â€œè¶‹åŠ¿â€ç›´è§‚åŒ–ã€‚

- ä¸ªä½“éšæœºæ€§æ˜¯ä¸å¯é¿å…çš„ï¼Œæ€»ä¼šâ€œæ¸¸ç¦»â€äºâ€œè¶‹åŠ¿â€ä¹‹å¤–ã€‚

- éšæœºå¹²æ‰°é¡¹
$u_i$ğ‘–æºå¸¦äº†éšæœºä¸ªä½“çš„â€œæ¸¸ç¦»â€ä¿¡æ¯ã€‚

- æ€»ä½“å›å½’æ¨¡å‹æ—¢â€œæå–â€äº†è¶‹åŠ¿å’Œè§„å¾‹æ€§ï¼Œåˆâ€œç»´ç³»â€ç€ä¸ªä½“éšæœºæ€§ï¼Œä»è€Œæ›´å¥½åœ°è¡¨è¾¾äº†â€œçœŸå®ä¸–ç•Œâ€ã€‚

è¯¾åæ€è€ƒï¼š

- å¦‚æœæ˜¯æ— é™æ€»ä½“ï¼Œæ€»ä½“çš„è§„å¾‹æ€§åœ¨ç†è®ºä¸Šä¹Ÿæ˜¯å¯ä»¥è¢«ä¸¥æ ¼è¡¨è¾¾å‡ºæ¥ä¹ˆï¼Ÿ

- å¦‚æœä¸å‘Šè¯‰ä½ æ€»ä½“ï¼Œä½ æ€ä¹ˆçŸ¥é“â€œè§¦ç¢°â€åˆ°çš„æ˜¯â€œçœŸå®çš„â€è¶‹åŠ¿/è§„å¾‹ï¼Ÿ

- ä»å‡æƒ³çš„60ä¸ªå®¶åº­çš„å¾®å‹æ€»ä½“ä¸­ï¼Œâ€œéšä¾¿â€æŠ½å–10ä¸ªå®¶åº­çš„æ•°æ®ï¼Œä½ è¿˜èƒ½çœ‹åˆ°â€œç›´çº¿â€è¶‹åŠ¿ä¹ˆï¼Ÿ


---
## â€œçº¿æ€§å›å½’æ¨¡å‹â€ä¸­â€œçº¿æ€§â€ä¸€è¯çš„å«ä¹‰

**å˜é‡â€œçº¿æ€§â€æ¨¡å‹**ï¼šå› å˜é‡å¯¹äºè‡ªå˜é‡æ˜¯çº¿æ€§çš„ã€‚

**å‚æ•°â€œçº¿æ€§â€æ¨¡å‹**ï¼šå› å˜é‡å¯¹äºå‚æ•°æ˜¯çº¿æ€§çš„ã€‚

---
class: duke-orange
## â€œçº¿æ€§å›å½’æ¨¡å‹â€ä¸­â€œçº¿æ€§â€ä¸€è¯çš„å«ä¹‰

æµ‹è¯•é¢˜ï¼š

$$\begin{align}
Y_i &= \beta_1 + \beta_2 X_i +u_i && \text{(mod1)}
\end{align}$$

$$\begin{align}
Y_i &= \beta_1 + \beta_2 X_i + \beta_3 X_i^2 +u_i && \text{(mod2)}
\end{align}$$

$$\begin{align}
Y_i &= \beta_1 + \beta_2 X_i + \beta_3 X_i^2 + \beta_4 X_i^3 +u_i && \text{(mod3)}
\end{align}$$

$$\begin{align}
Y_i &= \beta_1 + \beta_2 \frac{1}{X_i} +u_i && \text{(mod4)}
\end{align}$$


$$\begin{align}
Y_i &= \beta_1 + \beta_2 ln(X_i) +u_i && \text{(mod5)} \\
\end{align}$$



$$\begin{align}
ln(Y_i) &= \beta_1 + \beta_2 X_i +u_i && \text{(mod6)}
\end{align}$$

---
class: duke-orange
## â€œçº¿æ€§å›å½’æ¨¡å‹â€ä¸­â€œçº¿æ€§â€ä¸€è¯çš„å«ä¹‰

æµ‹è¯•é¢˜ï¼š

$$\begin{align}
ln(Y_i) &= \beta_1 - \beta_2 \frac{1}{X_i} +u_i && \text{(mod7)} 
\end{align}$$


$$\begin{align}
ln(Y_i) &= ln(\beta_1) + \beta_2 ln(X_i) +u_i && \text{(mod8)} 
\end{align}$$


$$\begin{align}
Y_i &= \frac{1}{1+e^{(\beta_1 + \beta_2 X_{2i}  +u_i) }} && \text{(mod9)}
\end{align}$$


$$\begin{align}
Y_i &= \beta_1 +(0.75-\beta_1)e^{-\beta_2(X_i-2)} +u_i && \text{(mod10)}
\end{align}$$


$$\begin{align}
Y_i &= \beta_1 + \beta_2^3 X_i +u_i && \text{(mod11)} 
\end{align}$$

---

# æ ·æœ¬å›å½’çº¿(SRL)

**æ ·æœ¬(Sample)**ï¼š

- ä»æ€»ä½“ä¸­éšæœºæŠ½å–å¾—åˆ°çš„æ•°æ®ã€‚

**æ ·æœ¬å›å½’çº¿**(Sample Regression Lineï¼ŒSRL)ï¼š

- æ˜¯é€šè¿‡æ‹Ÿåˆ**æ ·æœ¬æ•°æ®**å¾—åˆ°çš„ä¸€æ¡æ›²çº¿ï¼ˆæˆ–ç›´çº¿ï¼‰ã€‚æ¢è¨€ä¹‹ï¼Œè¿™æ¡çº¿ç”±æ‹Ÿåˆå€¼
$\hat{Y}_i$è¿æ¥è€Œæˆã€‚

- 
$\hat{Y}_i$æ˜¯å¯¹æ¡ä»¶æœŸæœ›å€¼
$Y|X_i$çš„æ‹Ÿåˆã€‚

- æ‹Ÿåˆæ–¹æ³•æœ‰å¾ˆå¤šï¼Œä¾‹å¦‚é‡‡ç”¨OLSæ–¹æ³•å¯¹æ ·æœ¬æ•°æ®è¿›è¡Œæ‹Ÿåˆã€‚

    - å°½å¯èƒ½æ‹Ÿåˆæ•°æ®
    - ç”¨ä»€ä¹ˆæ–¹æ³•æ‹Ÿåˆï¼Ÿ
    - æ›²çº¿æ˜¯ä»€ä¹ˆå½¢æ€ï¼Ÿ


---

# æ ·æœ¬å›å½’å‡½æ•°(SRF)

**æ ·æœ¬å›å½’å‡½æ•°**(Sample Regression Functionï¼ŒSRF)ï¼šæ˜¯æ ·æœ¬å›å½’æ›²çº¿çš„æ•°å­¦å‡½æ•°å½¢å¼ï¼Œå¯æ˜¯æ˜¯çº¿æ€§çš„æˆ–éçº¿æ€§ã€‚å¦‚æœæ˜¯ç›´çº¿åˆ™å¯ä»¥å†™æˆï¼š

$$\begin{align}
\hat{Y}_i =\hat{\beta}_1 + \hat{\beta}_2X_i
\end{align}$$

å¯¹æ¯”æ€»ä½“å›å½’å‡½æ•°ï¼ˆPRFï¼‰ï¼š

$$\begin{align}
E(Y|X_i) =\beta_1 + \beta_2X_i
\end{align}$$

å¯ä»¥è®¤ä¸ºï¼š

- 
$\hat{Y}_i$æ˜¯å¯¹
$E(Y|X_i)$çš„ä¼°è®¡é‡ã€‚

- 
$\hat{\beta}_1$æ˜¯å¯¹
$\beta_1$çš„ä¼°è®¡é‡ã€‚

- 
$\hat{\beta}_2$æ˜¯å¯¹
$\beta_2$çš„ä¼°è®¡é‡ã€‚

---
### ç¬¬ä¸€ä»½éšæœºæ ·æœ¬ï¼šæŠ½æ ·

```{r}
set.seed("123")
sample1<- fams60_long %>% 
  mutate(group = as.factor(group)) %>%
  group_by(group) %>%
  sample_n(size=1) %>% ungroup() %>% select(-id,-group)

set.seed("124")
sample2<- fams60_long %>% 
  mutate(group = as.factor(group)) %>%
  group_by(group) %>%
  sample_n(size=1) %>% ungroup() %>% select(-id,-group) 

```


```{r, warning=FALSE,message=FALSE}
p_spl1 <- p1 +
  geom_point(data = sample1, 
         aes(x=X, y=Y, shape="sample1", color="sample1"),
         size=3)+
  scale_colour_manual(name= "",
                      values =c("black","blue")) +
  scale_shape_manual(name= "",
                      values =c(15,1))

p_spl1
```

```{r, warning=FALSE,message=FALSE}
old.names <- str_c("V",1:10)
new.names <- str_c("n",1:10)
sample1_t<- sample1 %>% 
  t(.) %>% as.tibble(.) %>% 
  rename_at(vars(old.names), ~ new.names) %>%
  add_column(var=c("X","Y"), .before = "n1") 

kableExtra::kable(sample1_t)
```

---
### ç¬¬ä¸€ä»½éšæœºæ ·æœ¬ï¼šæ•°æ®

```{r, warning=FALSE,message=FALSE}
p_spl_base<- ggplot(sample1, aes(X, Y)) +
  geom_blank() +
  scale_x_continuous(breaks=seq(80,260, length=10)) +
  scale_y_continuous(breaks=seq(50,150, length=3)) +
  labs(x="å®¶åº­æ”¶å…¥X", y="å®¶åº­æ”¯å‡ºY") +
  theme(text=element_text(size=16))

p_spl1_alone <- p_spl_base +
  geom_point(aes(shape="sample1"), color="black",size=3)+
  scale_y_continuous(breaks=seq(50,150, length=3)) +
  scale_shape_manual(name= "",
                      values =c(15))

p_spl1_alone
```

```{r}
knitr::kable(sample1_t)
```

---
### ç¬¬ä¸€ä»½éšæœºæ ·æœ¬ï¼šSRL

```{r, warning=FALSE,message=FALSE}
p_spl1_SRL<- p_spl1_alone +
  geom_abline( intercept = coef_mod1$coef[1], slope= coef_mod1$coef[2], color="black") +
  geom_text(aes(x=120,y=170),
             label=TeX("$\\hat{Y_i}=\\hat{\\beta}_1+\\hat{\\beta}_2X_i$"),size=5) +
  geom_text(aes(x=120,y=160),
             label=TeX("$\\hat{Y}=17.81+0.62X_i$"),size=5) 
p_spl1_SRL  
```

```{r}
kableExtra::kable(sample1_t)
```

---
### ç¬¬ä¸€ä»½éšæœºæ ·æœ¬ï¼šSRF

```{r}
mod_spl <- formula("Y~X")
coef_mod1<- fun_lm_coef(lm.mod = mod_spl, lm.dt = sample1)
```

æ ¹æ®ç¬¬ä¸€ä»½éšæœºæ ·æœ¬æ‹Ÿåˆå¾—åˆ°çš„**æ ·æœ¬å›å½’å‡½æ•°**SRFï¼š

```{r ,results="asis"}
fun_report_eq(lm.mod = mod_spl, lm.dt = sample1,
              lm.simple=TRUE,lm.n = 2)
```

```{r}
kableExtra::kable(sample1_t)
```


---
### ç¬¬äºŒä»½éšæœºæ ·æœ¬ï¼šæŠ½æ ·

```{r, warning=FALSE,message=FALSE}
sample2_t<- sample2 %>% 
  t(.) %>% as.tibble(.) %>% 
  rename_at(vars(old.names), ~ new.names) %>%
  add_column(var=c("X","Y"), .before = "n1")
```

```{r, warning=FALSE,message=FALSE}
p_spl2 <- p1 +
  geom_point(data = sample2, 
         aes(x=X, y=Y, shape="sample2", color="sample2"),size=3)+
  scale_colour_manual(name= "",
                      values =c("purple","blue")) +
  scale_shape_manual(name= "",
                      values =c(17,1))

p_spl2
```

```{r}
kableExtra::kable(sample2_t)
```


---
### ç¬¬äºŒä»½éšæœºæ ·æœ¬ï¼šæ•°æ®

```{r, warning=FALSE,message=FALSE}
p_spl2_alone <- p_spl_base +
geom_point(data=sample2,aes(shape="sample2"), color="purple",size=3)+
  scale_y_continuous(breaks=seq(50,150, length=3)) +
  scale_shape_manual(name= "",
                      values =c(17))

p_spl2_alone
```

```{r}
kableExtra::kable(sample2_t)
```

---
### ç¬¬äºŒä»½éšæœºæ ·æœ¬ï¼šSRL

```{r, warning=FALSE,message=FALSE}
p_spl2_SRL<- p_spl2_alone +
  geom_abline( intercept = coef_mod2$coef[1], slope= coef_mod2$coef[2], color="purple") +
  geom_text(aes(x=120,y=170),
             label=TeX("$\\hat{Y_i}=\\hat{\\beta}_1+\\hat{\\beta}_2X_i$"),size=5) +
  geom_text(aes(x=120,y=160),
             label=TeX("$\\hat{Y}=7.12+0.65X_i$"),size=5) 
p_spl2_SRL  
```

```{r}
kableExtra::kable(sample2_t)
```

---
### ç¬¬äºŒä»½éšæœºæ ·æœ¬ï¼šSRF

æ ¹æ®ç¬¬äºŒä»½éšæœºæ ·æœ¬æ‹Ÿåˆå¾—åˆ°çš„**æ ·æœ¬å›å½’å‡½æ•°**SRFï¼š

```{r, results="asis"}
coef_mod2<- fun_lm_coef(lm.mod = mod_spl, lm.dt = sample2)
fun_report_eq(lm.mod = mod_spl, lm.dt = sample2,
              lm.simple = TRUE)
```

```{r}
kableExtra::kable(sample2_t)
```

---
### ä¸¤ä»½æ ·æœ¬åŒæ—¶å‡ºç°ï¼š

```{r}
sample_all<- rbind(sample1, sample2) %>%
  add_column(cat= rep(c("sample1", "sample2"), c(10,10)),
             .before = "X")
```

```{r, warning=FALSE,message=FALSE}
p_sample_all<- p2 + 
  geom_point(data = sample1, 
             aes(x=X, y=Y),color="black", shape=15)+
  geom_point(data = sample2, 
             aes(x=X, y=Y),color="purple", shape=17)+
  geom_abline( intercept = coef_mod1$coef[1], slope= coef_mod1$coef[2], color="black",lty="dashed") +
  geom_abline( intercept = coef_mod2$coef[1], slope= coef_mod2$coef[2], color="red",lty="dashed") +
  geom_abline( intercept = 17, slope= 0.6, color="purple") +
  geom_text(aes(x=120,y=180),
             label=TeX("$SRL1:\\hat{Y}=17.81+0.62X_i$"), color="black",size=5)+
  geom_text(aes(x=120,y=170),
             label=TeX("$SRL2:\\hat{Y}=7.12+0.65X_i$"), color="purple",size=5) +
  geom_text(aes(x=120,y=160),
             label=TeX("$PRL:\\hat{Y}=17+0.6X_i$"), color="red",size=5) 
  
  
p_sample_all
```


---

# æ ·æœ¬å›å½’æ¨¡å‹ï¼ˆSRMï¼‰

æ ·æœ¬å›å½’æ¨¡å‹ï¼ˆSample Regression Modelï¼ŒSRMï¼‰ï¼šæŠŠæ ·æœ¬å›å½’å‡½æ•°è¡¨ç°ä¸º**â€œéšæœºâ€**å½¢å¼ã€‚

å¦‚æœæ ·æœ¬å›å½’å‡½æ•°ä¸ºéšå‡½æ•°ï¼Œåˆ™æ ·æœ¬å›å½’æ¨¡å‹å¯è®°ä¸ºï¼š

$$\begin{align}
Y_i &= g(X_i) +e_i 
\end{align}$$

å¦‚æœæ ·æœ¬å›å½’å‡½æ•°è¡¨ç°ä¸ºç›´çº¿ï¼Œåˆ™æ ·æœ¬å›å½’æ¨¡å‹å¯è®°ä¸ºï¼š

$$\begin{align}
Y_i &= \hat{\beta}_1 +\hat{\beta}_2X_i +e_i && \text{(SRM_L)}
\end{align}$$

å…¶ä¸­ï¼Œ
$e_i$è¡¨ç¤ºæ®‹å·®ï¼ˆResidualï¼‰

---

## æ®‹å·®

æ®‹å·®ï¼ˆResidualï¼‰ï¼š

- å®šä¹‰ï¼šæ˜¯æ ·æœ¬å›å½’å‡½æ•°ä¸Yçš„æ ·æœ¬è§‚æµ‹å€¼ä¹‹é—´çš„ç¦»å·®ã€‚

- è®°å·ï¼š

$$\begin{align}
e_i  &= Y_i - \hat{Y}_i \\
     &= Y_i - (\hat{\beta}_1 +\hat{\beta}_2X_i) 
\end{align}$$

---
### ç†è§£SRFå’ŒSRMçš„å…³ç³»

```{r, warning=FALSE, message=FALSE}
x_spc_spl2 <- 240
Y_spc_spl2 <- sample2$Y[which(sample2$X==x_spc_spl2)]
lm.spl2 <- lm(formula = mod_spl, data = sample2)
Y_spc_fit <- round(lm.spl2$fitted.values[which(sample2$X==x_spc_spl2)],1)

p_SRL_SRF <- p_spl2_SRL +
  geom_vline(aes(xintercept = x_spc_spl2), lty="dashed") +
  geom_hline(aes(yintercept = Y_spc_spl2), lty="dashed")+
  geom_hline(aes(yintercept = Y_spc_fit), lty="dashed") +
  geom_point(aes(x=x_spc_spl2, y= Y_spc_fit), shape=1, size=3,color="red") +
  geom_text(aes(x=x_spc_spl2+15, y=Y_spc_spl2-5), 
            label=  paste0("(",x_spc_spl2,"," ,Y_spc_spl2-5,")"),size=5)+
  geom_text(aes(x=x_spc_spl2+15, y=Y_spc_fit, 
            label= paste0("(",x_spc_spl2,"," ,Y_spc_fit,")")),size=5)

p_SRL_SRF 

```

ç»™å®š
$x_i=$ `r x_spc_spl2`ï¼Œæ ·æœ¬2çš„è§‚æµ‹å€¼
$Y_i=$ `r x_spc_spl2`ã€‚
ç»™å®š
$x_i=$ `r x_spc_spl2`ï¼Œæ ·æœ¬2çš„æ‹Ÿåˆå€¼
$\hat{Y}_i=$ `r Y_spc_fit`ã€‚
æ®‹å·®
$e_i=Y_i- \hat{Y}_i=$ `r Y_spc_spl2 -Y_spc_fit`

---

## æ ·æœ¬å›å½’ä¸æ€»ä½“å›å½’çš„æ¯”è¾ƒ

```{r}
include_graphics("pic/chpt2-1-PRL-SRL.png", dpi=120)
```

ä¸ºä½•ä¸åŒï¼Ÿ

- ç»§æ‰¿æ€§

- å˜å¼‚æ€§


---

## æ ·æœ¬å›å½’ä¸æ€»ä½“å›å½’çš„æ¯”è¾ƒ

.pull-left[
æ€»ä½“å›å½’å‡½æ•°PRF:

$$\begin{align}
E(Y|X_i) &= \beta_1 +\beta_2X_i && \text{(PRF)}
\end{align}$$

æ€»ä½“å›å½’æ¨¡å‹PRM:

$$\begin{align}
Y_i &=  \beta_1 +\beta_2X_i + u_i && \text{(PRM)}
\end{align}$$

]


.pull-right[
æ ·æœ¬å›å½’å‡½æ•°SRF:

$$\begin{align}
\hat{Y}_i =\hat{\beta}_1 + \hat{\beta}_2X_i && \text{(SRF)}
\end{align}$$

æ ·æœ¬å›å½’æ¨¡å‹SRM:

$$\begin{align}
Y_i &= \hat{\beta}_1 + \hat{\beta}_2X_i +e_i && \text{(SRM)}
\end{align}$$

]

æ€è€ƒï¼š
- PRFæ— æ³•ç›´æ¥è§‚æµ‹ï¼Œåªèƒ½ç”¨SRFè¿‘ä¼¼æ›¿ä»£
- ä¼°è®¡å€¼ä¸è§‚æµ‹å€¼ä¹‹é—´å­˜åœ¨åå·®
- SRFåˆæ˜¯æ€æ ·å†³å®šçš„å‘¢?


---
## æ ·æœ¬å›å½’ä¸æ€»ä½“å›å½’çš„æ¯”è¾ƒ

çŸ¥è¯†ç‚¹æ€»ç»“ï¼š

- éšæœºæŠ½æ ·æ•°æ®ç»§æ‰¿äº†æ€»ä½“çš„ç‰¹å¾ã€‚

- åˆ©ç”¨éšæœºæ ·æœ¬è¿›è¡Œæ•°æ®æ‹Ÿåˆæ˜¯å¯¹æ€»ä½“è§„å¾‹çš„â€œåå‘è¿½è¸ªâ€ã€‚

- æ ·æœ¬å›å½’æ¨¡å‹ä¸­çš„æ®‹å·®æ˜¯æ‹Ÿåˆä¸å®Œå…¨çš„äº§ç‰©ã€‚

è¯¾åæ€è€ƒï¼š

- æ€æ ·æ¥åˆ¤å®šå¯¹éšæœºæ ·æœ¬çš„ä¸€æ¬¡æ•°æ®æ‹Ÿåˆæ˜¯æ›´ä¼˜çš„ï¼Ÿ

- å­˜ä¸å­˜åœ¨ä¸€ç§â€œæœ€ä¼˜â€çš„æ‹Ÿåˆæ–¹æ³•ï¼Ÿ

è¯¾åä½œä¸šï¼š

- è¯·æŠŠ162ååŒå­¦çš„æ‹Ÿåˆçº¿è¿›è¡Œå¹³å‡åŒ–å¤„ç†ï¼ˆæˆªè·å’Œæ–œç‡å–å‡å€¼ï¼‰ï¼Œç»˜åˆ¶å¾—åˆ°ä¸€æ¡â€œå›å½’çº¿â€ã€‚

- ä½ è®¤ä¸ºæ˜¯è¿™æ ¹å¹³å‡åŒ–çš„â€œå›å½’çº¿â€ä¸çœŸç›¸æ›´é€¼è¿‘ä¹ˆï¼Ÿ

---
background-image: url("pic/thank-you-gif-funny-gentle.gif")
class: inverse,center
# æœ¬ç« ç»“æŸ


