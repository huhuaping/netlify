<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>07-multi-linearity-slide.utf8.md</title>
    <meta charset="utf-8" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <link href="libs/remark-css/duke-blue.css" rel="stylesheet" />
    <link href="libs/remark-css/hygge-duke.css" rel="stylesheet" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding/datatables.js"></script>
    <link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core/js/jquery.dataTables.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
    <link rel="stylesheet" href="libs\cc-fonts.css" type="text/css" />
    <link rel="stylesheet" href="libs\figure-captions.css" type="text/css" />
    <link rel="stylesheet" href="libs\animate.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

background-image: url("pic/slide-front-page.jpg")
class: center,middle

# è®¡é‡ç»æµå­¦(Econometrics)

### èƒ¡åå¹³

### è¥¿åŒ—å†œæ—ç§‘æŠ€å¤§å­¦

### ç»æµç®¡ç†å­¦é™¢æ•°é‡ç»æµæ•™ç ”å®¤

### huhuaping01@hotmail.com

### 2019-03-31





&lt;style type="text/css"&gt;
.remark-slide-content {
    font-size: 22px;
    padding: 1em 4em 1em 4em;
}
&lt;/style&gt;

---
class: center, middle,inverse
# ç¬¬7ç« ï¼šæ”¾å®½åŸºæœ¬å‡è®¾ï¼šå¤šé‡å…±çº¿æ€§

å¤šé‡å…±çº¿æ€§çš„æ€§è´¨

å‡ºç°å®Œå…¨å¤šé‡å…±çº¿æ€§æ—¶çš„ä¼°è®¡é—®é¢˜

"é«˜åº¦"ä½†"ä¸å®Œå…¨"å¤šé‡å…±çº¿æ€§æ—¶çš„ä¼°è®¡é—®é¢˜

å¤šé‡å…±çº¿æ€§:å¤šé‡å…±çº¿æ€§çš„ç†è®ºåæœ

å¤šé‡å…±çº¿æ€§çš„å®é™…åæœ

è¯´æ˜æ€§çš„ä¾‹å­

å¤šé‡å…±çº¿æ€§çš„ä¾¦å¯Ÿ

è¡¥æ•‘æªæ–½

å¤šé‡å…±çº¿æ€§ä¸€å®šæ˜¯åäº‹å—?

ä¸€ä¸ªå¼•ç”³çš„ä¾‹:æœ—åˆ©æ•°æ®


---
class: center, middle,inverse
# å¤šé‡å…±çº¿æ€§çš„æ€§è´¨

---
## ä»€ä¹ˆæ˜¯æ¨¡å‹å¤šé‡å…±çº¿æ€§ï¼Ÿï¼ˆå¼•å­1ï¼‰

**æ¶ˆè´¹æ¡ˆä¾‹**ï¼š

`$$\begin {align} 
 Y_{i} &amp;=\hat{\beta}_{1}+\hat{\beta}_{2} X_{2 i}+\hat{\beta}_{3} X_{3 i}+e_{i} 
\end {align}$$`

&lt;img src="pic/chpt7-multi-linearity-demo0.png" width="1413" style="display: block; margin: auto;" /&gt;

- 
`\(Y_i\)`è¡¨ç¤ºæ¶ˆè´¹

- 
`\(X_{2i}\)`è¡¨ç¤ºæ”¶å…¥ï¼›
`\(X_{3i}\)`è¡¨ç¤ºè´¢å¯Œã€‚

---
## ä»€ä¹ˆæ˜¯æ¨¡å‹å¤šé‡å…±çº¿æ€§ï¼Ÿï¼ˆå¼•å­2ï¼‰


**æ…ˆå–„ææ¬¾**æ¡ˆä¾‹ï¼š

**å›å½’æ¨¡å‹**ï¼š

`$$\begin {align} 
 Y_{i} &amp;=\hat{\beta}_{1}+\hat{\beta}_{2} X_{2 i}+\hat{\beta}_{3} X_{3 i}+e_{i} 
\end {align}$$`

- 
`\(Y_i\)`è¡¨ç¤ºæ…ˆå–„ææ¬¾

- 
`\(X_{2i}\)`è¡¨ç¤ºåŸå¸‚æ€»äººå£ï¼›
`\(X_{3i}\)`è¡¨ç¤ºåŸå¸‚GDPã€‚

**ç°å®æƒ…å†µ**ï¼šåŸå¸‚GDP=åŸå¸‚æ€»äººå£*äººå‡GDP

**å¤šé‡å…±çº¿æ€§æ¥æº**ï¼šè‡ªå˜é‡é—´è¡¨ç°ä¸ºæŸç§å› æœå…³ç³»


---
## ä»€ä¹ˆæ˜¯æ¨¡å‹å¤šé‡å…±çº¿æ€§ï¼Ÿï¼ˆå¼•å­3ï¼‰

**æ¶ˆè´¹è€…å¿ è¯šåº¦**æ¡ˆä¾‹ï¼š

**å›å½’æ¨¡å‹**ï¼š

`$$\begin {align} 
 Y_{i} &amp;=\hat{\beta}_{1}+\hat{\beta}_{2} X_{2 i}+\hat{\beta}_{3} X_{3 i}+e_{i} 
\end {align}$$`

- 
`\(Y_i\)`è¡¨ç¤ºæ¶ˆè´¹è€…å¿ è¯šåº¦

- 
`\(X_{2i}\)`è¡¨ç¤ºäº§å“æ»¡æ„åº¦ï¼›
`\(X_{3i}\)`ä½“éªŒæ»¡æ„åº¦ã€‚

**ç°å®æƒ…å†µ**ï¼šæ”¶å…¥æ°´å¹³ä¸æ»¡æ„åº¦æœ‰å…³ï¼ˆå¥¢ä¾ˆå“ã€æ‹¼å¤šå¤šï¼‰

**å¤šé‡å…±çº¿æ€§æ¥æº**ï¼šè‡ªå˜é‡èƒŒåæœ‰å…±åŒçš„æ½œåœ¨å› ç´ 

---
## ä»€ä¹ˆæ˜¯æ¨¡å‹å¤šé‡å…±çº¿æ€§ï¼Ÿ

`$$\begin{align}
Y_i&amp;=\beta_1+\beta_2X_{2i}+\beta_3X_{3i}+\cdots+\beta_kX_{ki}+u_i 
&amp;&amp; \text{(PRM)}\\
Y_i&amp;=\hat{\beta}_1+\hat{\beta}_2X_{2i}+\hat{\beta}_3X_{3i}+\cdots+\hat{\beta}_kX_{ki}+e_i 
&amp;&amp; \text{(SRM)}
\end{align}$$`

**å¤šé‡å…±çº¿æ€§**ï¼šåœ¨å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹ä¸­ï¼Œå„è§£é‡Šå˜é‡
`\(\{X_2,X_3,\cdots,X_k\}\)`ä¹‹é—´æœ‰äº¤äº’ç›¸å…³ï¼Œä½†åˆéå®Œå…¨ç›¸å…³çš„ç°è±¡ã€‚æ­£å¼åœ°ï¼š

`$$\begin{align}
\lambda_2X_{2i}+\lambda_3X_{3i}+\cdots+\lambda_kX_{ki}+v_i=0 
\end{align}$$`

å…¶ä¸­ï¼Œ
`\(v_i\)`ä¸ºéšæœºè¯¯å·®é¡¹ã€‚

æˆ‘ä»¬ç§°æ€»ä½“å›å½’æ¨¡å‹å­˜åœ¨**å¤šé‡å…±çº¿æ€§**ï¼Œæ­¤æ—¶
`\(\lambda_1;\lambda_2;\cdots;\lambda_k\)`ä¸å…¨ä¸º0ï¼Œä¸”
`\(v_i \neq 0\)`ã€‚

æˆ‘ä»¬ç§°æ€»ä½“å›å½’æ¨¡å‹å­˜åœ¨**å®Œå…¨å¤šé‡å…±çº¿æ€§**ï¼Œæ­¤æ—¶
`\(\lambda_1;\lambda_2;\cdots;\lambda_k\)`ä¸å…¨ä¸º0ï¼Œä¸”
`\(v_i = 0\)`ã€‚

---
## ä»€ä¹ˆæ˜¯æ¨¡å‹å¤šé‡å…±çº¿æ€§ï¼Ÿ

ä¸‹é¢ç”¨ä¸€ä¸ªç›´è§‚å›¾è¿›è¡Œè¯´æ˜ï¼š

&lt;img src="pic/chpt7-multi-linearity-demo1.png" width="681" style="display: block; margin: auto;" /&gt;

---
## ä»€ä¹ˆæ˜¯æ¨¡å‹å¤šé‡å…±çº¿æ€§ï¼Ÿ


- ç®€å•ç›¸å…³r(Pearson Relationship)

- å¤šé‡å…±çº¿æ€§(Multicollinearity)

&lt;img src="pic/chpt7-multi-linearity-demo2.png" width="395" style="display: block; margin: auto;" /&gt;

---
## å¼•èµ·å¤šé‡å…±çº¿æ€§çš„åŸå› 

- æ•°æ®é‡‡é›†æ‰€ç”¨çš„æ–¹æ³•: å›å½’å…ƒé™äºä¸€ä¸ªèŒƒå›´

- æ¨¡å‹æˆ–ä»ä¸­å–æ ·çš„æ€»ä½“å—åˆ°çº¦æŸï¼šå¦‚åšç”µåŠ›æ¶ˆè´¹ï¼ˆYï¼‰å¯¹æ”¶å…¥ï¼ˆX2ï¼‰å’Œä½æˆ¿é¢ç§¯ï¼ˆX3ï¼‰å›å½’æ—¶ï¼Œå¯èƒ½X2é«˜çš„X3ä¹Ÿå¤§

- æ¨¡å‹è®¾å®š: å¦‚åœ¨æ¨¡å‹ä¸­åŠ å…¥å¤šé¡¹å¼ï¼›æ•°æ®èŒƒå›´å°ç­‰

- ä¸€ä¸ªè¿‡åº¦å†³å®šçš„æ¨¡å‹ï¼šå›å½’å…ƒä¸ªæ•°å¤§äºè§‚æµ‹æ¬¡æ•°ã€‚åŒ»å­¦ç ”ç©¶ä¸­å¯èƒ½åªæœ‰å°‘æ•°ç—…äºº

- ç›¸åŒçš„æ—¶é—´è¶‹åŠ¿ã€‚æ¶ˆè´¹æ”¯å‡º(Y)å¯¹æ”¶å…¥ã€è´¢å¯Œå’Œäººå£çš„å›å½’

---
## å®Œå…¨å¤šé‡å…±çº¿æ€§æ—¶çš„ä¼°è®¡é—®é¢˜

åœ¨å®Œå…¨å¤šé‡å…±çº¿æ€§çš„æƒ…å†µä¸‹ï¼Œå›å½’ç³»æ•°æ˜¯ä¸ç¡®å®šçš„ã€‚

`$$\begin {align} 
 Y_{i} &amp;=\hat{\beta}_{1}+\hat{\beta}_{2} X_{2 i}+\hat{\beta}_{3} X_{3 i}+e_{i} 
\end {align}$$`

`$$\begin {align} 
\hat{\beta}_{1} &amp;=\overline{Y}-\hat{\beta}_{2} \overline{X}-\hat{\beta}_{3} \overline{X}_{3} \\ 
\hat{\beta}_{2} &amp;=\frac{\left(\sum y_{i} x_{2 i}\right)\left(\sum x_{3 i}^{2}\right)-\left(\sum y_{i} x_{3 i}\right)\left(\sum x_{2 i} x_{3 i}\right)}{\left(\sum x_{2 i}^{2}\right)\left(\sum x_{3 i}^{2}\right)-\left(\sum x_{2 i} x_{3 i}\right)^{2}} \\ 
\hat{\beta}_{3} &amp;=\frac{\left(\sum y_{i} x_{3 i}\right)\left(\sum x_{2 i}^{2}\right)-\left(\sum y_{i} x_{2 i}\right)\left(\sum x_{2 i} x_{3 i}\right)}{\left(\sum x_{2 i}^{2}\right)\left(\sum x_{3 i}^{2}\right)-\left(\sum x_{2 i} x_{3 i}\right)^{2}} 
\end {align}$$`

---
## å®Œå…¨å¤šé‡å…±çº¿æ€§æ—¶çš„ä¼°è®¡é—®é¢˜

åœ¨å®Œå…¨å¤šé‡å…±çº¿æ€§çš„æƒ…å†µä¸‹ï¼Œå›å½’ç³»æ•°æ˜¯ä¸ç¡®å®šçš„ã€‚

å‡è®¾**å®Œå…¨å…±çº¿æ€§**æƒ…å½¢ä¸‹ï¼Œ
`\(X_{3 i}=\lambda X_{2 i}\)`ï¼Œåˆ™å®¹æ˜“å‘ç°ï¼š

`$$\begin {align} 
\hat{\beta}_{2}=\frac{\left(\sum y_{i} x_{2 i}\right)\left(\lambda^{2} \sum x_{2 i}^{2}\right)-\left(\lambda \sum y_{i} x_{2 i}\right)\left(\lambda \sum x_{2 i}^{2}\right)}{\left(\sum x_{2 i}^{2}\right)\left(\lambda^{2} \sum x_{2 i}^{2}\right)-\lambda^{2}\left(\sum x_{2 i}^{2}\right)^{2}}=\frac{0}{0}
\end {align}$$`


---
## å®Œå…¨å¤šé‡å…±çº¿æ€§æ—¶çš„ä¼°è®¡é—®é¢˜

åœ¨å®Œå…¨å¤šé‡å…±çº¿æ€§çš„æƒ…å†µä¸‹ï¼Œå›å½’ç³»æ•°æ˜¯ä¸ç¡®å®šçš„ã€‚

å‡å®š**ä¸å®Œå…¨å¤šé‡å…±çº¿æ€§**ä¸‹ï¼Œ
`\(x_{3 i}=\lambda x_{2 i}+v_{i}\)`ï¼Œåˆ™æœ‰ï¼š

`$$\begin {align} 
\hat{\beta}_{2}=\frac{\sum\left(y_{i} x_{2 i}\right)\left(\lambda^{2} \sum x_{2 i}^{2}+\sum v_{i}^{2}\right)-\left(\lambda \sum y_{i} x_{2 i}+\sum y_{i} v_{i}\right)\left(\lambda \sum x_{2 i}^{2}\right)}{\sum x_{2 i}^{2}\left(\lambda^{2} \sum x_{2 i}^{2}+\sum v_{i}^{2}\right)-\left(\lambda \sum x_{2 i}^{2}\right)^{2}}
\end {align}$$`

å¦‚æœ
`\(v_i\)`è¶³å¤Ÿå°ï¼Œä»¥è‡³äºæ¥è¿‘äºé›¶ï¼Œåˆ™ä¸Šå¼å°†è¡¨ç¤º**å®Œå…¨å…±çº¿æ€§**æƒ…å½¢ã€‚

---
## å¤šé‡å…±çº¿æ€§çš„ç†è®ºåæœ

å¦‚æœæ¨¡å‹å‡ºç°å¤šé‡å…±çº¿æ€§é—®é¢˜ï¼Œåœ¨N-CLRMå‡è®¾ä¸‹ï¼ŒOLSä¼°è®¡é‡ä»ç„¶æ˜¯æœ€ä¼˜çº¿æ€§æ— åä¼°è®¡é‡ï¼ˆBLUEï¼‰ï¼š

- åªè¦ä¸æ˜¯**å®Œå…¨å…±çº¿æ€§**ï¼Œåœ¨è¿‘ä¼¼å¤šé‡å…±çº¿æ€§çš„æƒ…å½¢ä¸‹ï¼ŒOLSä¼°è®¡é‡ä»ç„¶æ˜¯æ— åçš„

- åªè¦ä¸æ˜¯**å®Œå…¨å…±çº¿æ€§**ï¼Œåœ¨è¿‘ä¼¼å¤šé‡å…±çº¿æ€§çš„æƒ…å½¢ä¸‹ï¼ŒOLSä¼°è®¡é‡çš„æ–¹å·®ä¸€å®šæ˜¯å°çš„

- å¤šé‡å…±çº¿æ€§æœ¬è´¨ä¸Šæ˜¯ä¸€ç§æ ·æœ¬ç°è±¡ã€‚å³ä½¿æ€»ä½“ä¸­Xå˜é‡é—´ä¸å­˜åœ¨å…±çº¿æ€§ï¼Œç”±äºæŠ½æ ·æ–¹æ³•æˆ–å°æ ·æœ¬é—®é¢˜ï¼Œä¹Ÿå¯èƒ½å¸¦æ¥å¤šé‡å…±çº¿æ€§é—®é¢˜


---
## å¤šé‡å…±çº¿æ€§çš„å®é™…åæœ

**å®é™…åæœ1**ï¼šæ›´å¤§çš„æ–¹å·®å’Œåæ–¹å·®ï¼Œä¼°è®¡ç²¾åº¦å¤§å¤§ä¸‹é™ã€‚
`\(\hat{\beta}_2\)`å’Œ
`\(\hat{\beta}_3\)`çš„**çœŸå®æ–¹å·®**åˆ†åˆ«ä¸ºï¼š

`$$\begin {align} 
\sigma_{\hat{\beta}_{2}}^{2} 
 =\frac{\sigma^{2}}{\sum x_{2 i}^{2}\left(1-r_{23}^{2}\right)} 
 \equiv \frac{\sigma^{2}}{\sum x_{2 i}^{2} \cdot TOL} 
 \equiv \frac{\sigma^{2}}{\sum x_{2 i}^{2}} \cdot VIF 
\end {align}$$`

`$$\begin {align} 
\sigma_{\hat{\beta}_{3}}^{2} 
 =\frac{\sigma^{2}}{\sum x_{3 i}^{2}\left(1-r_{23}^{2}\right)} 
 \equiv \frac{\sigma^{2}}{\sum x_{3 i}^{2} \cdot TOL} 
 \equiv \frac{\sigma^{2}}{\sum x_{3 i}^{2}} \cdot VIF 
\end {align}$$`

`$$\begin {align} 
\operatorname{cov}\left(\hat{\beta}_{2}, \hat{\beta}_{3}\right) &amp; =\frac{-r_{23} \sigma^{2}}{\left(1-r_{23}^{2}\right) \sqrt{\sum x_{2 i}^{2}} \sqrt{\sum x_{3 i}^{2}}} &amp;&amp; \leftarrow \left[ r_{23}^{2}=\frac{\left(\sum x_{2 i} x_{3 i}\right)^{2}}{\sum x_{2 i}^{2} \sum x_{3 i}^{2}} \right] 
\end {align}$$`

`$$\begin {align} 
r_{23}^{2}  \equiv \frac{\left(\sum x_{2 i} x_{3 i}\right)^{2}}{\sum x_{2 i}^{2} \sum x_{3 i}^{2}};  \quad
TOL  \equiv \left(1-r_{23}^{2}\right);  \quad
VIF  \equiv \frac{1}{\left(1-r_{23}^{2}\right)} 
\end {align}$$`

éšç€
`\(r_{23}\)`çš„å¢å¤§ï¼Œæ–¹å·®å’Œåæ–¹å·®çš„ç»å¯¹å€¼ä¹Ÿå¢å¤§ã€‚

---
## å¤šé‡å…±çº¿æ€§çš„å®é™…åæœ

æ–¹å·®å¢å¤§çš„é€Ÿåº¦ç”¨**æ–¹å·®è†¨èƒ€å› å­**(VIF, variance-inflating factor)è¡¡é‡ï¼š

`$$\begin {align} 
VIF=\frac{1}{\left(1-r_{23}^{2}\right)}
\end {align}$$`

**å®¹å¿åº¦**(tolerance , TOL)å®šä¹‰ä¸ºVIFçš„å€’æ•°ï¼š

`$$\begin {align} 
\mathrm{TOL}_{\mathrm{j}}=\frac{1}{VIF_{\mathrm{j}}}=1-R_{j}^{2}
\end {align}$$`

`\(R^2_j\)`è¡¨ç¤º
`\(X_j\)`å¯¹å…¶ä½™(k-2)ä¸ªå›å½’å…ƒè¿›è¡Œå›å½’çš„åˆ¤å®šç³»æ•°

- å½“
`\(R_j^2=1\)`ï¼Œå³å®Œå…¨å…±çº¿æ€§æ—¶ï¼Œ
`\(TOL_j=0\)`; 

- å½“
`\(R_j^2=0\)`ï¼Œå³ä¸å­˜åœ¨å…±çº¿æ€§æ—¶ï¼Œ
`\(TOL_j=1\)`; 

- ç”±äºVIF å’ŒTOL ä¹‹é—´æœ‰å¯†åˆ‡å…³ç³»ï¼Œæ‰€ä»¥å¯ä»¥å°†å®ƒä»¬äº’æ¢ä½¿ç”¨ã€‚

&gt; æ³¨æ„: ï¼ˆå¤æ‰æ‹‰è’‚ï¼‰åœ¨kä¸ªå˜é‡çš„å›å½’æ¨¡å‹ä¸­æœ‰æ˜¯k-1ä¸ªå›å½’å…ƒã€‚


---
## å¤šé‡å…±çº¿æ€§çš„å®é™…åæœ

**å®é™…åæœ2**ï¼šç½®ä¿¡åŒºé—´å˜å®½ï¼Œç³»æ•°çš„æ£€éªŒå€¾å‘äºä¸æ˜¾è‘—ï¼å³æ›´å€¾å‘æ¥å—åŸå‡è®¾H0ï¼Œè®¤ä¸ºç³»æ•°ä¸ºé›¶ã€‚

- æ ‡å‡†è¯¯å¢å¤§ï¼Œåˆ™æœ‰å…³æ€»ä½“å‚æ•°çš„ç½®ä¿¡åŒºé—´éšä¹‹å˜å¤§ã€‚

`$$\begin{align}
\hat{\beta}_{1} \pm t_{1- \alpha / 2}(n-k) \cdot S_{\hat{\beta}_{1}}\\
\hat{\beta}_{2} \pm t_{1- \alpha / 2}(n-k) \cdot S_{\hat{\beta}_{2}}\\
\hat{\beta}_{3} \pm t_{1- \alpha / 2}(n-k) \cdot S_{\hat{\beta}_{3}}
\end{align}$$`



---
## å¤šé‡å…±çº¿æ€§çš„å®é™…åæœ

**å®é™…åæœ3**ï¼šç³»æ•°çš„tå€¼å€¾å‘äºç»Ÿè®¡ä¸Šä¸æ˜¾è‘—ï¼Œä½†
`\(R^2\)`å´ä¼šå¾ˆé«˜ã€‚

`$$\begin{align} 
t^{\ast}_{\hat{\beta}_1}&amp;=\frac{\hat{\beta}_{1}}{S_{\hat{\beta}_{1}}} \\
t^{\ast}_{\hat{\beta}_2}&amp;=\frac{\hat{\beta}_{2}}{S_{\hat{\beta}_{2}}}
\\
t^{\ast}_{\hat{\beta}_3}&amp;=\frac{\hat{\beta}_{3}}{S_{\hat{\beta}_{3}}}
\end{align}$$`


å°†
`\(t^{\ast}_{\hat{\beta}_i}\)`å€¼å’Œä¸´ç•Œtå€¼ç›¸æ¯”è¾ƒã€‚é«˜åº¦å…±çº¿æ€§ä½¿ä¼°è®¡çš„æ ‡å‡†è¯¯å¢åŠ å¾ˆå¿«ï¼Œtå€¼è¿…é€Ÿå˜å°ã€‚

å› è€Œï¼Œåœ¨é«˜åº¦å¤šé‡å…±çº¿æ€§çš„æƒ…å½¢ä¸‹ï¼Œå¢åŠ äº†æ¥å—é”™è¯¯å‡è®¾çš„æ¦‚ç‡ï¼ˆç¬¬äºŒç±»é”™è¯¯ï¼‰

---
## å¤šé‡å…±çº¿æ€§çš„å®é™…åæœ

**å®é™…åæœ3**ï¼šç³»æ•°çš„tå€¼å€¾å‘äºç»Ÿè®¡ä¸Šä¸æ˜¾è‘—ï¼Œä½†
`\(R^2\)`å´ä¼šå¾ˆé«˜ã€‚

- åœ¨é«˜åº¦å…±çº¿æ€§æƒ…å½¢ä¸­ï¼Œæœ‰å¯èƒ½ä¼šå‘ç°ä¸€ä¸ªæˆ–å¤šä¸ªåæ–œç‡ç³»æ•°åŸºäºtæ£€éªŒä¸æ˜¯ä¸ªåˆ«ç»Ÿè®¡æ˜¾è‘—çš„ï¼Œç„¶è€Œè¿™æ—¶
`\(R^2\)`å´é«˜è¾¾(æ¯”å¦‚è¯´)0.9ä»¥ä¸Šï¼Œä»è€Œæ ¹æ®Fæ£€éªŒï¼Œå¯ä»¤äººä¿¡æœåœ°æ‹’ç»åŸå‡è®¾ï¼š

`$$H_{0} : \beta_{2}=\beta_{3}=\cdots=\beta_{k}=0$$`
- ä½†æ˜¯ï¼Œä¸ªåˆ«åå›å½’ç³»æ•°çš„tæ£€éªŒå¯èƒ½å¹¶ä¸æ˜¾è‘—â€”â€”è¿™å°±æ˜¯å¤šé‡å…±çº¿æ€§çš„ä¸€ä¸ªä¿¡å·

- è¿™é‡Œçš„çœŸæ­£é—®é¢˜åœ¨äºä¼°è®¡é‡ä¹‹é—´çš„åæ–¹å·®ï¼Œè€Œè¿™äº›åæ–¹å·®æ˜¯åŒå›å½’å…ƒä¹‹é—´çš„ç›¸å…³æ€§æœ‰å…³ç³»çš„ã€‚

---
## å¤šé‡å…±çº¿æ€§çš„å®é™…åæœ

**å®é™…åæœ4**ï¼šOLSä¼°è®¡é‡åŠå…¶æ ‡å‡†è¯¯å¯¹æ•°æ®çš„å¾®å°å˜åŒ–éå¸¸æ•æ„Ÿã€‚



---
### è¯´æ˜æ€§ä¾‹å­ï¼ˆæ•°æ®ï¼‰




&lt;div class="figure" style="text-align: center"&gt;
<div id="htmlwidget-95d23df90af6ac33853a" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-95d23df90af6ac33853a">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54"],[1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962,1963,1964,1965,1966,1967,1968,1969,1970,1971,1972,1973,1974,1975,1976,1977,1978,1979,1980,1981,1982,1983,1984,1985,1986,1987,1988,1989,1990,1991,1992,1993,1994,1995,1996,1997,1998,1999,2000],[976.4,998.1,1025.3,1090.9,1107.1,1142.4,1197.2,1221.9,1310.4,1348.8,1381.8,1393,1470.7,1510.8,1541.2,1617.3,1684,1784.8,1897.6,2006.1,2066.2,2184.2,2264.8,2317.5,2405.2,2550.5,2675.9,2653.7,2710.9,2868.9,2992.1,3124.7,3203.2,3193,3236,3275.5,3454.3,3640.6,3820.9,3981.2,4113.4,4279.5,4393.7,4474.5,4466.6,4594.5,4748.9,4928.1,5075.6,5237.5,5423.9,5683.7,5968.4,6257.8],[1035.2,1090,1095.6,1192.7,1227,1266.8,1327.5,1344,1433.8,1502.3,1539.5,1553.7,1623.8,1664.8,1720,1803.5,1871.5,2006.9,2131,2244.6,2340.5,2448.2,2524.3,2630,2745.3,2874.3,3072.3,3051.9,3108.5,3243.5,3360.7,3527.5,3628.6,3658,3741.1,3791.7,3906.9,4207.6,4347.8,4486.6,4582.5,4784.1,4906.5,5014.2,5033,5189.3,5261.3,5397.2,5539.1,5677.7,5854.5,6168.6,6320,6539.2],[5166.815,5280.757,5607.351,5759.515,6086.056,6243.864,6355.613,6797.027,7172.242,7375.18,7315.286,7869.975,8188.054,8351.757,8971.872,9091.545,9436.097,10003.4,10562.81,10522.04,11312.07,12145.41,11672.25,11650.04,12312.92,13499.92,13080.96,11868.79,12634.36,13456.78,13786.31,14450.5,15340,15964.95,15964.99,16312.51,16944.85,17526.75,19068.35,20530.04,21235.69,22331.99,23659.8,23105.13,24050.21,24418.2,25092.33,25218.6,27439.73,29448.19,32664.07,35587.02,39591.26,38167.72],[-10.35094,-4.719804,1.044063,0.407346,-5.283152,-0.277011,0.561137,-0.138476,0.261997,-0.736124,-0.260683,-0.57463,2.295943,1.511181,1.296432,1.395922,2.057616,2.026599,2.111669,2.020251,1.212616,1.054986,1.732154,1.166228,-0.712241,-0.155737,1.413839,-1.042571,-3.533585,-0.656766,-1.190427,0.113048,1.70421,2.298496,4.703847,4.449027,4.690972,5.848332,4.330504,3.768031,2.819469,3.287061,4.317956,3.595025,1.802757,1.007439,0.62479,2.206002,3.333143,3.083201,3.12,3.583909,3.245271,3.57597]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Year<\/th>\n      <th>Y<\/th>\n      <th>X2<\/th>\n      <th>X3<\/th>\n      <th>X4<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"dom":"tip","columnDefs":[{"className":"dt-center","targets":"_all"},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
&lt;p class="caption"&gt;æ¶ˆè´¹æ”¯å‡ºä¸æ”¶å…¥å’Œè´¢å¯Œçš„æ•°æ®(n=54)&lt;/p&gt;
&lt;/div&gt;

- `\(Y_i\)`è¡¨ç¤ºäººå‡æ¶ˆè´¹æ”¯å‡º

- `\(X_{2i}\)`è¡¨ç¤ºäººå‡æ”¶å…¥ï¼›
`\(X_{3i}\)`è¡¨ç¤ºè´¢å¯Œï¼›
`\(X_{4i}\)`è¡¨ç¤ºåˆ©ç‡


---
### è¯´æ˜æ€§ä¾‹å­ï¼ˆç²¾ç®€åˆ†ææŠ¥å‘Šï¼‰

æˆ‘ä»¬å¯ä»¥æ„å»ºå¦‚ä¸‹çš„å›å½’æ¨¡å‹ï¼š

`$$\begin{equation} \begin{alignedat}{999} &amp;log(Y)=&amp;&amp; + \beta_{1} &amp;&amp; + \beta_{2} log(X2)&amp;&amp; + \beta_{3} log(X3)&amp;&amp; + \beta_{4} X4&amp;&amp;+e_i\\ \end{alignedat} \end{equation}$$`


è®¡ç®—å¹¶æ•´ç†å›å½’åˆ†æç»“æœå¦‚ä¸‹ï¼š

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{log(Y)}=&amp;&amp;-0.47&amp;&amp;+0.80log(X2)&amp;&amp;+0.20log(X3)&amp;&amp;-0.00X4\\ &amp;\text{(t)}&amp;&amp;(-10.9334)&amp;&amp;(45.9984)&amp;&amp;(11.4406)&amp;&amp;(-3.5293)\\&amp;\text{(se)}&amp;&amp;(0.0428)&amp;&amp;(0.0175)&amp;&amp;(0.0176)&amp;&amp;(0.0008)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9996;&amp;&amp; \bar{R^2}=0.9995\\&amp; &amp;&amp; F^{\ast}=37832.61;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

---
### è¯´æ˜æ€§ä¾‹å­ï¼ˆEViewsè½¯ä»¶æŠ¥å‘Šï¼‰


&lt;img src="pic/chpt7-example-EViews-10-2-US.png" width="793" style="display: block; margin: auto;" /&gt;


---
### è¯´æ˜æ€§ä¾‹å­ï¼ˆRè½¯ä»¶æŠ¥å‘Šï¼‰

åˆ©ç”¨`R`è½¯ä»¶ç»™å‡ºæ›´ä¸ºè¯¦ç»†çš„åˆ†ææŠ¥å‘Šå¦‚ä¸‹ï¼š


```

Call:
lm(formula = mod_mat, data = data_income)

Residuals:
     Min       1Q   Median       3Q      Max 
-0.01844 -0.01000  0.00034  0.00704  0.03258 

Coefficients:
             Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) -0.467711   0.042778  -10.93  7.3e-15 ***
log(X2)      0.804873   0.017498   46.00  &lt; 2e-16 ***
log(X3)      0.201270   0.017593   11.44  1.4e-15 ***
X4          -0.002689   0.000762   -3.53   0.0009 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.0119 on 50 degrees of freedom
Multiple R-squared:     1,	Adjusted R-squared:     1 
F-statistic: 3.78e+04 on 3 and 50 DF,  p-value: &lt;2e-16
```


---
### è¯´æ˜æ€§ä¾‹å­ï¼ˆANOVAï¼‰



<div id="htmlwidget-9e746e799994433c3447" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-9e746e799994433c3447">{"x":{"filter":"none","data":[["1","2","3"],["å›å½’å¹³æ–¹å’Œ","æ®‹å·®å¹³æ–¹å’Œ","æ€»å¹³æ–¹å’Œ"],["ESS","RSS","TSS"],["\\( \\sum{\\hat{y}_i^2} \\)","\\( \\sum{e_i^2} \\)","\\( \\sum{y_i^2}\\)"],[3,50,53],["\\(MSS_{ESS}\\)","\\(MSS_{RSS}\\)","\\(MSS_{TSS}\\)"],["\\(  \\boldsymbol{\\hat{\\beta}'X'y}-n\\bar{Y}^2= \\)16.1637","\\( \\boldsymbol{yy'-\\hat{\\beta}'X'y} \\)=0.0071","\\( \\boldsymbol{y'y}-n\\bar{Y}^2 \\)=16.1709"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>å˜å¼‚æ¥æº<\/th>\n      <th>å¹³æ–¹å’Œç¬¦å·SS<\/th>\n      <th>å¹³æ–¹å’Œè®¡ç®—å…¬å¼<\/th>\n      <th>è‡ªç”±åº¦df<\/th>\n      <th>å‡æ–¹å’Œç¬¦å·MSS<\/th>\n      <th>å‡æ–¹å’Œè®¡ç®—å…¬å¼<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-center","targets":"_all"},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false}},"evals":[],"jsHooks":[]}</script>

---
### è¯´æ˜æ€§ä¾‹å­ï¼ˆFæ£€éªŒï¼‰

æ ¹æ®æ–¹å·®åˆ†æè¡¨ANOVAå’Œæ ·æœ¬Fç»Ÿè®¡é‡è®¡ç®—å…¬å¼ï¼Œå¯ä»¥å¾—åˆ°ï¼š

`$$\begin{align}
F^{\ast}=\frac{ESS_U/df_{ESS_U}}{RSS_U/df_{RSS_U}}=\frac{\left(\boldsymbol{\hat{\beta}'X'y}-n\bar{Y}^2\right)/{(k-1)}}{\left(\boldsymbol{yy'-\hat{\beta}'X'y}\right)/{(n-k)}}
=\frac{16.1637/3}{0.0071/50} =37832.6142
\end{align}$$`

å¾—åˆ°æ˜¾è‘—æ€§æ£€éªŒçš„åˆ¤æ–­ç»“è®ºã€‚å› ä¸º
`\(F^{\ast}=\)` 37832.6142 .red[**å¤§äº**] `\(F_{1-\alpha}(k-1,n-k)=F_{0.95}\)`(3,50)=2.7900ï¼Œæ‰€ä»¥æ¨¡å‹æ•´ä½“æ˜¾è‘—æ€§çš„Fæ£€éªŒç»“æœ**æ˜¾è‘—**ã€‚

---
### è¯´æ˜æ€§ä¾‹å­ï¼ˆå…¶ä»–æ¨¡å‹ï¼‰

æ­¤å¤–ï¼Œæˆ‘ä»¬å¯ä»¥åˆ†åˆ«æ„å»ºå¦‚ä¸‹å›å½’æ¨¡å‹ï¼Œå¹¶å¾—åˆ°å›å½’åˆ†æç»“æœï¼š

.pull-left[

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{log(X3)}=&amp;&amp;+1.65&amp;&amp;+0.99log(X2)\\ &amp;\text{(t)}&amp;&amp;(8.8575)&amp;&amp;(42.0585)\\&amp;\text{(se)}&amp;&amp;(0.1868)&amp;&amp;(0.0235)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9714;&amp;&amp; \bar{R^2}=0.9709\\&amp; &amp;&amp; F^{\ast}=1768.92;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{log(X2)}=&amp;&amp;-1.40&amp;&amp;+0.98log(X3)\\ &amp;\text{(t)}&amp;&amp;(-6.2996)&amp;&amp;(42.0585)\\&amp;\text{(se)}&amp;&amp;(0.2223)&amp;&amp;(0.0234)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9714;&amp;&amp; \bar{R^2}=0.9709\\&amp; &amp;&amp; F^{\ast}=1768.92;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

]

.pull-right[

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{log(Y)}=&amp;&amp;-0.07&amp;&amp;+1.00log(X2)\\ &amp;\text{(t)}&amp;&amp;(-1.6471)&amp;&amp;(178.3010)\\&amp;\text{(se)}&amp;&amp;(0.0444)&amp;&amp;(0.0056)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9984;&amp;&amp; \bar{R^2}=0.9983\\&amp; &amp;&amp; F^{\ast}=31791.26;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{log(Y)}=&amp;&amp;-1.52&amp;&amp;+0.98log(X3)\\ &amp;\text{(t)}&amp;&amp;(-8.3771)&amp;&amp;(51.5957)\\&amp;\text{(se)}&amp;&amp;(0.1814)&amp;&amp;(0.0191)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9808;&amp;&amp; \bar{R^2}=0.9805\\&amp; &amp;&amp; F^{\ast}=2662.12;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

]

---
class: center, middle,inverse
# å¦‚ä½•è¯Šæ–­æ¨¡å‹å¤šé‡å…±çº¿æ€§é—®é¢˜ï¼Ÿ


---
## å¤šé‡å…±çº¿æ€§è¯Šæ–­ï¼šéƒåˆ©æ¡ˆä¾‹



&lt;div class="figure" style="text-align: center"&gt;
<div id="htmlwidget-2776c2e77ada3afcf920" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-2776c2e77ada3afcf920">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16"],[1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,null],[1947,1948,1949,1950,1951,1952,1953,1954,1955,1956,1957,1958,1959,1960,1961,1962],[60323,61122,60171,61187,63221,63639,64989,63761,66019,67857,68169,66513,68655,69564,69331,70551],[830,885,882,895,962,981,990,1000,1012,1046,1084,1108,1126,1142,1157,1169],[234289,259426,258054,284599,328975,346999,365385,363112,397469,419180,442769,444546,482704,502601,518173,554894],[2356,2325,3682,3351,2099,1932,1870,3578,2904,2822,2936,4681,3813,3931,4806,4007],[1590,1456,1616,1650,3099,3594,3547,3350,3048,2857,2798,2637,2552,2514,2572,2827],[107608,108632,109773,110929,112075,113270,115094,116219,117388,118734,120445,121950,123366,125368,127852,130081],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>obs<\/th>\n      <th>Year<\/th>\n      <th>Y<\/th>\n      <th>X2<\/th>\n      <th>X3<\/th>\n      <th>X4<\/th>\n      <th>X5<\/th>\n      <th>X6<\/th>\n      <th>X7<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":5,"dom":"tip","columnDefs":[{"className":"dt-center","targets":"_all"},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>
&lt;p class="caption"&gt;ç¾å›½å°±ä¸šæƒ…å†µçš„éƒåˆ©æ•°æ®(n=16)&lt;/p&gt;
&lt;/div&gt;

- `\(Y_i\)`è¡¨ç¤ºå°±ä¸šäººæ•°ï¼›

- `\(X_{2i}\)`è¡¨ç¤ºæ¶ˆè´¹ä»·æ ¼æŒ‡æ•°ï¼ˆCPIï¼‰ï¼›
`\(X_{3i}\)`è¡¨ç¤ºå›½æ°‘ç”Ÿäº§æ€»å€¼ï¼ˆGNPï¼Œä»¥ç™¾ä¸‡ç¾å…ƒè®¡); 
`\(X_{4i}\)`è¡¨ç¤ºå¤±ä¸šäººæ•°(ä»¥åƒäººè®¡) ;
`\(X_{5i}\)`è¡¨ç¤ºå†›é˜Ÿä¸­çš„äººæ•°; 
`\(X_{6i}\)`è¡¨ç¤º14 å²ä»¥ä¸Šçš„éæœºæ„äººå£æ•°; 
`\(X_{7i}\)`è¡¨ç¤ºæ—¶é—´ï¼ˆ
`\(t=1,2,\cdots,n\)`ï¼‰

---
## ç›¸å…³æ€§åˆ†æè¯Šæ–­æ³•
 
åˆ©ç”¨æ ·æœ¬æ•°æ®ç»˜åˆ¶å›¾å½¢å’Œå›¾è¡¨ï¼Œåˆ†æè‡ªå˜é‡ä¹‹é—´æ˜¯å¦å­˜åœ¨æ˜æ˜¾ç›¸å…³å…³ç³»ã€‚å¦‚æœæœ‰ï¼Œåˆ™è¡¨æ˜æ¨¡å‹å¾ˆå¯èƒ½ä¼šäº§ç”Ÿ**å¤šé‡å…±çº¿æ€§**é—®é¢˜ã€‚

åˆ¤æ–­ä¾æ®ï¼š

- **ç›¸å…³ç³»æ•°çŸ©é˜µ**å‘ç°é«˜åº¦çº¿æ€§ç›¸å…³ï¼ˆç›¸å…³ç³»æ•°å¤§äº0.8ï¼‰

- **æ•£ç‚¹å›¾çŸ©é˜µ**å‘ç°é«˜åº¦çº¿æ€§ç›¸å…³çš„æ•°æ®åˆ†å¸ƒæ¨¡å¼

---
## ç›¸å…³æ€§åˆ†æè¯Šæ–­æ³•ï¼ˆæ¡ˆä¾‹ï¼‰

éƒåˆ©æ¡ˆä¾‹ä¸­ï¼Œç›¸å…³ç³»æ•°çŸ©é˜µè¡¨è®¡ç®—å¦‚ä¸‹ï¼š

&lt;div class="figure" style="text-align: center"&gt;
<div id="htmlwidget-64f2742228d97d5b4c97" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-64f2742228d97d5b4c97">{"x":{"filter":"none","data":[["X2","X3","X4","X5","X6","X7"],[1,0.991589178024782,0.620633392559096,0.464744187600675,0.979163432977498,0.991149190067205],[0.991589178024782,1,0.604260939889558,0.446436791892627,0.991090069458478,0.995273483764785],[0.620633392559096,0.604260939889558,1,-0.177420629501878,0.686551516365312,0.668256604562175],[0.464744187600675,0.446436791892627,-0.177420629501878,1,0.364416267189032,0.417245149834945],[0.979163432977498,0.991090069458478,0.686551516365312,0.364416267189032,1,0.993952846232926],[0.991149190067205,0.995273483764785,0.668256604562175,0.417245149834945,0.993952846232926,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>X2<\/th>\n      <th>X3<\/th>\n      <th>X4<\/th>\n      <th>X5<\/th>\n      <th>X6<\/th>\n      <th>X7<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"pageLength":7,"dom":"t","columnDefs":[{"className":"dt-right","targets":[1,2,3,4,5,6]},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[7,10,25,50,100],"rowCallback":"function(row, data) {\nDTWidget.formatRound(this, row, data, 1, 4, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 2, 4, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 3, 4, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 4, 4, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 5, 4, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 6, 4, 3, ',', '.');\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>
&lt;p class="caption"&gt;ç›¸å…³ç³»æ•°çŸ©é˜µè¡¨&lt;/p&gt;
&lt;/div&gt;

&gt; 
`\(Y_i\)`è¡¨ç¤ºå°±ä¸šäººæ•°ï¼›
`\(X_{2i}\)`è¡¨ç¤ºæ¶ˆè´¹ä»·æ ¼æŒ‡æ•°ï¼ˆCPIï¼‰ï¼›
`\(X_{3i}\)`è¡¨ç¤ºå›½æ°‘ç”Ÿäº§æ€»å€¼ï¼ˆGNPï¼Œä»¥ç™¾ä¸‡ç¾å…ƒè®¡); 
`\(X_{4i}\)`è¡¨ç¤ºå¤±ä¸šäººæ•°(ä»¥åƒäººè®¡) ;
`\(X_{5i}\)`è¡¨ç¤ºå†›é˜Ÿä¸­çš„äººæ•°; 
`\(X_{6i}\)`è¡¨ç¤º14 å²ä»¥ä¸Šçš„éæœºæ„äººå£æ•°; 
`\(X_{7i}\)`è¡¨ç¤ºæ—¶é—´ï¼ˆ
`\(t=1,2,\cdots,n\)`ï¼‰

---
## ç›¸å…³æ€§åˆ†æè¯Šæ–­æ³•ï¼ˆæ¡ˆä¾‹ï¼‰

éƒåˆ©æ¡ˆä¾‹ä¸­ï¼Œæ•£ç‚¹çŸ©é˜µå›¾å¦‚ä¸‹ï¼š

&lt;img src="07-multi-linearity-slide_files/figure-html/unnamed-chunk-20-1.png" style="display: block; margin: auto;" /&gt;


---
## ä¸»å›å½’æ–¹ç¨‹è¯Šæ–­æ³•

å¦‚æœä¸»å›å½’æ–¹ç¨‹åˆ†ææŠ¥å‘Šç»“æœå¼‚å¸¸ï¼Œåˆ™å¯èƒ½è®¤ä¸ºå­˜åœ¨å¤šé‡å…±çº¿æ€§é—®é¢˜ã€‚

**è¯Šæ–­ä¾æ®**ï¼š

- ä¸»å›å½’åˆ†ææŠ¥å‘Šçš„
`\(R^2\)`å€¼é«˜ï¼ˆå¤§äº0.8ï¼‰

- åˆ†ææŠ¥å‘Š
`\(F^{\ast}\)`æ£€éªŒæ˜¾è‘—

- ä¸æ˜¾è‘—çš„
`\(t^\ast\)`æ£€éªŒè¾ƒå¤šï¼ˆå¤šäºå›å½’ç³»æ•°ä¸ªæ•°çš„ä¸€åŠåŠä»¥ä¸Šï¼‰



---
## ä¸»å›å½’æ–¹ç¨‹è¯Šæ–­æ³•ï¼ˆæ¡ˆä¾‹ç®€è¦æŠ¥å‘Šï¼‰

éƒåˆ©æ¡ˆä¾‹ä¸­ï¼Œæˆ‘ä»¬æ„å»ºå¦‚ä¸‹ä¸»å›å½’æ¨¡å‹ï¼š

`$$\begin{equation} \begin{alignedat}{999} &amp;Y=&amp;&amp; + \beta_{1} &amp;&amp; + \beta_{2} X2&amp;&amp; + \beta_{3} X3&amp;&amp; + \beta_{4} X4\\ &amp;\text{(cont.)}&amp;&amp; + \beta_{5} X5&amp;&amp; + \beta_{6} X6&amp;&amp; + \beta_{7} X7&amp;&amp;+e_i\\ \end{alignedat} \end{equation}$$`

ä¸»å›å½’æ¨¡å‹çš„å›å½’åˆ†æç»“æœå¦‚ä¸‹ï¼š

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{Y}=&amp;&amp;+77270.12&amp;&amp;+1.51X2&amp;&amp;-0.04X3&amp;&amp;-2.02X4\\ &amp;\text{(t)}&amp;&amp;(3.4332)&amp;&amp;(0.1774)&amp;&amp;(-1.0695)&amp;&amp;(-4.1364)\\&amp;\text{(se)}&amp;&amp;(22506.7070)&amp;&amp;(8.4915)&amp;&amp;(0.0335)&amp;&amp;(0.4884)\\&amp;\text{(cont.)}&amp;&amp;-1.03X5&amp;&amp;-0.05X6&amp;&amp;+1829.15X7\\&amp;\text{(t)}&amp;&amp;(-4.8220)&amp;&amp;(-0.2261)&amp;&amp;(4.0159)\\&amp;\text{(se)}&amp;&amp;(0.2143)&amp;&amp;(0.2261)&amp;&amp;(455.4785)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9955;&amp;&amp; \bar{R^2}=0.9925\\&amp; &amp;&amp; F^{\ast}=330.29;&amp;&amp; p=0.0000\\ \end{alignedat} \end{equation}$$`

---
## ä¸»å›å½’æ–¹ç¨‹è¯Šæ–­æ³•ï¼ˆæ¡ˆä¾‹RæŠ¥å‘Šï¼‰

&lt;!---`R`è½¯ä»¶ä¸‹çš„è¯¦ç»†å›å½’åˆ†æç»“æœè§å·¦è¾¹ï¼š---&gt;


```

Call:
lm(formula = mods$main, data = data_longley)

Residuals:
   Min     1Q Median     3Q    Max 
-410.1 -157.7  -28.2  101.6  455.4 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 77270.1155 22506.7070    3.43  0.00747 ** 
X2              1.5062     8.4915    0.18  0.86314    
X3             -0.0358     0.0335   -1.07  0.31268    
X4             -2.0202     0.4884   -4.14  0.00254 ** 
X5             -1.0332     0.2143   -4.82  0.00094 ***
X6             -0.0511     0.2261   -0.23  0.82621    
X7           1829.1515   455.4785    4.02  0.00304 ** 
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 305 on 9 degrees of freedom
Multiple R-squared:  0.995,	Adjusted R-squared:  0.992 
F-statistic:  330 on 6 and 9 DF,  p-value: 4.98e-10
```


---
## è¾…åŠ©å›å½’æ–¹ç¨‹è¯Šæ–­æ³•ï¼ˆåˆ¤å®šç³»æ•°ï¼‰

**è¾…åŠ©å›å½’æ–¹ç¨‹**ï¼šä¸ºä¾¦å¯Ÿå¤šå…ƒå›å½’æ¨¡å‹æ˜¯å¦å­˜åœ¨å¤šé‡å…±çº¿æ€§ï¼Œæ„å»ºå…³äºè‡ªå˜é‡ä¹‹é—´çš„ä¸€ç±»çº¿æ€§å›å½’æ–¹ç¨‹ã€‚

æ­£å¼åœ°ï¼Œå¯¹äºæ ·æœ¬å›å½’æ¨¡å‹ï¼Œæˆ‘ä»¬å¯ä»¥æ„å»ºå¾—åˆ°å¦‚ä¸‹è¾…åŠ©å›å½’æ–¹ç¨‹ï¼š

`$$\begin{align}
X_{2i}&amp;=\hat{\alpha}_1+\cdots+\hat{\alpha}_jX_{ji}+\cdots+\hat{\alpha}_kX_{ki}+\epsilon_{2i} \\
      &amp;\vdots\\   
X_{ji}&amp;=\hat{\alpha}_1+\hat{\alpha}_2X_{2i}+\cdots+\hat{\alpha}_kX_{ki}+\epsilon_{ji} \\
      &amp;\vdots\\                                                                                      X_{ki}&amp;=\hat{\alpha}_1+\hat{\alpha}_2X_{2i}+\cdots+\hat{\alpha}_jX_{ji}+\cdots+\epsilon_{ki} \\
\end{align}$$`


å¯¹äºæ ·æœ¬å›å½’æ¨¡å‹ï¼Œåœ¨æ™®é€šæœ€å°äºŒä¹˜æ³•ä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥è¯æ˜ï¼š

`$$\begin{align}
S^2_{\hat{\beta}_j}=\frac{\hat{\sigma}^2}{(n-1)S^2_{X_j}} \cdot \frac{1}{1-R^2_j} 
\end{align}$$`

å…¶ä¸­
`\(R^2_j\)`ä¸ºè¾…åŠ©å›å½’æ–¹ç¨‹çš„åˆ¤å®šç³»æ•°ã€‚
`\(S^2_{X_j}\)`ä¸ºå˜é‡
`\(X_j\)`çš„æ ·æœ¬æ–¹å·®ã€‚

---
## è¾…åŠ©å›å½’æ–¹ç¨‹è¯Šæ–­æ³•ï¼ˆåˆ¤å®šç³»æ•°ï¼‰

**å…‹è±å› ç»éªŒæ³•åˆ™**(Kleinâ€˜s rule of  thumb)ï¼š å½“æ¥è‡ªä¸€ä¸ªè¾…åŠ©å›å½’çš„
`\(R^2_j\)`ğŸå¤§äºå¾—è‡ªä¸»å›å½’ä¸­çš„
`\(R^2\)`å€¼æ—¶ï¼Œå¤šé‡å…±çº¿æ€§æ‰ç®—æ˜¯ä¸€ä¸ªéº»çƒ¦çš„é—®é¢˜ã€‚


---
## è¾…åŠ©å›å½’æ–¹ç¨‹è¯Šæ–­æ³•ï¼ˆè¾…åŠ©æ–¹ç¨‹X2ï¼‰

éƒåˆ©æ¡ˆä¾‹ä¸­ï¼Œè¾…åŠ©å›å½’æ–¹ç¨‹ï¼ˆ
`\(X_2\)`ï¼‰çš„ç®€è¦ç»“æœå¦‚ä¸‹ï¼š

`$$\begin{equation} \begin{alignedat}{999} &amp;X2=&amp;&amp; + \beta_{1} &amp;&amp; + \beta_{2} X3&amp;&amp; + \beta_{3} X4&amp;&amp; + \beta_{4} X5&amp;&amp; + \beta_{5} X6&amp;&amp; + \beta_{6} X7&amp;&amp;+e_i\\ \end{alignedat} \end{equation}$$`

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{X2}=&amp;&amp;+2044.58&amp;&amp;+0.00X3&amp;&amp;+0.03X4&amp;&amp;+0.01X5&amp;&amp;-0.02X6&amp;&amp;-9.99X7\\ &amp;\text{(t)}&amp;&amp;(3.8333)&amp;&amp;(2.7006)&amp;&amp;(2.1098)&amp;&amp;(1.1770)&amp;&amp;(-2.7720)&amp;&amp;(-0.5996)\\&amp;\text{(se)}&amp;&amp;(533.3698)&amp;&amp;(0.0009)&amp;&amp;(0.0151)&amp;&amp;(0.0075)&amp;&amp;(0.0063)&amp;&amp;(16.6654)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9926;&amp;&amp; \bar{R^2}=0.9889\\&amp; &amp;&amp; F^{\ast}=269.06;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

---
## è¾…åŠ©å›å½’æ–¹ç¨‹è¯Šæ–­æ³•ï¼ˆè¾…åŠ©æ–¹ç¨‹X3ï¼‰

éƒåˆ©æ¡ˆä¾‹ä¸­ï¼Œè¾…åŠ©å›å½’æ–¹ç¨‹ï¼ˆ
`\(X_3\)`ï¼‰çš„ç®€è¦ç»“æœå¦‚ä¸‹ï¼š

`$$\begin{equation} \begin{alignedat}{999} &amp;X3=&amp;&amp; + \beta_{1} &amp;&amp; + \beta_{2} X2&amp;&amp; + \beta_{3} X4&amp;&amp; + \beta_{4} X5&amp;&amp; + \beta_{5} X6&amp;&amp; + \beta_{6} X7&amp;&amp;+e_i\\ \end{alignedat} \end{equation}$$`

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{X3}=&amp;&amp;-480986.04&amp;&amp;+164.66X2&amp;&amp;-13.79X4&amp;&amp;-3.00X5&amp;&amp;+5.62X6&amp;&amp;+10902.88X7\\ &amp;\text{(t)}&amp;&amp;(-3.2408)&amp;&amp;(2.7006)&amp;&amp;(-9.1921)&amp;&amp;(-1.6774)&amp;&amp;(4.7649)&amp;&amp;(4.2411)\\&amp;\text{(se)}&amp;&amp;(148413.7872)&amp;&amp;(60.9699)&amp;&amp;(1.5002)&amp;&amp;(1.7873)&amp;&amp;(1.1804)&amp;&amp;(2570.7562)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9994;&amp;&amp; \bar{R^2}=0.9992\\&amp; &amp;&amp; F^{\ast}=3575.03;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

---
## è¾…åŠ©å›å½’æ–¹ç¨‹è¯Šæ–­æ³•ï¼ˆè¾…åŠ©æ–¹ç¨‹X4ï¼‰

éƒåˆ©æ¡ˆä¾‹ä¸­ï¼Œè¾…åŠ©å›å½’æ–¹ç¨‹ï¼ˆ
`\(X_4\)`ï¼‰çš„ç®€è¦ç»“æœå¦‚ä¸‹ï¼š

`$$\begin{equation} \begin{alignedat}{999} &amp;X4=&amp;&amp; + \beta_{1} &amp;&amp; + \beta_{2} X2&amp;&amp; + \beta_{3} X3&amp;&amp; + \beta_{4} X5&amp;&amp; + \beta_{5} X6&amp;&amp; + \beta_{6} X7&amp;&amp;+e_i\\ \end{alignedat} \end{equation}$$`

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{X4}=&amp;&amp;-28518.24&amp;&amp;+9.65X2&amp;&amp;-0.06X3&amp;&amp;-0.27X5&amp;&amp;+0.35X6&amp;&amp;+768.55X7\\ &amp;\text{(t)}&amp;&amp;(-2.4914)&amp;&amp;(2.1098)&amp;&amp;(-9.1921)&amp;&amp;(-2.4895)&amp;&amp;(3.6779)&amp;&amp;(4.6007)\\&amp;\text{(se)}&amp;&amp;(11446.8866)&amp;&amp;(4.5736)&amp;&amp;(0.0071)&amp;&amp;(0.1090)&amp;&amp;(0.0954)&amp;&amp;(167.0507)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9703;&amp;&amp; \bar{R^2}=0.9554\\&amp; &amp;&amp; F^{\ast}=65.24;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

---
## è¾…åŠ©å›å½’æ–¹ç¨‹è¯Šæ–­æ³•ï¼ˆè¾…åŠ©æ–¹ç¨‹X5ï¼‰

éƒåˆ©æ¡ˆä¾‹ä¸­ï¼Œè¾…åŠ©å›å½’æ–¹ç¨‹ï¼ˆ
`\(X_5\)`ï¼‰çš„ç®€è¦ç»“æœå¦‚ä¸‹ï¼š

`$$\begin{equation} \begin{alignedat}{999} &amp;X5=&amp;&amp; + \beta_{1} &amp;&amp; + \beta_{2} X2&amp;&amp; + \beta_{3} X3&amp;&amp; + \beta_{4} X4&amp;&amp; + \beta_{5} X6&amp;&amp; + \beta_{6} X7&amp;&amp;+e_i\\ \end{alignedat} \end{equation}$$`

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{X5}=&amp;&amp;-11881.24&amp;&amp;+13.82X2&amp;&amp;-0.07X3&amp;&amp;-1.41X4&amp;&amp;+0.20X6&amp;&amp;+1167.78X7\\ &amp;\text{(t)}&amp;&amp;(-0.3600)&amp;&amp;(1.1770)&amp;&amp;(-1.6774)&amp;&amp;(-2.4895)&amp;&amp;(0.6084)&amp;&amp;(2.0791)\\&amp;\text{(se)}&amp;&amp;(33002.4231)&amp;&amp;(11.7447)&amp;&amp;(0.0437)&amp;&amp;(0.5663)&amp;&amp;(0.3276)&amp;&amp;(561.6770)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.7214;&amp;&amp; \bar{R^2}=0.5820\\&amp; &amp;&amp; F^{\ast}=5.18;&amp;&amp; p=0.0133 \end{alignedat} \end{equation}$$`

---
## è¾…åŠ©å›å½’æ–¹ç¨‹è¯Šæ–­æ³•ï¼ˆè¾…åŠ©æ–¹ç¨‹X6ï¼‰

éƒåˆ©æ¡ˆä¾‹ä¸­ï¼Œè¾…åŠ©å›å½’æ–¹ç¨‹ï¼ˆ
`\(X_6\)`ï¼‰çš„ç®€è¦ç»“æœå¦‚ä¸‹ï¼š

`$$\begin{equation} \begin{alignedat}{999} &amp;X6=&amp;&amp; + \beta_{1} &amp;&amp; + \beta_{2} X2&amp;&amp; + \beta_{3} X3&amp;&amp; + \beta_{4} X4&amp;&amp; + \beta_{5} X5&amp;&amp; + \beta_{6} X7&amp;&amp;+e_i\\ \end{alignedat} \end{equation}$$`

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{X6}=&amp;&amp;+95694.37&amp;&amp;-24.76X2&amp;&amp;+0.12X3&amp;&amp;+1.64X4&amp;&amp;+0.18X5&amp;&amp;-782.04X7\\ &amp;\text{(t)}&amp;&amp;(11.0221)&amp;&amp;(-2.7720)&amp;&amp;(4.7649)&amp;&amp;(3.6779)&amp;&amp;(0.6084)&amp;&amp;(-1.3319)\\&amp;\text{(se)}&amp;&amp;(8682.0335)&amp;&amp;(8.9319)&amp;&amp;(0.0259)&amp;&amp;(0.4454)&amp;&amp;(0.2943)&amp;&amp;(587.1614)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9975;&amp;&amp; \bar{R^2}=0.9962\\&amp; &amp;&amp; F^{\ast}=796.30;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

---
## è¾…åŠ©å›å½’æ–¹ç¨‹è¯Šæ–­æ³•ï¼ˆè¾…åŠ©æ–¹ç¨‹X7ï¼‰

éƒåˆ©æ¡ˆä¾‹ä¸­ï¼Œè¾…åŠ©å›å½’æ–¹ç¨‹ï¼ˆ
`\(X_7\)`ï¼‰çš„ç®€è¦ç»“æœå¦‚ä¸‹ï¼š

`$$\begin{equation} \begin{alignedat}{999} &amp;X7=&amp;&amp; + \beta_{1} &amp;&amp; + \beta_{2} X2&amp;&amp; + \beta_{3} X3&amp;&amp; + \beta_{4} X4&amp;&amp; + \beta_{5} X5&amp;&amp; + \beta_{6} X6&amp;&amp;+e_i\\ \end{alignedat} \end{equation}$$`

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{X7}=&amp;&amp;+8.31&amp;&amp;-0.00X2&amp;&amp;+0.00X3&amp;&amp;+0.00X4&amp;&amp;+0.00X5&amp;&amp;-0.00X6\\ &amp;\text{(t)}&amp;&amp;(0.5392)&amp;&amp;(-0.5996)&amp;&amp;(4.2411)&amp;&amp;(4.6007)&amp;&amp;(2.0791)&amp;&amp;(-1.3319)\\&amp;\text{(se)}&amp;&amp;(15.4036)&amp;&amp;(0.0058)&amp;&amp;(0.0000)&amp;&amp;(0.0002)&amp;&amp;(0.0001)&amp;&amp;(0.0001)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9987;&amp;&amp; \bar{R^2}=0.9980\\&amp; &amp;&amp; F^{\ast}=1515.96;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

---
## è¾…åŠ©å›å½’æ–¹ç¨‹è¯Šæ–­æ³•ï¼ˆåˆ¤å®šç³»æ•°æ¯”è¾ƒï¼‰



ä¸»å›å½’æ¨¡å‹çš„åˆ¤å®šç³»æ•°ä¸º0.9955ï¼Œè¾…åŠ©å›å½’çš„åˆ¤å®šç³»æ•°è§ä¸‹è¡¨ï¼š




&lt;div class="figure" style="text-align: center"&gt;
&lt;div id="htmlwidget-07caa828518750f64f52" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-07caa828518750f64f52">{"x":{"filter":"none","data":[["1","2","3","4","5","6"],["X2","X3","X4","X5","X6","X7"],[0.992621692543197,0.999440876454294,0.97025481857758,0.721365435910039,0.997494682603577,0.998682443262164],["...","ä¸¥é‡é—®é¢˜","...","...","ä¸¥é‡é—®é¢˜","ä¸¥é‡é—®é¢˜"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>models<\/th>\n      <th>R2<\/th>\n      <th>åˆ¤å®šç³»æ•°è¯Šæ–­ç»“è®º<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-center","targets":"_all"},{"orderable":false,"targets":0}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatRound(this, row, data, 2, 4, 3, ',', '.');\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><&lt;p class="caption"&gt;è¾…åŠ©å›å½’æ–¹ç¨‹çš„åˆ¤å®šç³»æ•°&lt;/p&gt;
&lt;/div&gt;


---
## è¾…åŠ©å›å½’æ–¹ç¨‹è¯Šæ–­æ³•ï¼ˆVIFï¼‰

è¾…åŠ©å›å½’æ–¹ç¨‹æ–¹å·®è†¨èƒ€å› å­çš„ç†è®ºè®¡ç®—å…¬å¼ä¸º
    
`$$\begin{equation}
VIF_j=\frac{1}{1-R^2_j},(j=1,2,\cdots,k-1) 
\end{equation}$$`

è¯Šæ–­ä¾æ®ï¼š

- è¾…åŠ©å›å½’æ–¹ç¨‹çš„æ–¹å·®è†¨èƒ€å› å­ä¸­å¦‚æœ
`\(VIF_j \in [10,100]\)`è¡¨æ˜ä¸­åº¦å¤šé‡å…±çº¿æ€§ï¼›

- å¦‚æœ
`\(VIF_j \geq 100\)`è¡¨æ˜ä¸¥é‡å¤šé‡å…±çº¿æ€§

---
## è¾…åŠ©å›å½’æ–¹ç¨‹è¯Šæ–­æ³•ï¼ˆVIFï¼‰

éƒåˆ©æ¡ˆä¾‹ä¸­ï¼Œè¾…åŠ©å›å½’æ–¹ç¨‹çš„VIFè¯Šæ–­ç»“æœä¸ºï¼š






&lt;div class="figure" style="text-align: center"&gt;
&lt;div id="htmlwidget-ee8260f76f6980e9d52d" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ee8260f76f6980e9d52d">{"x":{"filter":"none","data":[["X2","X3","X4","X5","X6","X7"],[0.992621692543197,0.999440876454294,0.97025481857758,0.721365435910039,0.997494682603577,0.998682443262164],[135.532438279973,1788.51348271776,33.618890596048,3.58893019344555,399.151022312547,758.980597406721],["éå¸¸ä¸¥é‡","éå¸¸ä¸¥é‡","æ¯”è¾ƒä¸¥é‡","...","éå¸¸ä¸¥é‡","éå¸¸ä¸¥é‡"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>models<\/th>\n      <th>R2<\/th>\n      <th>VIF<\/th>\n      <th>VIFè¯Šæ–­ç»“è®º<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-center","targets":"_all"}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatRound(this, row, data, 1, 4, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 2, 4, 3, ',', '.');\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><&lt;p class="caption"&gt;æ–¹å·®è†¨èƒ€å› å­åˆ†æ&lt;/p&gt;
&lt;/div&gt;


æ ¹æ®è®¡ç®—ç»“æœæ±‡æ€»ï¼Œå¯ä»¥è®¤ä¸ºä¸»æ¨¡å‹å­˜åœ¨è¾ƒä¸¥é‡çš„å¤šé‡å…±çº¿æ€§é—®é¢˜ã€‚å…¶ä¸­VIFå€¼å¤§äº100çš„ç³»æ•°å°±åŒ…æ‹¬X2ã€X3ã€X6ã€X7ã€‚

---
## è¾…åŠ©å›å½’æ–¹ç¨‹è¯Šæ–­æ³•ï¼ˆVIFï¼‰

`EViews`è½¯ä»¶ç»™å‡ºçš„VIFç»“æœï¼š

&lt;img src="pic/chpt7-EViews-VIF.png" width="685" style="display: block; margin: auto;" /&gt;


---
## è¾…åŠ©å›å½’æ–¹ç¨‹è¯Šæ–­æ³•ï¼ˆTOLï¼‰

è¾…åŠ©å›å½’æ–¹ç¨‹å®¹å¿åº¦çš„ç†è®ºè®¡ç®—å…¬å¼ä¸ºï¼š
    
`$$\begin{equation}
TOL_j=1-R^2_j=\frac{1}{VIF_j},(j=1, 2, \cdots,k-1) 
\end{equation}$$`


è¯Šæ–­ä¾æ®ï¼š

- å¦‚æœè¾…åŠ©å›å½’æ–¹ç¨‹çš„å®¹å¿åº¦
`\(TOL_j\in[0.01,0.1]\)`è¡¨æ˜ä¸­åº¦å¤šé‡å…±çº¿æ€§ï¼›

- å¦‚æœè¾…åŠ©å›å½’æ–¹ç¨‹çš„å®¹å¿åº¦
`\(TOL_j\leq{0.01}\)`è¡¨æ˜å­˜åœ¨ä¸¥é‡çš„å¤šé‡å…±çº¿æ€§

---
## è¾…åŠ©å›å½’æ–¹ç¨‹è¯Šæ–­æ³•ï¼ˆTOLï¼‰

éƒåˆ©æ¡ˆä¾‹ä¸­ï¼Œè¾…åŠ©å›å½’æ–¹ç¨‹çš„TOLè¯Šæ–­ç»“æœä¸ºï¼š






&lt;div class="figure" style="text-align: center"&gt;
&lt;div id="htmlwidget-d728d29907d07f75def5" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d728d29907d07f75def5">{"x":{"filter":"none","data":[["X2","X3","X4","X5","X6","X7"],[0.992621692543197,0.999440876454294,0.97025481857758,0.721365435910039,0.997494682603577,0.998682443262164],[135.532438279973,1788.51348271776,33.618890596048,3.58893019344555,399.151022312547,758.980597406721],[0.00737830745680437,0.00055912354570592,0.0297451814224218,0.278634564089961,0.00250531739642388,0.00131755673783598],["éå¸¸ä¸¥é‡","éå¸¸ä¸¥é‡","...","æ¯”è¾ƒä¸¥é‡","éå¸¸ä¸¥é‡","éå¸¸ä¸¥é‡"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>models<\/th>\n      <th>R2<\/th>\n      <th>VIF<\/th>\n      <th>TOL<\/th>\n      <th>TOLç»“è®º<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-center","targets":"_all"}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatRound(this, row, data, 1, 4, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 2, 4, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 3, 4, 3, ',', '.');\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><&lt;p class="caption"&gt;å®¹å¿åº¦åˆ†æç»“æœ&lt;/p&gt;
&lt;/div&gt;


---
## å›å½’ç³»æ•°æ–¹å·®åˆ†è§£è¯Šæ–­æ³•(CVD)

å›å½’ç³»æ•°æ–¹å·®åˆ†è§£æ³•ï¼ˆCoefficient Variance Decompositionï¼‰ï¼šé€šè¿‡è®¡ç®—ç‰¹å¾å€¼(eigenvalues)ï¼Œè¿›è€Œå¾—åˆ°ç—…æ€æ•°(
`\(K_j\)`)å’Œæ–¹å·®åˆ†è§£æ¯”ç‡
`\(VDP_j\)`ï¼Œæœ€ååšå‡ºå¤šé‡å…±çº¿æ€§çš„è¯Šæ–­ç»“è®ºï¼š

å¯¹äºkå˜é‡å›å½’æ¨¡å‹ï¼š

`$$\begin{align}
\mathbf{y} &amp;= \mathbf{X}\mathbf{\hat{\beta}}+\mathbf{e}  &amp;&amp; \text{(SRM)} 
\end{align}$$`

å¯ä»¥å¾—åˆ°OLSä¸‹å‚æ•°ä¼°è®¡çš„æ–¹å·®åæ–¹å·®çŸ©é˜µï¼š

`$$\begin{align}
var-cov(\boldsymbol{\hat{\beta}})
= \sigma^2 \boldsymbol{(X'X)^{-1}} 
= \sigma^2 \boldsymbol{VD^{-1}V'} 
\end{align}$$`

å…¶ä¸­ï¼Œ
`\(\mathbf{D}\)`æ˜¯å«æœ‰çŸ©é˜µ
`\(\mathbf{(X'X)^{-1}}\)`çš„**ç‰¹å¾å€¼**ï¼ˆeigenvaluesï¼‰
`\(E_m\)`ï¼ˆ
`\(m \in 1,2,\cdots,k\)`ï¼‰çš„ä¸€ä¸ªå¯¹è§’çŸ©é˜µï¼Œè€Œ
`\(\mathbf{V}\)`æ˜¯ç”±ç›¸åº”**ç‰¹å¾å‘é‡**æ„æˆçš„ä¸€ä¸ªçŸ©é˜µã€‚

---
## å›å½’ç³»æ•°æ–¹å·®åˆ†è§£è¯Šæ–­æ³•(CVD)

**ç—…æ€æ•°**ï¼ˆcondition numberï¼‰é‡‡ç”¨å¾®åˆ†çš„æ–¹æ³•ï¼Œè€ƒå¯Ÿå¼•å…¥ä¸€ä¸ªå˜é‡å¯¹ï¼ˆå¤šé‡å…±çº¿æ€§ï¼‰æ¨¡å‹ç»“æœæ¶åŒ–æƒ…å½¢å‡ºç°çš„ç›¸å¯¹æ”¹å˜æ•°ï¼Œä¸€èˆ¬è®°ä¸ºKï¼Œå¹¶æ­£å¼å®šä¹‰ä¸ºï¼š

`$$\begin{align}
K_j&amp;= \frac{min(E_m)}{E_j}
\end{align}$$`
  
**æ–¹å·®åˆ†è§£æ¯”ç‡**ï¼ˆvariance-decomposition proportionï¼‰ï¼Œä¸€èˆ¬è®°ä¸º
`\(VDP_{ji}\)`ï¼Œå¹¶æ­£å¼å®šä¹‰ä¸ºï¼š

`$$\begin{align}
\phi_{ij}=\frac{v^2_{ij}}{E_j}; \quad
VDP_{ji}= \frac{\phi_{ij}}{\phi_i}  
\end{align}$$`

å…¶ä¸­
`\(v_{ij}\)`ä¸ºçŸ©é˜µ
`\(\mathbf{V}\)`çš„ç¬¬
`\((i,j)\)`ä¸ªå…ƒç´ ã€‚

---
## å›å½’ç³»æ•°æ–¹å·®åˆ†è§£è¯Šæ–­æ³•(CVD)

ç—…æ€æ•°å’Œæ–¹å·®åˆ†è§£æ¯”ç‡ï¼šç”¨æ¥è¯Šæ–­å¤šå…ƒçº¿æ€§å›å½’æ¨¡å‹çš„å¤šé‡å…±çº¿æ€§é—®é¢˜ä¸¥é‡ç¨‹åº¦çš„æŒ‡æ ‡ã€‚è¯Šæ–­ä¾æ®ä¸ºï¼š

- è‹¥å‘ç°è‡³å°‘ä¸€ä¸ªç—…æ€æ•°
`\(K_j \leq 0.001\)`ï¼Œåˆ™è¡¨æ˜å­˜åœ¨ä¸¥é‡å¤šé‡å…±çº¿æ€§ï¼›

- è§‚å¯Ÿç—…æ€æ•°æœ€å°æ—¶æ‰€å¯¹åº”çš„æ–¹å·®åˆ†è§£æ¯”ç‡ï¼Œå¦‚æœæœ‰å¤šä¸ªæ–œç‡ç³»æ•°çš„ 
`\(VDP_j \geq 0.5\)`ï¼Œåˆ™è¡¨æ˜å­˜åœ¨ä¸¥é‡çš„å¤šé‡å…±çº¿æ€§

- ç³»æ•°æ–¹å·®åˆ†è§£è¯Šæ–­æ–¹æ³•ç”±Belsley, Kuh and Welsch (BKW) 2004æå‡ºï¼Œå…·ä½“ç»†èŠ‚å¯ä»¥å‚è€ƒ[Eviewså¸®åŠ©æ–‡æ¡£](http://www.eviews.com/help/helpintro.html#page/content/testing-Coefficient_Diagnostics.html)ï¼Œç½‘å€ä¸ºï¼šhttp://www.eviews.com/help/helpintro.html#page/content/testing-Coefficient_Diagnostics.html]ã€‚

- Eviewsè½¯ä»¶ä¸­ç—…æ€æ•°çš„è®¡ç®—æ˜¯åŸºäºçŸ©é˜µ
`\(\mathbf{(X'X)}^{-1}\)`ï¼Œè€Œä¸æ˜¯åŸºäºçŸ©é˜µ
`\(\mathbf{X}\)`

---
## å›å½’ç³»æ•°æ–¹å·®åˆ†è§£è¯Šæ–­æ³•(CVD)

éƒåˆ©æ¡ˆä¾‹ä¸­ï¼Œä¸»å›å½’æ¨¡å‹ç³»æ•°æ–¹å·®åˆ†è§£çš„å¤šé‡å…±çº¿æ€§EViewsè¯Šæ–­ç»“æœä¸ºï¼š

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="pic/chpt7-vcd-full-result.png" alt="ä¸»å›å½’æ¨¡å‹ç³»æ•°æ–¹å·®åˆ†è§£çš„EviewsæŠ¥å‘Š" width="589" /&gt;
&lt;p class="caption"&gt;ä¸»å›å½’æ¨¡å‹ç³»æ•°æ–¹å·®åˆ†è§£çš„EviewsæŠ¥å‘Š&lt;/p&gt;
&lt;/div&gt;

---
class: center, middle,inverse
# å¦‚ä½•ä¿®æ­£æ¨¡å‹å¤šé‡å…±çº¿æ€§é—®é¢˜ï¼Ÿ


---
## åˆ é™¤å˜é‡æ³•

ä¸€æ—¦å‘ç°æ¨¡å‹å­˜åœ¨æ¯”è¾ƒä¸¥é‡çš„å¤šé‡å…±çº¿æ€§é—®é¢˜ï¼Œåˆ™éœ€è¦å¯¹æ¨¡å‹è¿›è¡Œä¿®æ­£å¤„ç†ï¼Œå…·ä½“æ–¹æ³•å¯å‚è€ƒï¼š

ç®€å•å‰”é™¤å˜é‡æ³•ï¼š

- ä¾æ®ç»æµå­¦å’Œå®è·µç»éªŒè§‚å¯Ÿï¼Œè¿›è¡Œå˜é‡ç”„é€‰æˆ–å˜é‡å˜æ¢ã€‚åˆ©ç”¨å…ˆéªŒä¿¡æ¯ï¼ˆæˆä¸ºç ”ç©¶é¢†åŸŸçš„ä¸“å®¶ï¼ï¼‰é…Œæƒ…åˆ é™¤ç‰¹å®šå˜é‡ï¼Œå‡å¼±æ¨¡å‹çš„å¤šé‡å…±çº¿æ€§é—®é¢˜ã€‚é‚£æ€æ ·æ‰èƒ½è·å¾—å…ˆéªŒä¿¡æ¯å‘¢ï¼Ÿå®ƒå¾€å¾€æºè‡ªç»éªŒç ”ç©¶å·¥ä½œæˆ–è€…æœ‰å…³åŸºç¡€ç†è®ºã€‚ 

&gt; æ€æ ·è·å¾—å…ˆéªŒä¿¡æ¯å‘¢?å®ƒå¯ä»¥ç»éªŒç ”ç©¶å·¥ä½œæˆ–è€…æœ‰å…³åŸºç¡€ç†è®ºã€‚ä¾‹å¦‚ï¼Œåœ¨æŸ¯å¸ƒ-é“æ ¼æ‹‰æ–¯ç”Ÿäº§å‡½æ•°ä¸­ï¼Œå¦‚æœäººä»¬é¢„æœŸè§„æ¨¡æŠ¥é…¬ä¸å˜æˆç«‹ï¼Œåˆ™æœ‰
`\(\beta_2+\beta_3=1\)`ã€‚å¦‚æœåŠ³åŠ¨å’Œèµ„æœ¬ä¹‹é—´å­˜åœ¨å…±çº¿æ€§ï¼Œè¿™ä¸€å˜æ¢å°±å‡è½»æˆ–æ¶ˆé™¤äº†å…±çº¿æ€§é—®é¢˜ã€‚

- å˜é‡å˜æ¢æ³•ï¼Œè¿›è¡Œå˜é‡å¤„ç†ã€‚å…·ä½“åˆåŒ…æ‹¬å·®åˆ†å˜æ¢æ³•ã€æ¯”ç‡å˜æ¢æ³•

---
## åˆ é™¤å˜é‡æ³•ï¼ˆæ¡ˆä¾‹ï¼‰

éƒåˆ©æ¡ˆä¾‹ä¸­ï¼Œæ¨¡å‹å„å˜é‡çš„å«ä¹‰ï¼š

- `\(Y_i\)`è¡¨ç¤ºå°±ä¸šäººæ•°ï¼›

- `\(X_{2i}\)`è¡¨ç¤ºæ¶ˆè´¹ä»·æ ¼æŒ‡æ•°ï¼ˆCPIï¼‰ï¼›
`\(X_{3i}\)`è¡¨ç¤ºå›½æ°‘ç”Ÿäº§æ€»å€¼ï¼ˆGNPï¼Œä»¥ç™¾ä¸‡ç¾å…ƒè®¡)ï¼›
`\(X_{4i}\)`è¡¨ç¤ºå¤±ä¸šäººæ•°(ä»¥åƒäººè®¡) ï¼›
`\(X_{5i}\)`è¡¨ç¤ºå†›é˜Ÿä¸­çš„äººæ•°ï¼›
`\(X_{6i}\)`è¡¨ç¤º14å²ä»¥ä¸Šçš„éæœºæ„äººå£æ•°ï¼›
`\(X_{7i}\)`è¡¨ç¤ºæ—¶é—´ï¼ˆ
`\(t=1,2,\cdots,n\)`ï¼‰ã€‚

ç®€å•åˆ é™¤çš„ä¾æ®ï¼š

- ä¸ç”¨åä¹‰GNPï¼Œæ”¹ç”¨çœŸå®GNPã€‚å°†åä¹‰GNPï¼ˆX3ï¼‰ é™¤ä»¥ä»·æ ¼æŒ‡æ•°CPIï¼ˆX2ï¼‰ï¼Œå¾—åˆ°**å®é™…GNP**ï¼ˆX3/X2ï¼‰ã€‚

- ç•™ä¸‹X5ï¼ˆå†›é˜Ÿä¸­çš„äººæ•°ï¼‰ï¼Œå»æ‰X6ï¼ˆ14 å²ä»¥ä¸Šéæœºæ„äººå£æ•°ï¼‰ã€‚å› ä¸ºX6ï¼ˆ14 å²ä»¥ä¸Šéæœºæ„äººå£æ•°ï¼‰éšæ—¶é—´ï¼ˆX7ï¼‰ä¸æ–­å¢é•¿ï¼Œå®ƒä¸æ—¶é—´å˜é‡X7é«˜åº¦ç›¸ã€‚

- å»æ‰å˜é‡X4ï¼ˆå¤±ä¸šäººæ•°ï¼‰ã€‚å¯èƒ½å¤±ä¸šç‡æ˜¯åŠ³åŠ¨åŠ›å¸‚åœºçŠ¶å†µçš„ä¸€ä¸ªæ›´å¥½çš„åº¦é‡æŒ‡æ ‡ï¼Œä½†æˆ‘ä»¬æ²¡æœ‰è¿™æ–¹é¢çš„æ•°æ®ï¼Œè€Œå¤±ä¸šäººæ•°X4ä¹Ÿæ²¡æœ‰å……åˆ†çš„ç†ç”±åŒ…æ‹¬è¿›æ¥ã€‚

---
## åˆ é™¤å˜é‡æ³•ï¼ˆæ¡ˆä¾‹RæŠ¥å‘Šï¼‰

è¿ç”¨åˆ é™¤å˜é‡æ³•ï¼Œè°ƒæ•´åçš„å›å½’æ¨¡å‹ä¸ºï¼š

`$$\begin{equation} \begin{alignedat}{999} &amp;Y=&amp;&amp; + \beta_{1} &amp;&amp; + \beta_{2} I(X3/X2)&amp;&amp; + \beta_{3} X5&amp;&amp; + \beta_{4} X6&amp;&amp;+e_i\\ \end{alignedat} \end{equation}$$`

å›å½’ç»“æœä¸ºï¼š

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{Y}=&amp;&amp;+65720.37&amp;&amp;+97.36I(X3/X2)&amp;&amp;-0.69X5&amp;&amp;-0.30X6\\ &amp;\text{(t)}&amp;&amp;(6.1856)&amp;&amp;(5.4347)&amp;&amp;(-2.1350)&amp;&amp;(-2.1130)\\&amp;\text{(se)}&amp;&amp;(10624.8077)&amp;&amp;(17.9155)&amp;&amp;(0.3222)&amp;&amp;(0.1418)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9814;&amp;&amp; \bar{R^2}=0.9768\\&amp; &amp;&amp; F^{\ast}=211.10;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

---
## å˜é‡å˜æ¢æ³•ï¼ˆä¸€é˜¶å·®åˆ†æ³•ï¼‰

é¢å¯¹ä¸¥é‡çš„å…±çº¿æ€§ï¼Œæœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯å»æ‰æŸäº›å˜é‡ï¼Œä½†å‰”é™¤å˜é‡ä¼šå¯¼è‡´è®¾å®šè¯¯å·®ã€‚å®é™…ä¸­éœ€è¦æƒè¡¡åˆ©å¼Šã€‚

**ä¸€é˜¶å·®åˆ†æ³•**(first difference form)å·§å¦™åˆ é™¤å˜é‡ï¼šæ¨¡å‹ä¸­ä¸¤ä¸ªè§£é‡Šå˜é‡
`\(X_{k,i}\)`å’Œ
`\(X_{w,i}\)`å¯èƒ½å¯¼è‡´é«˜åº¦å¤šé‡å…±çº¿æ€§ï¼Œä½†æ˜¯åˆ†åˆ«å¯¹äºŒè€…è¿›è¡Œä¸€é˜¶å·®åˆ†ï¼Œå†è¿›è¡Œå›å½’å»ºæ¨¡ï¼Œæ–°æ¨¡å‹å¯èƒ½çš„å¤šé‡å…±çº¿æ€§é—®é¢˜å¾ˆå¯èƒ½å¤§å¤§ç¼“è§£ï¼å…·ä½“å˜æ¢å¦‚ä¸‹:

`$$\begin{align}
Y_t &amp; =\beta_1+\beta_2X_{2,t}+\beta_3X_{3,t}+u_t &amp;&amp; \text{åŸæ¨¡å‹} \\
Y_{t-1} &amp; =\beta_1+\beta_2X_{2,t-1}+\beta_3X_{3,t-1}+u_{t-1} &amp;&amp; \text{æ»å1é˜¶å˜é‡æ¨¡å‹} \\
Y_t-Y_{t-1} &amp; =\beta_2(X_{2,t}-X_{2,t-1})+\beta_3(X_{3,t}-X_{3,t-1})+(u_t-u_{t-1}) &amp;&amp; \text{ä¸€é˜¶å·®åˆ†æ¨¡å‹}  \\
Y^{\ast}_t &amp;=\beta_2X^{\ast}_{2,t}+\beta_3X^{\ast}_{3,t}+v_t &amp;&amp; \text{ç²¾ç®€åŒ–æ¨¡å‹} 
\end{align}$$`

&gt;éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œâ€œæŒ‰ä¸‹è‘«èŠ¦æµ®èµ·ç“¢â€ï¼Œæ²»ç–—æ¯”ç–¾ç—…æ›´ç³Ÿç³•ï¼Ÿ

&gt;å·®åˆ†å˜æ¢
`\(Y_{t-1}\)`å‡å°‘äº†è‡ªç”±åº¦ï¼›åŒæ—¶
`\(v_t=(u_t-u_{t-1})\)`å¯èƒ½å¸¦æ¥å¼‚æ–¹å·®é—®é¢˜ã€‚

---
## å˜é‡å˜æ¢æ³•ï¼ˆæ¯”ç‡å˜æ¢æ³•ï¼‰


**æ¯”ç‡å˜æ¢æ³•**(ratio transformation)å·§å¦™åˆ é™¤å˜é‡ï¼šæ¨¡å‹ä¸­ä¸¤ä¸ªè§£é‡Šå˜é‡
`\(X_{k,i}\)`å’Œ
`\(X_{w,i}\)`å¯èƒ½å¯¼è‡´é«˜åº¦å¤šé‡å…±çº¿æ€§ï¼Œå¦‚æœå¯ä»¥ç”¨å…¶ä¸­çš„ä¸€ä¸ªå˜é‡åŒæ—¶å¯¹æ¨¡å‹å…¶ä»–å˜é‡è¿›è¡Œæ¯”ç‡å˜æ¢ï¼Œè€Œä¸”å¦‚æœå˜æ¢åçš„æ‰€æœ‰å˜é‡è¿˜èƒ½å…·æœ‰ç»æµå­¦å«ä¹‰ï¼Œé‚£ä¹ˆç†è®ºä¸Šå°†è‡³å°‘æ¶ˆæ‰ä¸€ä¸ªå›å½’å…ƒï¼Œä»è€Œå¤§å¤§ç¼“è§£ç”šè‡³æ¶ˆé™¤å¤šé‡å…±çº¿æ€§é—®é¢˜ï¼

ä»¥**æ¶ˆè´¹æ”¯å‡ºå†³å®š**ä¸ºä¾‹ï¼š

`\(Y_t\)` ä¸ºä»¥çœŸå®ä»·æ ¼è¡¨ç¤ºçš„æ¶ˆè´¹æ”¯å‡ºï¼Œ
`\(X_{2,t}\)`è¡¨ç¤ºGDPï¼Œ
`\(X_{3,t}\)`è¡¨ç¤ºæ€»äººå£ã€‚
    
`$$\begin{align}
Y_t &amp; =\beta_1+\beta_2X_{2,t}+\beta_3X_{3,t}+u_t &amp;&amp; \text{åŸæ¨¡å‹}  \\
\frac{Y_t}{X_{3,t}} &amp; =\frac{\beta_1}{X_{3,t}}+\beta_2\frac{X_{2,t}}{X_{3,t}}+\frac{u_t}{X_{3,t}} &amp;&amp; \text{æ¯”ç‡å˜æ¢æ¨¡å‹} \\
Y^{\ast}_t &amp;=\beta^{\ast}_1+\beta^{\ast}_2X^{\ast}_{2,t}+v_t &amp;&amp; \text{ç²¾ç®€åŒ–æ¨¡å‹} 
\end{align}$$`

&gt;åŒæ ·éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œâ€œæŒ‰ä¸‹è‘«èŠ¦æµ®èµ·ç“¢â€ï¼Œæ²»ç–—æ¯”ç–¾ç—…æ›´ç³Ÿç³•ï¼Ÿ

&gt; 
`\(v_t=\frac{u_t}{X_{3,t}}\)`å¯èƒ½å¸¦æ¥å¼‚æ–¹å·®é—®é¢˜ã€‚

---
## é€æ­¥å›å½’æ³•

**é€æ­¥æœ€å°äºŒä¹˜å›å½’æ³•**ï¼ˆStepwise Least Squares Regressionï¼‰é€šè¿‡å¤šä¸ªç»Ÿè®¡æ ‡å‡†ï¼Œå¯ä»¥è‡ªåŠ¨åˆ¤æ–­æ¨¡å‹è¯¥å¼•å…¥è¿˜æ˜¯åˆ é™¤æŸäº›è‡ªå˜é‡Xã€‚è¿™äº›ç»Ÿè®¡æ ‡å‡†ä¸»è¦åŒ…æ‹¬åˆ†æå¼•å…¥æ–°å˜é‡å¯¹å›å½’å¹³æ–¹å’ŒESSçš„è´¡çŒ®å¤§å°ï¼ŒåŠFæ£€éªŒç­‰ã€‚

- **å‰å‘é€æ­¥å›å½’æ³•**ï¼ˆStepwise-Forwardsï¼‰ï¼Œæ˜¯ä»ä¸€ä¸ªç®€åŒ–æ¨¡å‹ï¼ˆå¾ˆå°‘Xå˜é‡ï¼‰å¼€å§‹ï¼Œå†é€æ­¥å¼•å…¥æ–°çš„Xå˜é‡ï¼Œç›´è‡³è¾¾åˆ°æŸä¸ªç»Ÿè®¡æ ‡å‡†ï¼ˆä¸»è¦æ˜¯på€¼æ ‡å‡†ï¼‰

- **åå‘é€æ­¥å›å½’æ³•**ï¼ˆStepwise-Backwardsï¼‰ï¼Œæ˜¯ä»ä¸€ä¸ªå®Œå…¨æ¨¡å‹ï¼ˆå…¨éƒ¨Xå˜é‡ï¼‰å¼€å§‹ï¼Œå¯¹æ¨¡å‹é€æ­¥åˆ é™¤æŸäº›Xå˜é‡ï¼Œç›´è‡³å‰©ä½™å˜é‡éƒ½è¾¾åˆ°æŸä¸ªç»Ÿè®¡æ ‡å‡†ï¼ˆä¸»è¦æ˜¯på€¼æ ‡å‡†ï¼‰

é€æ­¥æœ€å°äºŒä¹˜å›å½’æ³•ä¸€èˆ¬é‡‡ç”¨å¦‚ä¸‹æ ‡å‡†æ¥è‡ªåŠ¨ç­›é€‰å˜é‡ï¼š

- på€¼åˆ¤åˆ«æ³•ï¼š
`\(p\in[0.1,0.05)\)`(æ¯”è¾ƒæ˜¾è‘—)ï¼›
`\(p\in[0.05,0.01)\)`(æ¯”è¾ƒæ˜¾è‘—)ï¼›
`\(p\leq 0.01\)`(æå…¶æ˜¾è‘—)

- `\(t^{\ast}\)`å€¼åˆ¤åˆ«æ³•ï¼š2tæ³•åˆ™

- **AIC**ä¿¡æ¯å‡†åˆ™ï¼šè¶Šå°è¶Šå¥½

`R`ç»Ÿè®¡è½¯ä»¶ä¸‹é‡‡ç”¨**åå‘é€æ­¥å›å½’æ³•**ï¼ˆStepwise-Backwardsï¼‰è‡ªåŠ¨åˆ é™¤å˜é‡ï¼Œæœ€ç»ˆå›å½’ç»“æœæŠ¥å‘Šè§ä¸‹é¡µ--&gt;

---
class:duke-softblue


```

Call:
lm(formula = Y ~ X3 + X4 + X5 + X7, data = data_longley)

Residuals:
   Min     1Q Median     3Q    Max 
-421.7 -124.6  -24.2   83.7  452.7 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept) 74169.5322  4251.5849   17.45  2.3e-09 ***
X3             -0.0402     0.0165   -2.44  0.03283 *  
X4             -2.0884     0.2900   -7.20  1.7e-05 ***
X5             -1.0146     0.1837   -5.52  0.00018 ***
X7           1887.4095   382.7665    4.93  0.00045 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 279 on 11 degrees of freedom
Multiple R-squared:  0.995,	Adjusted R-squared:  0.994 
F-statistic:  590 on 4 and 11 DF,  p-value: 9.5e-13
```

.footnote[ [*] åå‘é€æ­¥å›å½’çš„å…·ä½“ç»†èŠ‚ï¼Œè¯·å‚çœ‹**é™„å½•7-A**ç»™å‡ºçš„.red[è¯¦ç»†æŠ¥å‘Š]]


---
## é€æ­¥å›å½’æ³•ï¼ˆæ¡ˆä¾‹æŠ¥å‘Šï¼‰




ç»è¿‡**åå‘é€æ­¥å›å½’æ³•**çš„æ ‡å‡†ç­›é€‰å˜é‡ï¼Œå¾—åˆ°çš„æ–°æ¨¡å‹ä¸ºï¼š

`$$\begin{equation} \begin{alignedat}{999} &amp;Y=&amp;&amp; + \beta_{1} &amp;&amp; + \beta_{2} X3&amp;&amp; + \beta_{3} X4&amp;&amp; + \beta_{4} X5&amp;&amp; + \beta_{5} X7&amp;&amp;+e_i\\ \end{alignedat} \end{equation}$$`

é€æ­¥å›å½’æ³•çŸ«æ­£åå›å½’æ¨¡å‹çš„ç®€è¦å›å½’æŠ¥å‘Šå¦‚ä¸‹ï¼š

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{Y}=&amp;&amp;+74169.53&amp;&amp;-0.04X3&amp;&amp;-2.09X4&amp;&amp;-1.01X5&amp;&amp;+1887.41X7\\ &amp;\text{(t)}&amp;&amp;(17.4451)&amp;&amp;(-2.4398)&amp;&amp;(-7.2021)&amp;&amp;(-5.5223)&amp;&amp;(4.9310)\\&amp;\text{(se)}&amp;&amp;(4251.5849)&amp;&amp;(0.0165)&amp;&amp;(0.2900)&amp;&amp;(0.1837)&amp;&amp;(382.7665)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9954;&amp;&amp; \bar{R^2}=0.9937\\&amp; &amp;&amp; F^{\ast}=589.76;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

---
## è¡¥å……æ–°æ•°æ®æ³•ï¼ˆæœ‰æ—¶å€™æœ‰ç”¨ï¼ï¼‰

ç”±äºå¤šé‡å…±çº¿æ€§æ˜¯ä¸€ä¸ªæ ·æœ¬ç‰¹æ€§ï¼Œæ•…æœ‰å¯èƒ½åœ¨å…³äºåŒæ ·å˜é‡çš„å¦ä¸€æ ·æœ¬ä¸­å…±çº¿æ€§æ²¡æœ‰ç¬¬ä¸€ä¸ªæ ·æœ¬é‚£ä¹ˆä¸¥é‡

åœ¨ä¸‰å˜é‡å›å½’ä¸­ï¼Œæœ‰ï¼š

`$$\begin {align} 
\operatorname{var}\left(\hat{\beta}_{2}\right)=\frac{\sigma^{2}}{\sum x_{2 i}^{2}\left(1-r_{23}^{2}\right)}
\end {align}$$`

- éšç€æ ·æœ¬å¢åŠ ï¼Œ 
`\(\sum x_{2 i}^{2}\)`ä¸€èˆ¬åœ°éƒ½ä¼šå¢åŠ ï¼ˆä¸ºä»€ä¹ˆï¼Ÿï¼‰

- å› æ­¤ï¼Œå¯¹ä»»ä½•ç»™å®šçš„
`\(r^2_{23}\)`ï¼Œ 
`\(\hat{\beta}_2\)`çš„æ–¹å·®å°†ä¼šå‡å°ï¼Œä»è€Œå‡ä½
`\(\hat{\beta}_2\)`çš„æ ‡å‡†è¯¯ï¼Œä½¿æˆ‘ä»¬èƒ½å¤Ÿæ›´å‡†ç¡®åœ°ä¼°è®¡
`\(\beta_2\)`ã€‚

---
## å¤šé¡¹å¼å›å½’æ³•ï¼ˆåŸç†ï¼‰

å¤šé¡¹å¼å›å½’æ¨¡å‹ä¸­ç¦»å·®å½¢å¼æˆ–æ­£äº¤å¤šé¡¹å¼(orthogonal polynomials)å¯ä»¥é™ä½å…±çº¿æ€§çš„å½±å“ã€‚

- å¤šé¡¹å¼å›å½’æ¨¡å‹çš„ä¸€ä¸ªç‰¹ç‚¹æ˜¯è§£é‡Šå˜é‡ä»¥ä¸åŒçš„å¹‚å‡ºç°ï¼Œä»è€Œå®¹æ˜“å¯¼è‡´å¤šé‡å…±çº¿æ€§

- å¤„ç†åŠæ³•ï¼šç¦»å·®å½¢å¼æˆ–æ­£äº¤å¤šé¡¹å¼(orthogonal polynomials)æ–¹æ³•

.footnote[ ç›¸å…³èµ„æ–™å¯ä»¥å‚è€ƒå®¾å¤•æ³•å°¼äºšå¤§å­¦çš„[Reducing Structural Multicollinearity](https://newonlinecourses.science.psu.edu/stat501/node/349/) ]

---
## å¤šé¡¹å¼å›å½’æ³•ï¼ˆæ¡ˆä¾‹æ•°æ®ï¼‰




&lt;div class="figure" style="text-align: center"&gt;
&lt;div id="htmlwidget-5503ce109a05ca06a450" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-5503ce109a05ca06a450">{"x":{"filter":"none","data":[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],[881,1290,2147,1909,1282,1530,2067,1982,1019,1651,752,1687,1782,1529,969,1660,2121,1382,1714,1959,1158,965,1456,1273,1418,1743,1997,2177,1965,1264],[34.6,45,62.3,58.9,42.5,44.3,67.9,58.5,35.6,49.6,33,52,61.4,50.2,34.1,52.5,69.9,38.8,50.6,69.4,37.4,35.1,43,44.1,49.8,54.4,68.5,69.5,63,43.2],[1197.16,2025,3881.29,3469.21,1806.25,1962.49,4610.41,3422.25,1267.36,2460.16,1089,2704,3769.96,2520.04,1162.81,2756.25,4886.01,1505.44,2560.36,4816.36,1398.76,1232.01,1849,1944.81,2480.04,2959.36,4692.25,4830.25,3969,1866.24],[-676.633333333333,-267.633333333333,589.366666666667,351.366666666667,-275.633333333333,-27.6333333333334,509.366666666667,424.366666666667,-538.633333333333,93.3666666666666,-805.633333333333,129.366666666667,224.366666666667,-28.6333333333334,-588.633333333333,102.366666666667,563.366666666667,-175.633333333333,156.366666666667,401.366666666667,-399.633333333333,-592.633333333333,-101.633333333333,-284.633333333333,-139.633333333333,185.366666666667,439.366666666667,619.366666666667,407.366666666667,-293.633333333333],[-16.0366666666667,-5.63666666666667,11.6633333333333,8.26333333333333,-8.13666666666667,-6.33666666666667,17.2633333333333,7.86333333333333,-15.0366666666667,-1.03666666666667,-17.6366666666667,1.36333333333333,10.7633333333333,-0.436666666666667,-16.5366666666667,1.86333333333333,19.2633333333333,-11.8366666666667,-0.0366666666666688,18.7633333333333,-13.2366666666667,-15.5366666666667,-7.63666666666667,-6.53666666666667,-0.836666666666673,3.76333333333333,17.8633333333333,18.8633333333333,12.3633333333333,-7.43666666666667],[257.174677777778,31.7720111111112,136.033344444444,68.2826777777777,66.2053444444445,40.1533444444445,298.022677777778,61.8320111111111,226.101344444445,1.07467777777778,311.052011111111,1.85867777777777,115.849344444444,0.190677777777778,273.461344444445,3.4720111111111,371.076011111111,140.106677777778,0.0013444444444446,352.062677777778,175.209344444445,241.388011111111,58.3186777777778,42.7280111111111,0.700011111111122,14.1626777777777,319.098677777778,355.825344444444,152.852011111111,55.3040111111111]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>obs<\/th>\n      <th>Y<\/th>\n      <th>X<\/th>\n      <th>\\(X^2\\)<\/th>\n      <th>y<\/th>\n      <th>\\( x \\)<\/th>\n      <th>\\(x^2 \\)<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","pageLength":6,"columnDefs":[{"className":"dt-center","targets":"_all"}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[6,10,25,50,100],"rowCallback":"function(row, data) {\nDTWidget.formatRound(this, row, data, 3, 2, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 4, 2, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 5, 2, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 6, 2, 3, ',', '.');\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><&lt;p class="caption"&gt;æˆæœ¬ä¸äº§é‡æ•°æ®n=30)&lt;/p&gt;
&lt;/div&gt;

å…¶ä¸­ï¼š
`\(Y\)`è¡¨ç¤ºæˆæœ¬ï¼ˆ`Cost`ï¼‰ï¼›
`\(X\)`è¡¨ç¤ºäº§å“äº§é‡ï¼ˆ`Output`ï¼‰ï¼›
`\(X\)`è¡¨ç¤ºäº§å“äº§é‡çš„å¹³æ–¹ï¼›
`\(y\)`è¡¨ç¤ºæˆæœ¬çš„ç¦»å·®ï¼›
`\(x\)`è¡¨ç¤ºäº§é‡çš„ç¦»å·®ï¼›
`\(x^2\)`è¡¨ç¤ºäº§é‡ç¦»å·®çš„å¹³æ–¹ã€‚

---
## å¤šé¡¹å¼å›å½’æ³•ï¼ˆæ¡ˆä¾‹ç»˜å›¾1ï¼‰

--
.pull-left[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="07-multi-linearity-slide_files/figure-html/unnamed-chunk-55-1.png" alt="äº§é‡å’Œæˆæœ¬çš„æ•£ç‚¹å›¾"  /&gt;
&lt;p class="caption"&gt;äº§é‡å’Œæˆæœ¬çš„æ•£ç‚¹å›¾&lt;/p&gt;
&lt;/div&gt;

]

--

.pull-right[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="07-multi-linearity-slide_files/figure-html/unnamed-chunk-56-1.png" alt="äº§é‡å’Œäº§é‡å¹³æ–¹çš„æ•£ç‚¹å›¾"  /&gt;
&lt;p class="caption"&gt;äº§é‡å’Œäº§é‡å¹³æ–¹çš„æ•£ç‚¹å›¾&lt;/p&gt;
&lt;/div&gt;
]

--

å®é™…ä¸Šäº§é‡
`\(X\)`å’Œäº§é‡å¹³æ–¹
`\(X^2\)`ä¹‹é—´çš„ç›¸å…³ç³»æ•°ä¸ºï¼š
`\(r_{(X,X^2)}=\)` 0.995ã€‚äººä»¬å¯èƒ½æ‰§æ„æ„å»ºå¦‚ä¸‹çš„**äºŒæ¬¡å¤šé¡¹å¼æŠ›ç‰©çº¿æ¨¡å‹1**ï¼š

`$$\begin{equation} \begin{alignedat}{999} &amp;Y=&amp;&amp; + \beta_{1} &amp;&amp; + \beta_{2} X&amp;&amp; + \beta_{3} I(X^2)&amp;&amp;+e_i\\ \end{alignedat} \end{equation}$$`

---
## å¤šé¡¹å¼å›å½’æ³•ï¼ˆæ¡ˆä¾‹å›å½’1ï¼‰

ä¸Šè¿°**äºŒæ¬¡å¤šé¡¹å¼æŠ›ç‰©çº¿æ¨¡å‹1**å›å½’åˆ†æç»“æœå¦‚ä¸‹ï¼š

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{Y}=&amp;&amp;-1464.40&amp;&amp;+88.31X&amp;&amp;-0.54I(X^2)\\ &amp;\text{(t)}&amp;&amp;(-3.5596)&amp;&amp;(5.3606)&amp;&amp;(-3.3900)\\&amp;\text{(se)}&amp;&amp;(411.4012)&amp;&amp;(16.4735)&amp;&amp;(0.1582)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9377;&amp;&amp; \bar{R^2}=0.9331\\&amp; &amp;&amp; F^{\ast}=203.16;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

--

å¯¹ä»¥ä¸Šæ¨¡å‹è¿›è¡Œæ–¹å·®è†¨èƒ€å› å­ï¼ˆVIFï¼‰åˆ†æï¼Œç»“æœä¸ºï¼š




&lt;div class="figure" style="text-align: center"&gt;
&lt;div id="htmlwidget-f093521944f8fd17d92a" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f093521944f8fd17d92a">{"x":{"filter":"none","data":[["\\( X \\)","\\( X^2 \\)"],[99.9426130734453,99.9426130734453]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>terms<\/th>\n      <th>VIF<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-center","targets":"_all"}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatRound(this, row, data, 1, 4, 3, ',', '.');\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><&lt;p class="caption"&gt;è‡ªå˜é‡æ–¹å·®è†¨èƒ€å› å­åˆ†æç»“æœ&lt;/p&gt;
&lt;/div&gt;

---
## å¤šé¡¹å¼å›å½’æ³•ï¼ˆæ¡ˆä¾‹ç»˜å›¾2ï¼‰

--
.pull-left[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="07-multi-linearity-slide_files/figure-html/unnamed-chunk-61-1.png" alt="äº§é‡ç¦»å·®å’Œæˆæœ¬ç¦»å·®çš„æ•£ç‚¹å›¾"  /&gt;
&lt;p class="caption"&gt;äº§é‡ç¦»å·®å’Œæˆæœ¬ç¦»å·®çš„æ•£ç‚¹å›¾&lt;/p&gt;
&lt;/div&gt;

]

--

.pull-right[

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="07-multi-linearity-slide_files/figure-html/unnamed-chunk-62-1.png" alt="äº§é‡ç¦»å·®å’Œäº§é‡ç¦»å·®å¹³æ–¹çš„æ•£ç‚¹å›¾"  /&gt;
&lt;p class="caption"&gt;äº§é‡ç¦»å·®å’Œäº§é‡ç¦»å·®å¹³æ–¹çš„æ•£ç‚¹å›¾&lt;/p&gt;
&lt;/div&gt;
]

--

æ­¤æ—¶äº§é‡ç¦»å·®
`\(x\)`å’Œäº§é‡ç¦»å·®å¹³æ–¹
`\(x^2\)`ä¹‹é—´çš„ç›¸å…³ç³»æ•°ä¸ºï¼š
`\(r_{(x,x^2)}=\)` 0.22ã€‚æˆ‘ä»¬å†æ„å»ºå¦‚ä¸‹çš„**äºŒæ¬¡å¤šé¡¹å¼æŠ›ç‰©çº¿æ¨¡å‹2**ï¼š


`$$\begin{equation} \begin{alignedat}{999} &amp;y=&amp;&amp; + \beta_{1} &amp;&amp; + \beta_{2} x&amp;&amp; + \beta_{3} I(x^2)&amp;&amp;+e_i\\ \end{alignedat} \end{equation}$$`

---
## å¤šé¡¹å¼å›å½’æ³•ï¼ˆæ¡ˆä¾‹å›å½’2ï¼‰

**äºŒæ¬¡å¤šé¡¹å¼æŠ›ç‰©çº¿æ¨¡å‹2**çš„å›å½’åˆ†æç»“æœä¸ºï¼š

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{y}=&amp;&amp;+74.56&amp;&amp;+34.00x&amp;&amp;-0.54I(x^2)\\ &amp;\text{(t)}&amp;&amp;(2.5406)&amp;&amp;(20.1297)&amp;&amp;(-3.3900)\\&amp;\text{(se)}&amp;&amp;(29.3486)&amp;&amp;(1.6890)&amp;&amp;(0.1582)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9377;&amp;&amp; \bar{R^2}=0.9331\\&amp; &amp;&amp; F^{\ast}=203.16;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

--

å¯¹è¯¥æ¨¡å‹è¿›è¡Œæ–¹å·®è†¨èƒ€å› å­ï¼ˆVIFï¼‰åˆ†æï¼Œç»“æœä¸ºï¼š




&lt;div class="figure" style="text-align: center"&gt;
&lt;div id="htmlwidget-7e44a29ea184ec9e7408" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-7e44a29ea184ec9e7408">{"x":{"filter":"none","data":[["\\( x \\)","\\( x^2 \\)"],[1.05062775264011,1.05062775264011]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>terms<\/th>\n      <th>VIF<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-center","targets":"_all"}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatRound(this, row, data, 1, 4, 3, ',', '.');\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><&lt;p class="caption"&gt;è‡ªå˜é‡æ–¹å·®è†¨èƒ€å› å­åˆ†æç»“æœ&lt;/p&gt;
&lt;/div&gt;

---
## å²­å›å½’æ³•ï¼ˆåŸºæœ¬åŸç†ï¼‰

**å²­å›å½’æ³•**(ridge regression)ï¼Œä¹Ÿè¢«ç§°ä¸ºè„Šå›å½’ï¼Œå¸¸è¢«ç”¨æ¥"è§£å†³"å¤šé‡å…±çº¿æ€§é—®é¢˜ã€‚å¯æƒœè¿™äº›æŠ€æœ¯éƒ½è¦åˆ©ç”¨çŸ©é˜µä»£æ•°æ‰ä¾¿äºè®¨è®º&lt;sup&gt;*&lt;/sup&gt;ã€‚

`$$\begin {align}
\boldsymbol{y} &amp; = \boldsymbol{X\beta +u} \\
\boldsymbol{\hat{\beta}}^{ridge} &amp; =\underset{\boldsymbol{\beta} \in \mathbb{R}}{\operatorname{argmin}}\| \boldsymbol{y-X B} \|_{2}^{2}+\lambda\| \boldsymbol{B} \|_{2}^{2} \\
\boldsymbol{\hat{\beta}}_{\text {ridge}} &amp; =\boldsymbol{\left(X^{T} X+\lambda I\right)^{-1} X^{T} y}
\end {align}$$`

å…¶ä¸­ï¼š
`\(\| \boldsymbol{B} \|_{2}=\sqrt{\beta_{1}^{2}+\beta_{2}^{2}+\cdots+\beta_{k}^{2}}\)`è¡¨ç¤º**å‘é‡èŒƒæ•°**ï¼ˆvector normï¼‰è¿ç®—



.footnote[[*] å²­å›å½’çš„å…·ä½“ç»†èŠ‚ï¼Œè¯·å‚çœ‹é™„å½•[ææ–™1 Ridge Regression for Better Usage](https://towardsdatascience.com/ridge-regression-for-better-usage-2f19b3a202db)ã€[ææ–™2](https://drsimonj.svbtle.com/ridge-regression-with-glmnet) å’Œ[ææ–™3 Ridge Regression](http://r-statistics.co/Ridge-Regression-With-R.html) ]

---
## å²­å›å½’æ³•ï¼ˆRè½¯ä»¶åˆ†æï¼‰

åˆ©ç”¨`R`è½¯ä»¶è¿›è¡Œå²­å›å½’åˆ†æï¼Œç»“æœæŠ¥å‘Šå¦‚ä¸‹ï¼š



&lt;img src="pic/chpt7-ridge-reg.png" width="767" style="display: block; margin: auto;" /&gt;

---
## ä¸»æˆåˆ†åˆ†ææ³•ï¼ˆåŸç†ï¼‰

**ä¸»æˆåˆ†åˆ†ææ³•**ï¼ˆPrincipal components regression ï¼ŒPCRï¼‰ï¼Œå…¶æ ¸å¿ƒæ€æƒ³æ˜¯**é™ç»´**ï¼ˆDimensionality reductionï¼‰ï¼Œä¹Ÿå³é€šè¿‡ä¸€å®šçš„ç»Ÿè®¡æ–¹æ³•æŠŠ**åŸæ¥**ä¸ªæ•°è¾ƒå¤šçš„è‡ªå˜é‡ï¼Œè½¬æ¢ä¸ºä¸ªæ•°ç›¸å¯¹è¾ƒå°‘çš„**æ–°çš„**è‡ªå˜é‡ï¼Œç„¶åå†åˆ©ç”¨è¾ƒå°‘çš„è‡ªå˜é‡è¿›è¡Œå›å½’ï¼Œä»è€Œè¾¾åˆ°æ¶ˆé™¤å¤šé‡å…±çº¿æ€§çš„ç›®çš„ã€‚
 
- å…ˆæ ¹æ®ä¸»æˆåˆ†åˆ†æç¡®å®šä¸»æˆåˆ†ä¸ªæ•°ï¼ˆçœ‹ç´¯ç§¯è§£é‡Šç™¾åˆ†æ¯”ï¼‰

- å†ç”¨**ä¸»æˆåˆ†å˜é‡**è¿›è¡Œå›å½’åˆ†æ

.footnote[ æŠ€æœ¯ç»†èŠ‚å¯ä»¥å‚çœ‹[Performing Principal Components Regression (PCR) in R](http://www.quantide.com/performing-principal-components-regression-pcr-in-r/) ï¼Œä»¥åŠ[Principal Component Regression in
R](https://27411.compute.dtu.dk/filemanager/uploads/27411/eNotepdfs/eNote4-PCRinR.pdf)]

---
### ä¸»æˆåˆ†åˆ†ææ³•ï¼ˆæ¡ˆä¾‹ï¼‰

éƒåˆ©æ¡ˆä¾‹ä¸­ï¼Œ`R`è½¯ä»¶ä¸‹ä¸»æˆåˆ†åˆ†æç»“æœä¸ºï¼š


```
Data: 	X dimension: 16 6 
	Y dimension: 16 1
Fit method: svdpc
Number of components considered: 6

VALIDATION: RMSEP
Cross-validated using 10 random segments.
       (Intercept)  1 comps  2 comps  3 comps  4 comps
CV            3627     1158     1100    504.1    605.9
adjCV         3627     1143     1086    498.6    597.0
       5 comps  6 comps
CV       423.9    425.3
adjCV    415.8    413.8

TRAINING: % variance explained
   1 comps  2 comps  3 comps  4 comps  5 comps
X    76.72    96.31     99.7    99.95    99.99
Y    91.43    92.89     98.6    98.61    99.40
   6 comps
X   100.00
Y    99.55
```

---
### ä¸»æˆåˆ†åˆ†ææ³•ï¼ˆæ¡ˆä¾‹ï¼šç¢çŸ³å›¾ï¼‰

ä¸»æˆåˆ†åˆ†æçš„**åˆ¤å®šç³»æ•°**ä¸**ä¸»æˆåˆ†æ•°é‡**çš„å˜åŒ–æƒ…å†µå¦‚ä¸‹ï¼š

&lt;img src="07-multi-linearity-slide_files/figure-html/unnamed-chunk-70-1.png" style="display: block; margin: auto;" /&gt;

ä»ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œ**ä¸»æˆåˆ†**ä¸ªæ•°ä¸º3ä¸ªæ—¶ï¼Œ**åˆ¤å®šç³»æ•°**åŸºæœ¬å°±è¾¾åˆ°å¾ˆé«˜çš„æ°´å¹³äº†ã€‚

---
### ä¸»æˆåˆ†åˆ†ææ³•ï¼ˆæ¡ˆä¾‹ï¼šè½½è·çŸ©é˜µï¼‰



æ­¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹çœ‹ä¸»æˆåˆ†çš„**è½½è·çŸ©é˜µ**ï¼š

&lt;div class="figure" style="text-align: center"&gt;
&lt;div id="htmlwidget-96b386e4335d6f6abd34" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-96b386e4335d6f6abd34">{"x":{"filter":"none","data":[["X2","X3","X4","X5","X6","X7"],[0.461834898166772,0.461504346679002,0.321316698306542,0.201509741873208,0.46227935304156,0.46494028423307],[-0.0578427676677561,-0.0532122862362264,0.59551376271271,-0.798192547956448,0.0455444698016807,-0.000618788393180556],[0.14911989205308,0.277682326807799,-0.728305685780268,-0.561607523719203,0.195984591081625,0.128115731248627],[0.792873558903561,-0.121621225164949,0.00764579549379912,-0.077254979078646,-0.589744964749654,-0.0522865542202941],[-0.3379378262071,0.149573191817692,-0.00923196110077494,-0.0242524723087071,-0.548578173093233,0.749542835596957],[0.135187070638873,-0.818480820696095,-0.107452680630903,-0.01797096028166,0.311570867763095,0.4504088836356]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>vars<\/th>\n      <th>PC1<\/th>\n      <th>PC2<\/th>\n      <th>PC3<\/th>\n      <th>PC4<\/th>\n      <th>PC5<\/th>\n      <th>PC6<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-center","targets":"_all"}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatRound(this, row, data, 1, 4, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 2, 4, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 3, 4, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 4, 4, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 5, 4, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 6, 4, 3, ',', '.');\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><&lt;p class="caption"&gt;ä¸»æˆåˆ†åˆ†æçš„è½½è·çŸ©é˜µ&lt;/p&gt;
&lt;/div&gt;

è¯·æ³¨æ„å‰ä¸‰ä¸ªä¸»æˆåˆ†`PC1`ã€`PC2`ã€`PC3`ï¼Œä»¥åŠå®ƒä»¬åœ¨è‡ªå˜é‡ä¸Šçš„è½½è·åˆ†å¸ƒã€‚

---
### ä¸»æˆåˆ†åˆ†ææ³•ï¼ˆæ¡ˆä¾‹ï¼šå› å­å¾—åˆ†åŠæ–°æ•°æ®ï¼‰

æˆ‘ä»¬æŠŠå› å˜é‡è¿›è¡Œæ ‡å‡†åŒ–å˜æ¢
`\(Y^{\ast}_i=\frac{Y_i-\bar{Y}}{S_{Y_i}}\)`ï¼ŒåŒæ—¶åˆ©ç”¨ä»¥ä¸Šä¸»æˆåˆ†åˆ†æçš„å› å­å¾—åˆ†ï¼Œå¯ä»¥å¾—åˆ°**ä¸»æˆåˆ†é™ç»´**åçš„æ–°æ•°æ®ï¼š

&lt;div class="figure" style="text-align: center"&gt;
&lt;div id="htmlwidget-e6e679636db370b43c79" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-e6e679636db370b43c79">{"x":{"filter":"none","data":[[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16],[-1.42199458930516,-1.19448684464059,-1.46527516150667,-1.17597870521231,-0.596816311410414,-0.477794737856238,-0.0933949189611716,-0.443056383852387,0.199887905825434,0.723241140735902,0.812080209991651,0.34054976548037,0.950464144793874,1.20929335618322,1.142948794848,1.4903323348865],[-3.47885116461591,-3.01051049855093,-2.34330004185856,-2.09390206675872,-1.43823978975673,-1.01025832576328,-0.702427324412702,0.0324903553282046,0.0995120782946485,0.449431612773825,0.955062653093871,1.8170995373291,1.93998934698446,2.36112184416995,3.07801834512015,3.34476343862262],[0.751466260852026,0.849040549823804,1.53999657499663,1.27632044197399,-1.23579413551051,-1.92210442043256,-1.91056317495043,-0.593047850840494,-0.693492715226238,-0.547844423501594,-0.429448029428114,0.863171794787778,0.38657073582799,0.499103927567887,0.989955825010999,0.176668639048833],[0.307945816507745,0.642231173899522,-0.493433528839948,-0.111293183614468,-0.0290952725820153,-0.161216650943881,0.0671359308977066,-1.03899732376216,-0.0975673209092177,0.292948256342065,0.445238249201229,-0.677417816899047,0.265962368310368,0.365672101839671,-0.201967849931779,0.423855050484207]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>obs<\/th>\n      <th>Y.std<\/th>\n      <th>PC1<\/th>\n      <th>PC2<\/th>\n      <th>PC3<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","pageLength":5,"columnDefs":[{"className":"dt-center","targets":"_all"}],"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100],"rowCallback":"function(row, data) {\nDTWidget.formatRound(this, row, data, 1, 4, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 2, 4, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 3, 4, 3, ',', '.');\nDTWidget.formatRound(this, row, data, 4, 4, 3, ',', '.');\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><&lt;p class="caption"&gt;å› å­å¾—åˆ†åŠæ–°æ•°æ®&lt;/p&gt;
&lt;/div&gt;

---
### ä¸»æˆåˆ†åˆ†ææ³•ï¼ˆæ¡ˆä¾‹ï¼šæ–°æ¨¡å‹å›å½’ï¼‰

åˆ©ç”¨ä»¥ä¸Š**é™ç»´**åçš„æ–°æ•°æ®ï¼Œå¯ä»¥æ„é€ å¦‚ä¸‹æ–°çš„æ¨¡å‹ï¼š

`$$\begin{equation} \begin{alignedat}{999} &amp;Y.std=&amp;&amp; + \beta_{1} &amp;&amp; + \beta_{2} PC1&amp;&amp; + \beta_{3} PC2&amp;&amp; + \beta_{4} PC3&amp;&amp;+e_i\\ \end{alignedat} \end{equation}$$`

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{Y.std}=&amp;&amp;-0.00&amp;&amp;+0.45PC1&amp;&amp;-0.11PC2&amp;&amp;+0.53PC3\\ &amp;\text{(t)}&amp;&amp;(-0.0000)&amp;&amp;(27.9607)&amp;&amp;(-3.5371)&amp;&amp;(6.9867)\\&amp;\text{(se)}&amp;&amp;(0.0331)&amp;&amp;(0.0159)&amp;&amp;(0.0315)&amp;&amp;(0.0758)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9860;&amp;&amp; \bar{R^2}=0.9825\\&amp; &amp;&amp; F^{\ast}=281.04;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

--

å¯¹è¯¥æ¨¡å‹è¿›è¡Œæ–¹å·®è†¨èƒ€å› å­ï¼ˆVIFï¼‰åˆ†æï¼ŒVIFéƒ½æ¯”è¾ƒå°ï¼Œå¤šé‡å…±çº¿æ€§é—®é¢˜å¾—åˆ°è§£å†³ã€‚



&lt;div class="figure" style="text-align: center"&gt;
&lt;div id="htmlwidget-d843b07efa1a0b426f19" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d843b07efa1a0b426f19">{"x":{"filter":"none","data":[["PC1","PC2","PC3"],[1,1,1]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th>terms<\/th>\n      <th>VIF<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-center","targets":"_all"}],"order":[],"autoWidth":false,"orderClasses":false,"rowCallback":"function(row, data) {\nDTWidget.formatRound(this, row, data, 1, 4, 3, ',', '.');\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script><&lt;p class="caption"&gt;æ–°æ¨¡å‹çš„æ–¹å·®è†¨èƒ€å› å­åˆ†æç»“æœ&lt;/p&gt;
&lt;/div&gt;


---
## å¤šé‡å…±çº¿æ€§ä¸€å®šæ˜¯åäº‹å—?

å¦‚æœå›å½’åˆ†æçš„å”¯ä¸€ç›®çš„æ˜¯é¢„æµ‹æˆ–é¢„æŠ¥ï¼Œåˆ™å¤šé‡å…±çº¿æ€§å°±ä¸æ˜¯ä¸€ä¸ªä¸¥é‡çš„é—®é¢˜ã€‚å› ä¸º
`\(R^2\)`å€¼è¶Šé«˜ï¼Œé¢„æµ‹è¶Šå‡†ã€‚

**æ— ä¸ºè€Œæ²»**ï¼šå¤šé‡å…±çº¿æ€§æ˜¯æ™®éå­˜åœ¨çš„ï¼Œå®ƒå¹¶ä¸æ˜¯OLS æˆ–å…¶ä»–ä¸€èˆ¬æ€§ç»Ÿè®¡æ–¹æ³•å¼•èµ·çš„é—®é¢˜


---
background-image: url("pic/thank-you-gif-funny-little-yellow.gif")
class: inverse,center
# æœ¬ç« ç»“æŸ
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
