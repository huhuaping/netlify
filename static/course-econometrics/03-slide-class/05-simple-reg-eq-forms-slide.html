<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>05-simple-reg-eq-forms-slide.knit</title>
    <meta charset="utf-8" />
    <script src="libs/header-attrs-2.16/header-attrs.js"></script>
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/duke-blue.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/hygge-duke.css" rel="stylesheet" />
    <link href="libs/tachyons-4.12.0/tachyons.min.css" rel="stylesheet" />
    <link href="libs/panelset-0.2.6/panelset.css" rel="stylesheet" />
    <script src="libs/panelset-0.2.6/panelset.js"></script>
    <script src="libs/htmlwidgets-1.5.4/htmlwidgets.js"></script>
    <link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding-0.24/datatables.js"></script>
    <script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
    <link href="libs/dt-core-1.11.3/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core-1.11.3/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core-1.11.3/js/jquery.dataTables.min.js"></script>
    <link href="libs/crosstalk-1.2.0/css/crosstalk.min.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.2.0/js/crosstalk.min.js"></script>
    <script src="libs/kePrint-0.0.1/kePrint.js"></script>
    <link href="libs/lightable-0.0.1/lightable.css" rel="stylesheet" />
    <link rel="stylesheet" href="../mycss/my-theme.css" type="text/css" />
    <link rel="stylesheet" href="../mycss/my-font.css" type="text/css" />
    <link rel="stylesheet" href="../mycss/my-custom-for-video-roomy.css" type="text/css" />
    <link rel="stylesheet" href="../mycss/text-box.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

background-image: url("../pic/slide-front-page.jpg")
class: center,middle

# 计量经济学(Econometrics)

### 胡华平

### 西北农林科技大学

### 经济管理学院数量经济教研室

### huhuaping01@hotmail.com

### 2023-02-15




<div>
<style type="text/css">.xaringan-extra-logo {
width: 110px;
height: 70px;
z-index: 0;
background-image: url(../pic/logo/nwafu-logo-circle-wb.png);
background-size: contain;
background-repeat: no-repeat;
position: absolute;
top:0.2em;left:1em;
}
</style>
<script>(function () {
  let tries = 0
  function addLogo () {
    if (typeof slideshow === 'undefined') {
      tries += 1
      if (tries < 10) {
        setTimeout(addLogo, 100)
      }
    } else {
      document.querySelectorAll('.remark-slide-content:not(.title-slide):not(.inverse):not(.hide_logo)')
        .forEach(function (slide) {
          const logo = document.createElement('div')
          logo.classList = 'xaringan-extra-logo'
          logo.href = null
          slide.appendChild(logo)
        })
    }
  }
  document.addEventListener('DOMContentLoaded', addLogo)
})()</script>
</div>


---
class: center, middle, duke-orange,hide_logo
name: chapter05

# 第5章：一元回归：模型形式扩展


.pull-left[
[5.1 过原点回归](#no-intercept)

[5.2 尺度与测量单位](#scale)

[5.3 标准化变量回归](#standard)

]

.pull-right[
[5.4 对数线性模型](#log-log)

[5.5 半对数模型](#semi-log)

[5.6 倒数模型](#reciprocal-mod)

[5.7 函数模型的选择](#options)
]

---
layout: false
class: center, middle, duke-softblue,hide_logo
name: no-intercept

# 5.1 过原点回归 

---
layout: true
  
&lt;div class="my-header-h2"&gt;&lt;/div&gt;
&lt;div class="watermark1"&gt;&lt;/div&gt;
&lt;div class="watermark2"&gt;&lt;/div&gt;
&lt;div class="watermark3"&gt;&lt;/div&gt;

&lt;div class="my-footer"&gt;&lt;span&gt;huhuaping@   &lt;a href="#chapter05"&gt;第5章：一元回归：模型形式扩展&lt;/a&gt;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&lt;a href="#no-intercept"&gt;5.1 过原点回归&lt;/a&gt; &lt;/span&gt;&lt;/div&gt; 

---

## 过原点回归的模型形式

**过原点回归**（regression through the origin）：没有截距项的线性模型

在实践中，双变量PRM过原点回归采取如下的形式：

`$$\begin {align} 
Y_{i}=\beta_{2} X_{i}+u_{i}
\end {align}$$`

适用于这种模型的例子：

- 弗里德曼的持久收入假说(permanent income hypothesis)；

- 资本资产定价模型( the capital Asset Pricing Model, CAPM )等。

---

## 资本资产定价模型（CAPM）

资本资产定价模型( the capital Asset Pricing Model, CAPM )：

`$$\begin {align} 
\left(E R_{i}-r_{f}\right)=\beta_{i}\left(E R_{m}-r_{f}\right)
 \end {align}$$`
 
其中：
- `\(ER_i\)`证券
`\(i\)`的期望回报率；

- `\(ER_m\)`市场证券组合的期望回报率（如标准普尔S&amp;P500综合股票指数）；

- `\(r_f\)`为无风险回报率（90天国债回报率）。

- `\(\beta_i\)`为系数，表明第
`\(i\)`种证券回报率与市场互动程度的度量。(注:不要把这个
`\(\beta_i\)`和双变量回归的斜率系数
`\(\beta_2\)`混同起来。)

一个大于1的
`\(\beta_i\)`意味着证券
`\(i\)`是一种易波动或进攻型证券；一个小于1的
`\(\beta_i\)`意味着证券
`\(i\)`是一种防御型证券。

---

## 资本资产定价模型（CAPM）

`$$\begin {align} 
R_{i}-r_{f} &amp;=\beta_{i}\left(R_{m}-r_{f}\right)+u_{i} \\ 
R_{i}-r_{f} &amp;=\alpha_{i}+\beta_{i}\left(R_{m}-r_{f}\right)+u_{i}
\end  {align}$$`
 
- 如果CAPM成立，则预期
`\(\alpha_i\)`为0。


- 这样的模型如何估计呢？

---

## 资本资产定价模型（CAPM）

这类模型的SRM可以写成：

`$$\begin {align} 
Y_{i}  &amp; =\hat{\beta}_{2} X_{i}+\mathrm{e}_{i} \\ 
\end {align}$$`

OLS方法下求解回归系数：

`$$\begin {align} 
\sum \mathrm{e}_{i}^{2} &amp; =\sum\left(Y_{i}-\hat{\beta}_{2} X_{i}\right)^{2}
\end {align}$$`
 
`$$\begin {align} 
  \frac{\partial \sum \mathrm{e}_{i}^{2}}{\partial \hat{\beta}_{2}} &amp;=2 \sum\left(Y_{i}-\hat{\beta}_{2} X_{i}\right)\left(-X_{i}\right)=0 \\ 
  \hat{\beta}_{2}&amp;=\frac{\sum X_{i} Y_{i}}{\sum X_{i}^{2}}=\frac{\sum X_{i}\left(\beta_{2} X_{i}+u_{i}\right)}{\sum X_{i}^{2}}=\beta_{2}+\frac{\sum X_{i} u_{i}}{\sum X_{i}^{2}} \\ E\left(\hat{\beta}_{2}\right)&amp;=\beta_{2}
\end {align}$$`

---

## 资本资产定价模型（CAPM）

OLS方法下求解得到的方差：

`$$\begin{align}
Var\left(\hat{\beta}_{2}\right)&amp;=E\left(\hat{\beta}_{2}-\beta_{2}\right)^{2} \\
&amp;= E\left[\frac{\sum X_{i} u_{i}}{\sum X_{i}^{2}}\right]^{2} \\ 
&amp;= \frac{\sigma^{2}}{\sum X_{i}^{2}}
\end{align}$$`

`$$\begin {align} 
\hat{\sigma}^{2}=\frac{\sum e_{i}^{2}}{n-1}; \quad \mathrm{E}\left(\hat{\sigma}^{2}\right)=\sigma^{2}
\end {align}$$`

---

## 资本资产定价模型（CAPM）

OLS估计量对比：无截距和有截距的差异：

.pull-left[
`$$\begin {align} 
Y_{i}  &amp; =\hat{\beta}_{2} X_{i}+\mathrm{e}_{i} \\ 
\end {align}$$`

`$$\begin {align} 
\hat{\beta}_{2}=\frac{\sum X_{i} Y_{i}}{\sum X_{i}^{2}} \\ Var\left(\hat{\beta}_{2}\right)=\frac{\sigma^{2}}{\sum X_{i}^{2}} \\ \hat{\sigma}^{2}=\frac{\sum \mathrm{e}_{i}^{2}}{n-1}
\end {align}$$`

]

.pull-right[
`$$\begin {align} 
Y_{i}  &amp; =\hat{\beta}_{1}  +\hat{\beta}_{2} X_{i}+\mathrm{e}_{i} \\ 
\end {align}$$`

`$$\begin {align} 
\hat{\beta}_{2} &amp;=\frac{\sum x_{i} y_{i}}{\sum x_{i}^{2}} \\ 
Var\left(\hat{\beta}_{2}\right) &amp;=\frac{\sigma^{2}}{\sum x_{i}^{2}} \\ 
\hat{\sigma}^{2} &amp;=\frac{\sum \mathrm{e}_{i}^{2}}{n-2}
\end {align}$$`

]

&gt; 第一，对有截距项的模型来说，总有
`\(\sum{e_i}=0\)`；对无截距项的模型来说，
`\(\sum{e_i}=0\)`不一定成立，只有
`\(\sum{e_iX_i}=0\)`成立。

&gt; 第二，对有截距项的模型，判定系数
`\(r^2 \geq 0\)`；但是，对无截距模型来说，
`\(r^2\)`时可能出现负值。

---

## 资本资产定价模型（CAPM）

过原点回归的判定系数
`\(r^2\)`的计算公式如下：

`$$\begin {align} 
TSS &amp;=\sum y_{i}^{2}=\sum Y_{i}^{2}-n \overline{Y}^{2} \\
RSS &amp;=\sum e_{i}^{2}=\sum Y_{i}^{2}-\hat{\beta}_{2}^{2} \sum X_{i}^{2}\\
r^2 &amp;= 1- \frac{RSS}{TSS}  &gt;0; \quad r^2 = 1- \frac{RSS}{TSS} &lt;0;
\end {align}$$`

因此，对于无截距模型，我们给出拟合优度指标为**毛判定系数**（Raw 
`\(r^2\)`）：

`$$\begin {align} 
Raw \quad r^{2} = \frac{\sum\left(X_{i} Y_{i}\right)^{2}}{\sum X_{i}^{2} \sum Y_{i}^{2}} 
\end {align}$$`

---

## 资本资产定价模型（CAPM）

**启示**：

- 第一，尽管模型含有截距项，但若该项的出现是统计上不显著的(即统计上等于零) ，则从任何实际方面考虑，都可认为这个结果是一个过原点回归模型。
- 第二，如果在模型中确实有截距，而我们却执意拟合一个过原点回归，我们就犯了**设定错误**。

---

### 资本资产定价模型（CAPM）：数据



1980.01-1999.12年间104 种股票构成的一个指数的超额回报率
`\(Y_t\)`(%)和英国总体股票指数的超额回报率
`\(X_t\)`(%)的月度数据共n=240个月观测。其中超额回报率指的是超过无风险资产回报率的部分。

<div id="htmlwidget-b6400793d464c25ac525" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b6400793d464c25ac525">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240"],[1980,1980,1980,1980,1980,1980,1980,1980,1980,1980,1980,1980,1981,1981,1981,1981,1981,1981,1981,1981,1981,1981,1981,1981,1982,1982,1982,1982,1982,1982,1982,1982,1982,1982,1982,1982,1983,1983,1983,1983,1983,1983,1983,1983,1983,1983,1983,1983,1984,1984,1984,1984,1984,1984,1984,1984,1984,1984,1984,1984,1985,1985,1985,1985,1985,1985,1985,1985,1985,1985,1985,1985,1986,1986,1986,1986,1986,1986,1986,1986,1986,1986,1986,1986,1987,1987,1987,1987,1987,1987,1987,1987,1987,1987,1987,1987,1988,1988,1988,1988,1988,1988,1988,1988,1988,1988,1988,1988,1989,1989,1989,1989,1989,1989,1989,1989,1989,1989,1989,1989,1990,1990,1990,1990,1990,1990,1990,1990,1990,1990,1990,1990,1991,1991,1991,1991,1991,1991,1991,1991,1991,1991,1991,1991,1992,1992,1992,1992,1992,1992,1992,1992,1992,1992,1992,1992,1993,1993,1993,1993,1993,1993,1993,1993,1993,1993,1993,1993,1994,1994,1994,1994,1994,1994,1994,1994,1994,1994,1994,1994,1995,1995,1995,1995,1995,1995,1995,1995,1995,1995,1995,1995,1996,1996,1996,1996,1996,1996,1996,1996,1996,1996,1996,1996,1997,1997,1997,1997,1997,1997,1997,1997,1997,1997,1997,1997,1998,1998,1998,1998,1998,1998,1998,1998,1998,1998,1998,1998,1999,1999,1999,1999,1999,1999,1999,1999,1999,1999,1999,1999],[1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12,1,2,3,4,5,6,7,8,9,10,11,12],[7.263448,6.339896,-9.285217,0.793291,-2.902421,8.613151,3.982063,-1.150171,3.486126,4.32985,0.936875,-5.202456,-2.082757,2.728523,0.653397,6.436072,-4.259198,0.54391,-0.486846,2.844,-16.45721,4.468938,5.88552,-0.390698,2.499568,-4.033607,3.042526,0.734565,2.779732,-5.900116,3.005344,3.954991,2.547127,4.329008,0.191941,-0.921676,3.394683,0.758714,1.862074,6.797751,-1.699254,4.092592,-2.926299,1.773424,-2.800816,-1.505395,4.186963,1.201417,6.769321,-1.686027,5.245806,1.72871,-7.279076,-0.779471,-2.439635,8.445978,1.22108,2.733387,5.127533,3.191555,3.907839,-1.708568,0.435219,0.958068,1.095477,-6.816109,2.785054,3.900209,-4.203004,5.601798,1.570094,-1.084427,0.77867,6.470651,8.953781,-2.387762,-2.873839,3.440269,-5.891053,6.375582,-5.734839,3.630884,-1.316067,3.521601,8.673413,6.914362,-0.460661,4.295976,7.719693,3.039888,2.510224,-3.039443,3.787092,-27.86969,-9.956367,7.975866,3.936938,-0.327971,-2.161544,2.721788,-0.514825,3.128797,0.181502,-7.892364,3.347082,3.158592,-4.81647,-0.00855,13.46098,-0.764475,2.298491,0.762075,-0.495796,1.206636,4.637026,2.680874,-5.303858,-7.210656,5.350186,4.106246,-3.629547,-5.205804,-2.183245,-5.408564,10.57599,-0.338612,-2.213162,-8.476177,-7.459414,-0.085888,5.03477,-1.767715,0.189108,10.38741,2.921914,0.97172,-0.431782,-3.342925,5.242812,2.880655,-1.121472,-3.969578,-5.707995,1.502567,2.599565,0.135881,-6.146138,10.45737,1.415987,-8.261109,-3.778812,-5.386818,11.19436,3.99987,3.620675,2.887222,1.336746,1.240274,0.407144,-1.73493,1.111534,1.354128,1.943062,4.96198,-1.61873,4.215409,1.88036,5.826353,2.973541,-5.479858,-5.784547,1.157083,-6.356199,-0.843584,5.779953,3.29813,-7.11001,2.968006,-1.531245,0.26428,-2.420388,0.138795,3.231657,2.215805,3.856814,-0.952204,4.020036,1.4236,-0.037913,-1.176553,3.760277,0.434626,1.906345,0.301899,-0.314132,3.034332,-1.497346,-0.894677,-0.532816,3.863737,2.118255,-0.853553,1.770341,1.702552,3.465753,1.115253,-2.057818,3.570899,1.95348,2.4587,2.992341,-0.457968,8.111279,-6.967124,-0.155925,3.853283,7.379466,4.299098,3.41078,-0.081495,-1.613131,-0.397289,-2.237365,-12.4632,-5.170735,11.70545,-0.3802,4.986705,2.493728,0.937105,4.280083,3.960824,-4.499198,3.656746,-2.503972,-0.121902,-5.388032,4.01099,6.265313,4.045659],[6.080228,-0.924186,-3.286174,5.211977,-16.16421,-1.054704,11.17238,-11.06328,-16.777,-7.021834,-9.716846,5.215706,-6.612001,4.264498,4.916711,22.20496,-11.29869,-5.770508,-5.217765,16.1962,-17.16995,1.105335,11.68534,-2.301452,8.643728,-11.12908,1.724628,0.15788,-1.875203,-10.62482,-5.761136,5.481432,-17.02207,7.625421,-6.575722,-2.37283,17.52375,1.354656,16.26861,-6.074547,-0.826651,3.807882,0.575701,3.755563,-5.365927,-3.750303,4.898752,4.379256,16.56016,1.523127,1.020608,-3.899308,-14.32502,3.056627,-0.021536,3.355102,0.100007,1.69125,8.200753,3.527866,4.554588,5.365479,4.525231,2.944654,-0.2686,-3.661041,-4.540505,9.195292,-1.894817,12.00661,1.233987,-1.44633,6.023619,10.51236,13.40071,-7.796263,0.21154,6.471111,-9.037476,-5.478381,-6.756882,-2.56496,2.456599,1.476421,17.0694,7.565727,-3.239326,3.662578,7.157455,4.774901,4.237702,-0.881352,11.49688,-35.56618,-14.59137,14.87272,1.748599,-0.606016,-6.078095,3.976154,-1.05091,3.317857,0.4071,-11.87932,-8.801026,6.784211,-10.20578,-6.738054,12.83904,3.302861,-0.155918,3.623091,-1.167681,-1.221603,5.262903,4.845013,-5.069565,-13.57964,1.100608,4.925083,-2.532069,-6.601873,-1.023769,-7.097917,6.376627,1.861975,-5.591527,-15.31759,-10.17227,-2.217396,5.974206,-0.857289,-3.780185,20.64721,10.94068,-3.14564,-3.142888,-1.960866,7.330964,7.854388,2.539178,-1.233245,-11.74604,1.078226,5.937905,4.113184,-0.655199,15.2843,3.994518,-11.94451,-2.530701,-9.842366,18.11574,0.20095,1.125853,7.639181,2.919569,-1.062404,1.292641,0.420241,-2.514081,0.419362,4.374024,1.733528,-3.659809,5.856908,-1.36555,-1.346979,12.89579,-5.346701,-7.614727,10.22043,-6.928422,-5.065919,7.483499,1.828763,-5.692933,-2.426962,2.125101,-4.225371,-6.302392,1.278676,10.90891,2.497849,2.891527,-3.773,8.776289,2.882561,2.146913,-4.590105,-1.293255,-4.244102,6.647089,1.635901,7.85819,0.789545,-0.907725,-0.392247,-1.035896,2.556816,3.13183,-0.020947,-5.312288,-5.196177,-0.753247,-2.474344,2.476478,-1.119104,3.352076,-1.910172,0.142815,10.50199,12.98502,-4.134762,-4.14858,-1.752478,-3.349122,14.07471,7.791651,5.154679,3.293686,-13.25462,-7.714206,-15.2634,-15.22865,15.96218,-8.684089,17.13842,-1.468449,8.5036,10.89431,13.03497,-5.654672,8.321969,0.507652,-5.022981,-2.305449,-1.876879,1.348825,-2.641649]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>year<\/th>\n      <th>month<\/th>\n      <th>X<\/th>\n      <th>Y<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"targets":3,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":8,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render"],"jsHooks":[]}</script>

---

### 资本资产定价模型（CAPM）：散点图

下面先直接给出二者的散点图：

&lt;img src="05-simple-reg-eq-forms-slide_files/figure-html/unnamed-chunk-3-1.png" style="display: block; margin: auto;" /&gt;

---

### 资本资产定价模型（CAPM）：回归结果

两类模型回归结果对比：

.pull-left[
**无截距模型**：

`$$\begin {align} 
Y_{i}  &amp; =\hat{\beta}_{2} X_{i}+\mathrm{e}_{i} 
\end {align}$$`

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{Y}=&amp;&amp;+1.16X\\ &amp;\text{(t)}&amp;&amp;(15.5320)\\&amp;\text{(se)}&amp;&amp;(0.0744)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.5023;&amp;&amp; \bar{R^2}=0.5003\\&amp; &amp;&amp; F^{\ast}=241.24;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

]

.pull-right[
**有截距模型**：

`$$\begin {align} 
Y_{i}  &amp; =\hat{\beta}_{1} +\hat{\beta}_{2} X_{i}+\mathrm{e}_{i} 
\end {align}$$`

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{Y}=&amp;&amp;-0.45&amp;&amp;+1.17X\\ &amp;\text{(t)}&amp;&amp;(-1.2329)&amp;&amp;(15.5350)\\&amp;\text{(se)}&amp;&amp;(0.3629)&amp;&amp;(0.0754)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.5035;&amp;&amp; \bar{R^2}=0.5014\\&amp; &amp;&amp; F^{\ast}=241.34;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

]


---
layout: false
class: center, middle, duke-softblue,hide_logo
name: scale

# 5.2 尺度与测量单位

---
layout: true
  
&lt;div class="my-header-h2"&gt;&lt;/div&gt;
&lt;div class="watermark1"&gt;&lt;/div&gt;
&lt;div class="watermark2"&gt;&lt;/div&gt;
&lt;div class="watermark3"&gt;&lt;/div&gt;

&lt;div class="my-footer"&gt;&lt;span&gt;huhuaping@   &lt;a href="#chapter05"&gt;第5章：一元回归：模型形式扩展&lt;/a&gt;  
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&lt;a href="#scale"&gt;5.2 尺度与测量单位&lt;/a&gt; &lt;/span&gt;&lt;/div&gt; 

---

## 案例数据



回归分析中，因变量Y和解释变量X的测量单位不同会造成回归结果的差异吗？

<div id="htmlwidget-f9bb6fa8db129920e367" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-f9bb6fa8db129920e367">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16"],["1990 ","1991 ","1992 ","1993 ","1994 ","1995 ","1996 ","1997 ","1998 ","1999  ","2000 ","2001 ","2002","2003","2004 ","2005 "],[886.6,829.1,878.3,953.5,1042.3,1109.6,1209.2,1320.6,1455,1576.3,1679,1629.4,1544.6,1596.9,1713.9,1842],[886600,829100,878300,953500,1042300,1109600,1209200,1320600,1455000,1576300,1679000,1629400,1544600,1596900,1713900,1842000],[7112.5,7100.5,7336.6,7532.7,7835.5,8031.7,8328.9,8703.5,9066.9,9470.3,9817,9890.7,10048.8,10301,10703.5,11048.6],[7112500,7100500,7336600,7532700,7835500,8031700,8328900,8703500,9066900,9470300,9817000,9890700,10048800,10301000,10703500,11048600],[-1.29421322424925,-1.46237119822207,-1.31848646223142,-1.09856507714001,-0.838870675595908,-0.642052733885118,-0.350773878099163,-0.0249860815674826,0.368064904553324,0.722805117473368,1.02314988142134,0.878095350829133,0.630098895300528,0.783049539453194,1.12521446040657,1.49984118155297],[-1.34591381872393,-1.35497190595521,-1.17675403967979,-1.02872979750864,-0.800164063039362,-0.652064336807947,-0.427725709713265,-0.144962419976832,0.129346655010407,0.433849354101909,0.695552591025618,0.751184343437725,0.870524642709828,1.06089544268721,1.36471878523637,1.62521427719591]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Year<\/th>\n      <th>GPDIB<\/th>\n      <th>GPDIM<\/th>\n      <th>GDPB<\/th>\n      <th>GDPM<\/th>\n      <th>GPDIB_std<\/th>\n      <th>GDPB_std<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"targets":6,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"targets":7,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":5,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render"],"jsHooks":[]}</script>

&gt;
- GPDIB = 以2000年**10亿**(Billions)美元计国内私人总投资；
GPDIM = 以2000年**百万**(millions)美元计国内私人总投资；
- GDPB = 以2000年**10亿**(Billions)美元计GDP总值；
GDPM = 以2000年**百万**(millions)美元计GDP总值。


---

## 尺度变换

把某一测量单位下的回归模型，变换为另一测量单位的回归模型：

`$$\begin {align} 
Y_{i}  &amp; =\hat{\beta}_{1} +\hat{\beta}_{2} X_{i}+\mathrm{e}_{i}\\
Y^{\ast}_{i}  &amp; =\hat{\beta}^{\ast}_{1} +\hat{\beta}^{\ast}_{2} X_{i}+\mathrm{e}^{\ast}_{i}
\end {align}$$`

**尺度因子**：
`\(\omega_1;\omega_2\)`分别表示为Y和X的尺度因子。

`$$\begin {align} 
Y_{i}^{*}=\omega_{1} Y_{i} \quad X_{i}^{*}=\omega_{2} X_{i}
\end {align}$$`

如果
`\((Y_i;X_i)\)`都是以**10亿**(billion)美元计量的，我们把它们改为用**百万**(million)美元去度量，就会有：

`$$\begin {align} 
Y_{i}^{*}=1000 Y_{i}; \quad X_{i}^{*}=1000 X_{i}; \quad \omega_{1}=\omega_{2}=1000
\end {align}$$`

---

## OLS估计

进行数据转换，新模型的OLS估计量如下：

`$$\begin {align} 
Y_{i}  &amp; =\hat{\beta}_{1} +\hat{\beta}_{2} X_{i}+\mathrm{e}_{i}\\
Y^{\ast}_{i}  &amp; =\hat{\beta}^{\ast}_{1} +\hat{\beta}^{\ast}_{2} X_{i}+\mathrm{e}^{\ast}_{i} \\
Y_{i}^{*}&amp;=\omega_{1} Y_{i} ; \quad X_{i}^{*}=\omega_{2} X_{i} ; \quad e_{i}^{*}=\omega_{1} e_{i}
\end {align}$$`

`$$\begin {align} 
\hat{\beta}_{2} * &amp;=\frac{\sum x_{i}^{*} y_{i}^{*}}{\sum x_{i}^{* 2}} \quad &amp;&amp; \Leftarrow
\operatorname{var}\left(\hat{\beta}_{2}^{*}\right)=\frac{\sigma^{* 2}}{\sum x_{i}^{* 2}}\\
\hat{\beta}_{1}^{*}&amp;=\overline{Y}^{*}-\hat{\beta}_{2}^{*} \overline{X}^{*} \quad &amp;&amp; \Leftarrow
\operatorname{var}\left(\hat{\beta}_{1}^{*}\right)=\frac{\sum X_{i}^{* 2}}{n \sum x_{i}^{* 2}} \cdot \sigma^{* 2}\\
\hat{\sigma}^{* 2} &amp;=\frac{\sum e_{i}^{* 2}}{n-2}
 \end {align}$$`

---

## OLS估计

进行数据转换，两个模型下OLS估计量有如下关系：

`$$\begin {align} 
Y_{i}  &amp; =\hat{\beta}_{1} +\hat{\beta}_{2} X_{i}+\mathrm{e}_{i}\\
Y^{\ast}_{i}  &amp; =\hat{\beta}^{\ast}_{1} +\hat{\beta}^{\ast}_{2} X_{i}+\mathrm{e}^{\ast}_{i} \\
Y_{i}^{*}&amp;=\omega_{1} Y_{i} ; \quad X_{i}^{*}=\omega_{2} X_{i} ; \quad e_{i}^{*}=\omega_{1} e_{i}
\end {align}$$`

`$$\begin {align} 
\hat{\beta}_{1}^{*} &amp;=\left(\omega_{1}\right) \hat{\beta}_{1} ; &amp;&amp;
\hat{\beta}_{2}^{*} =\left(\frac{\omega_{1}}{\omega_{2}}\right) \hat{\beta}_{2} \\
\operatorname{var}\left(\hat{\beta}_{2}^{*}\right) &amp;=\left(\frac{\omega_{1}}{\omega_{2}}\right)^{2} \operatorname{var}\left(\hat{\beta}_{2}\right) ; &amp;&amp; 
\operatorname{var}\left(\hat{\beta}_{1}^{*}\right)  =\omega_{1}^{2} \operatorname{var}\left(\hat{\beta}_{1}\right) \\
\hat{\sigma}^{* 2} &amp; =\omega_{1}^{2} \hat{\sigma}^{2} \\
r_{x y}^{2} &amp; =r_{x * y^{*}}^{2}
\end {align}$$`


---

## 相关结论

`$$\begin {align} 
Y_{i}  &amp; =\hat{\beta}_{1} +\hat{\beta}_{2} X_{i}+\mathrm{e}_{i}\\
Y^{\ast}_{i}  &amp; =\hat{\beta}^{\ast}_{1} +\hat{\beta}^{\ast}_{2} X_{i}+\mathrm{e}^{\ast}_{i} \\
Y_{i}^{*}&amp;=\omega_{1} Y_{i} ; \quad X_{i}^{*}=\omega_{2} X_{i} ; \quad e_{i}^{*}=\omega_{1} e_{i}
\end {align}$$`

模型对比，得出如下主要结论：

- 
`\(\omega_1=\omega_2\)` ，即尺度因子相等时，**斜率系数**及其**标准误**不受尺度从（
`\(Y_i,X_i\)`）到（
`\(Y_i^{\ast},X_i^{\ast}\)`）的影响。**截距**及其**标准误**却放大或缩小至
`\(\omega_1\)`倍。

- 
`\(X_i\)`尺度不变
`\(\omega_2=1\)`，
`\(Y_i\)`尺度因子
`\(\omega_1\)`变化，那么，斜率和截距系数以及它们各自的标准误都要乘以同样的因子
`\(\omega_1\)`。

- 
`\(Y_i\)`尺度不变
`\(\omega_1=1\)` ，而
`\(X_i\)`尺度因子
`\(\omega_2\)`变化，那么，斜率系数及其标准误都要乘以因子
`\(1/\omega_1\)`，而截距系数及其标准误不变。


---

### 案例分析结果

--
.pull-left[
GPDI和GDP都以十亿美元计算：

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{GPDIB}=&amp;&amp;-926.09&amp;&amp;+0.25GDPB\\ &amp;\text{(t)}&amp;&amp;(-7.9590)&amp;&amp;(19.5824)\\&amp;\text{(se)}&amp;&amp;(116.3577)&amp;&amp;(0.0129)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9648;&amp;&amp; \bar{R^2}=0.9623\\&amp; &amp;&amp; F^{\ast}=383.47;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`


GPDI和GDP都以百万美元计算：
`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{GPDIM}=&amp;&amp;-926090.39&amp;&amp;+0.25GDPM\\ &amp;\text{(t)}&amp;&amp;(-7.9590)&amp;&amp;(19.5824)\\&amp;\text{(se)}&amp;&amp;(116357.6965)&amp;&amp;(0.0129)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9648;&amp;&amp; \bar{R^2}=0.9623\\&amp; &amp;&amp; F^{\ast}=383.47;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

]

--

.pull-right[
GPDI以十亿美元，而GDP以百万美元:
`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{GPDIB}=&amp;&amp;-926.09&amp;&amp;+0.00GDPM\\ &amp;\text{(t)}&amp;&amp;(-7.9590)&amp;&amp;(19.5824)\\&amp;\text{(se)}&amp;&amp;(116.3577)&amp;&amp;(0.0000)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9648;&amp;&amp; \bar{R^2}=0.9623\\&amp; &amp;&amp; F^{\ast}=383.47;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

GPDl以百万美元而GDP 以十亿美元：

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{GPDIM}=&amp;&amp;-926090.39&amp;&amp;+253.52GDPB\\ &amp;\text{(t)}&amp;&amp;(-7.9590)&amp;&amp;(19.5824)\\&amp;\text{(se)}&amp;&amp;(116357.6965)&amp;&amp;(12.9465)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9648;&amp;&amp; \bar{R^2}=0.9623\\&amp; &amp;&amp; F^{\ast}=383.47;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`
]

---

layout: false
class: center, middle, duke-softblue,hide_logo
name: standard

# 5.3 标准化变量回归

---

layout: true
  
&lt;div class="my-header-h2"&gt;&lt;/div&gt;
&lt;div class="watermark1"&gt;&lt;/div&gt;
&lt;div class="watermark2"&gt;&lt;/div&gt;
&lt;div class="watermark3"&gt;&lt;/div&gt;

&lt;div class="my-footer"&gt;&lt;span&gt;huhuaping@   &lt;a href="#chapter05"&gt;第5章：一元回归：模型形式扩展&lt;/a&gt;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&lt;a href="#standard"&gt;5.3 标准化变量回归&lt;/a&gt; &lt;/span&gt;&lt;/div&gt; 

---

## 标准化变量回归

假设如下双变量回归：

`$$\begin {align} 
Y_{i}  &amp; =\hat{\beta}_{1} +\hat{\beta}_{2} X_{i}+\mathrm{e}_{i}
\end {align}$$`

对Y和X作如下标准化变换，得到相应的**标准化变量**：

`$$\begin {align} 
Y_{i}^* &amp; =\frac{Y_{i}-\overline{Y}}{S_{Y}}; \quad X_{i}^ *=\frac{X_{i}-\overline{X}}{S_{X}}
\end {align}$$`

- 标准化变量的特征是：其均值总是0 和标准差总是1。

---

## 标准化变量回归

得到如下新的双变量回归模型:

`$$\begin {align} 
Y_{i}^* &amp; =\hat{\beta}_{1}^{*}+\hat{\beta}_{2}^{*} X_{i}+e_{i}^{*} \\ 
&amp;=\hat{\beta}_{2}^{*} X_{i}+e_{i}^{*} 
\end {align}$$`

- 对标准化的回归子和回归元做回归，截距项总是零!

- 实际上变成了过原点回归模型!

---

## 标准化变量回归

模型比较与结论：

- 第一，由于标准化回归本质上是一个过原点回归，而我们在已经指出通常过原点回归的不能使用
`\(r^2\)`，所以我们就没有给出其
`\(r^2\)`值。

- 第二，传统模型的系数与这里的系数之间存在一种有趣的关系。在双变量情形中，这种关系如下（证明过程略：自学练习题！）：

`$$\begin {align} 
\hat{\beta}_{2}^{*}=\frac{\mathrm{S}_{X}}{\mathrm{S}_{\mathrm{Y}}} \hat{\beta}_{2}
\end {align}$$`

- 第三，在多元回归中，变量标准化可以去除多个自变量之间数量尺度(量纲)的差别，因而具有一定的优点！

---

### 标准化数据变换

下面我们对以十亿美元计的GPDIB和GDPB进行标准化数据变换：

<div id="htmlwidget-a098105533cab84904f6" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a098105533cab84904f6">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16"],["1990 ","1991 ","1992 ","1993 ","1994 ","1995 ","1996 ","1997 ","1998 ","1999  ","2000 ","2001 ","2002","2003","2004 ","2005 "],[886.6,829.1,878.3,953.5,1042.3,1109.6,1209.2,1320.6,1455,1576.3,1679,1629.4,1544.6,1596.9,1713.9,1842],[7112.5,7100.5,7336.6,7532.7,7835.5,8031.7,8328.9,8703.5,9066.9,9470.3,9817,9890.7,10048.8,10301,10703.5,11048.6],[-1.29421322424925,-1.46237119822207,-1.31848646223142,-1.09856507714001,-0.838870675595908,-0.642052733885118,-0.350773878099163,-0.0249860815674826,0.368064904553324,0.722805117473368,1.02314988142134,0.878095350829133,0.630098895300528,0.783049539453194,1.12521446040657,1.49984118155297],[-1.34591381872393,-1.35497190595521,-1.17675403967979,-1.02872979750864,-0.800164063039362,-0.652064336807947,-0.427725709713265,-0.144962419976832,0.129346655010407,0.433849354101909,0.695552591025618,0.751184343437725,0.870524642709828,1.06089544268721,1.36471878523637,1.62521427719591]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Year<\/th>\n      <th>GPDIB<\/th>\n      <th>GDPB<\/th>\n      <th>GPDIB_std<\/th>\n      <th>GDPB_std<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":8,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render"],"jsHooks":[]}</script>

---

### OLS比较

GPDI和GDP都以十亿美元计算：

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{GPDIB}=&amp;&amp;-926.09&amp;&amp;+0.25GDPB\\ &amp;\text{(t)}&amp;&amp;(-7.9590)&amp;&amp;(19.5824)\\&amp;\text{(se)}&amp;&amp;(116.3577)&amp;&amp;(0.0129)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9648;&amp;&amp; \bar{R^2}=0.9623\\&amp; &amp;&amp; F^{\ast}=383.47;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

标准化变量后的模型估计：

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{GPDIB_std}=&amp;&amp;+0.98GDPB_{std}\\ &amp;\text{(t)}&amp;&amp;(20.2697)\\&amp;\text{(se)}&amp;&amp;(0.0485)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9648;&amp;&amp; \bar{R^2}=0.9624\\&amp; &amp;&amp; F^{\ast}=410.86;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

---
layout: false
class: center, middle, duke-softblue,hide_logo

# 回归模型的函数形式

### 对数线性模型

### 半对数模型

### 倒数模型

---
layout: false
class: center, middle, duke-softblue,hide_logo
name:log-log

# 5.4 对数线性模型

---
layout: true
  
&lt;div class="my-header-h2"&gt;&lt;/div&gt;
&lt;div class="watermark1"&gt;&lt;/div&gt;
&lt;div class="watermark2"&gt;&lt;/div&gt;
&lt;div class="watermark3"&gt;&lt;/div&gt;

&lt;div class="my-footer"&gt;&lt;span&gt;huhuaping@   &lt;a href="#chapter05"&gt;第5章：一元回归：模型形式扩展&lt;/a&gt;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&lt;a href="#log-log"&gt;5.4 对数线性模型&lt;/a&gt; &lt;/span&gt;&lt;/div&gt; 

---

## 对数线性模型的形式

**指数回归模型**（exponential regression model）

`$$\begin {align} 
Y_{i}=\beta_{1} X_{i}^{\beta_{2}} e^{u_{i}}
\end {align}$$`

可化为：

`$$\begin {align} 
 \ln Y_{i} &amp;=\ln \beta_{1}+\beta_{2} \ln X_{i}+u_{i} \\ 
 \ln Y_{i} &amp;=\alpha+\beta_{2} \ln X_{i}+u_{i}  &amp;&amp; \Leftarrow \alpha=\ln \beta_{1}
\end {align}$$`

这种模型被称为对数-对数(log-log)，双对数(double-log)或对数一线性(log-linear)模型。进而有：

`$$\begin {align} 
Y_{i}^{*}&amp;=\alpha+\beta_{2} X_{i}^{*}+u_{i} &amp;&amp;\Leftarrow 
\left[ Y_{i}^{*}=\ln Y_{i} ; \quad  
X_{i}^{*}=\ln X_{i} \right]
\end {align}$$`
 
从而可用OLS方法可以得到BLUE估计量：

`$$\begin {align} 
Y_{i}^{*}=\hat{\alpha}+\hat{\beta}_{2} X_{i}^{*}+\mathrm{e}_{i}
\end {align}$$`

---

## 对数线性模型：学会如何测度弹性

双数线性模型：

`$$\begin {align} 
\ln Y_{i}&amp;=\alpha+\beta_{2} \ln X_{i}+u_{i} \\
Y_{i}^{*}&amp;=\hat{\alpha}+\hat{\beta}_{2} X_{i}^{*}+\mathrm{e}_{i}
&amp;&amp; \Leftarrow \hat{\alpha}=\ln \hat{\beta}_{1}
\end {align}$$`

`$$\begin {align} 
\beta_{2}=\frac{d(\ln Y)}{d(\ln X)}=\frac{\frac{1}{Y} d Y}{\frac{1}{X} d X}=\frac{d Y / Y}{d X / X}
\end {align}$$`

斜率就是Y对X的弹性！如果Y代表商品需求量Q，X代表商品价格P，则就表示该商品的需求价格弹性。

---

## 学会如何测度弹性

双数线性模型有如下性质：

- Y对X的弹性在整个研究范围内是常数，一直为
`\(\beta_2\)`，因此这种模型也称为不变弹性模型(constant elasticity model)。

- 虽然
`\(\hat{\alpha}\)`和
`\(\hat{\beta}_2\)`是无偏估计量，但是进入原始模型的参数
`\(\beta_1\)`的估计值
`\(\hat{\beta}_1\)`却是有偏估计，而且
`\(\beta_{1}=antilog\hat{\alpha}\)`。

&lt;img src="../pic/chpt5-elasticity.png" width="536" style="display: block; margin: auto;" /&gt;

---

### 耐用品消费案例



耐用品支出与个人消费总支出的关系：

<div id="htmlwidget-ef121e243ec80c7668bf" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-ef121e243ec80c7668bf">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"],["2003-I ","2003-II ","2003-III ","2003-IV","2004-I ","2004-II ","2004-III ","2004-IV","2005-I ","2005-II ","2005-III ","2005-IV  ","2006-I ","2006-II ","2006-III "],[971.4,1009.8,1049.6,1051.4,1067,1071.4,1093.9,1110.3,1116.8,1150.8,1175.9,1137.9,1190.5,1190.3,1208.8],[7184.9,7249.3,7352.9,7394.3,7479.8,7534.4,7607.1,7687.1,7739.4,7819.8,7895.3,7910.2,8003.8,8055,8111.2],[6.87873832991164,6.91750757042482,6.95616441818982,6.95787788838535,6.97260625130175,6.97672148344686,6.99750457112575,7.01238552806022,7.01822273200811,7.04821263167739,7.06978909082937,7.03693973736296,7.08212866592692,7.08196065517383,7.09738341095853],[8.87973688053179,8.88866019146317,8.90285007221254,8.90846471211142,8.91996133264314,8.92723447948929,8.93683730069767,8.94729887824071,8.95407944419915,8.96441425776473,8.97402292470118,8.97590834489212,8.98767170788518,8.99404829561107,9.00100110163837]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>obs<\/th>\n      <th>EXPDUR<\/th>\n      <th>PCEXP<\/th>\n      <th>ln_expdur<\/th>\n      <th>ln_pcexp<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"targets":5,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":5,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render"],"jsHooks":[]}</script>

其中：PCEXP=个人消费支出, EXPDUR=耐用品消费支出，单位10亿美元（按2000年价格计）

---

### 耐用品消费案例

假设我们想求出耐用品支出对个人消费总支出的**斜率**。

将耐用品支出相对于个人消费总支出做散点图：

&lt;img src="05-simple-reg-eq-forms-slide_files/figure-html/unnamed-chunk-18-1.png" style="display: block; margin: auto;" /&gt;

---

### 耐用品消费案例

假设我们想求出耐用品支出对个人消费总支出的**弹性**。

将耐用品支出的**对数**相对于个人消费总支出的**对数**做散点图：

&lt;img src="05-simple-reg-eq-forms-slide_files/figure-html/unnamed-chunk-19-1.png" style="display: block; margin: auto;" /&gt;



---

### 耐用品消费案例

耐用品消费案例中，我们可以实证得到如下的**双对数模型**：

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{log(EXPDUR)}=&amp;&amp;-7.54&amp;&amp;+1.63log(PCEXP)\\ &amp;\text{(t)}&amp;&amp;(-10.5309)&amp;&amp;(20.3152)\\&amp;\text{(se)}&amp;&amp;(0.7161)&amp;&amp;(0.0801)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9695;&amp;&amp; \bar{R^2}=0.9671\\&amp; &amp;&amp; F^{\ast}=412.71;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

---
layout: false
class: center, middle, duke-softblue,hide_logo
name: semi-log

# 5.5 半对数模型

---
layout: true
  
&lt;div class="my-header-h2"&gt;&lt;/div&gt;
&lt;div class="watermark1"&gt;&lt;/div&gt;
&lt;div class="watermark2"&gt;&lt;/div&gt;
&lt;div class="watermark3"&gt;&lt;/div&gt;

&lt;div class="my-footer"&gt;&lt;span&gt;huhuaping@   &lt;a href="#chapter05"&gt;第5章：一元回归：模型形式扩展&lt;/a&gt;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&lt;a href="#semi-log"&gt;5.5 半对数模型&lt;/a&gt; &lt;/span&gt;&lt;/div&gt; 

---

## 线性到对数模型

怎样测量增长率？经济学家、企业人员与政府常常对于求出某些经济变量的增长率感兴趣，如人口、GNP、货币供给、就业、生产力、贸易赤字等。

`$$\begin {align} 
Y_{t}=Y_{0}(1+r)^{t}
\end {align}$$`

`\(Y_t\)`＝时期t的劳务实际支出；
`\(Y_0\)`＝劳务实际支出的初始值(为2002年第四季度末的值)；r是Y的复合增长率。

<div id="htmlwidget-b90ce7fbac46f8d56421" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b90ce7fbac46f8d56421">{"x":{"filter":"none","vertical":false,"caption":"<caption>劳务支出数据<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15"],["2003-I ","2003-II ","2003-III ","2003-IV","2004-I ","2004-II ","2004-III ","2004-IV","2005-I ","2005-II ","2005-III ","2005-IV  ","2006-I ","2006-II ","2006-III "],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15],[4143.3,4161.3,4190.7,4220.2,4268.2,4308.4,4341.5,4377.4,4395.3,4420,4454.5,4476.7,4494.5,4535.4,4566.6],[8.32924785075199,8.33358280443735,8.34062306340162,8.34763779927196,8.35894747167987,8.36832188447661,8.3759751895007,8.38421021980998,8.38829106717538,8.39389497507174,8.4016701001607,8.40664144683783,8.41060970601345,8.41966856152619,8.4265242245014]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>obs<\/th>\n      <th>t<\/th>\n      <th>EXPSERVICES<\/th>\n      <th>ln_expservices<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":4,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[4,10,25,50,100]}},"evals":["options.columnDefs.0.render"],"jsHooks":[]}</script>

---

## 线性到对数模型

半对数模型(semilog models)：

- 线性到对数模型(log-lin model)：只有回归子Y取对数

- 对数到线性模型(lin-log model)：只有回归元X取对数


---

## 线性到对数模型

半对数模型的形式：

`$$\begin {align} 
Y_{t} &amp;=Y_{0}(1+r)^{t} \\ 
\ln Y_{t} &amp;=\ln Y_{0}+t \ln (1+r)  \\ 
\ln Y_{t} &amp;=\beta_{1}+\beta_{2} t &amp;&amp; \Leftarrow 
\left[ \beta_{1}=\ln Y_{0}; \quad  \beta_{2}=\ln (1+r) \right]\\ 
\ln Y_{t} &amp;=\beta_{1}+\beta_{2} t+u_{t}
\end {align}$$`

斜率
`\(\beta_2\)`的经济学含义：

`$$\begin {align} 
\beta_{2}=\frac{d \ln Y}{d t}=\frac{d Y / Y}{d t}
 \end {align}$$`
 
**恒定相对增长率模型**：上述模型描述了因变量Y的恒定相对增长率

- 恒定相对增长模型：
`\(\beta_2 &gt; 0\)`

- 恒定相对衰减模型：
`\(\beta_2 &lt; 0\)`


---

### 散点图1


&lt;img src="05-simple-reg-eq-forms-slide_files/figure-html/unnamed-chunk-22-1.png" style="display: block; margin: auto;" /&gt;

---

### 散点图2

&lt;img src="05-simple-reg-eq-forms-slide_files/figure-html/unnamed-chunk-23-1.png" style="display: block; margin: auto;" /&gt;


---

### OLS估计

半对数模型：线性到对数模型

`$$\begin {align} 
\ln Y_{t} &amp;=\beta_{1}+\beta_{2} t+u_{t} &amp;&amp; \Leftarrow 
\left[ \beta_{1}=\ln Y_{0}; \quad  \beta_{2}=\ln (1+r) \right]
\end {align}$$`

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{log(EXPSERVICES)}=&amp;&amp;+8.32&amp;&amp;+0.01t\\ &amp;\text{(t)}&amp;&amp;(5186.2999)&amp;&amp;(39.9648)\\&amp;\text{(se)}&amp;&amp;(0.0016)&amp;&amp;(0.0002)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9919;&amp;&amp; \bar{R^2}=0.9913\\&amp; &amp;&amp; F^{\ast}=1597.18;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

.pull-left[
`$$\begin {align} 
\begin{aligned} \hat{\beta}_{2} &amp;=\ln (1+r)=0.00705 \\ 
r &amp;=\operatorname{antilog}\left(\hat{\beta}_{2}\right)-1 \\ &amp;=\operatorname{antilog}(0.00705)-1 \\ &amp;=0.00708 \end{aligned}
\end {align}$$`
]

.pull-right[
- 
`\(\hat{\beta}_{2}=0.00705\)`表示**瞬时增长率**

- 
`\(r=0.00708\)`表示**复合增长率**
]

---

### 回归结果比较

下面做一个对比模型。线性趋势模型：Y直接对时间t回归：

`$$\begin {align} 
Y_{t}=\beta_{1}+\beta_{2} t+u_{t}
 \end {align}$$`

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{EXPSERVICES}=&amp;&amp;+4111.54&amp;&amp;+30.67t\\ &amp;\text{(t)}&amp;&amp;(655.5628)&amp;&amp;(44.4671)\\&amp;\text{(se)}&amp;&amp;(6.2718)&amp;&amp;(0.6898)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9935;&amp;&amp; \bar{R^2}=0.9930\\&amp; &amp;&amp; F^{\ast}=1977.32;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

**解释如下**：在2003年第1季度至2006年第3季度期间，劳务支出以每季度约300 亿美元的绝对速度(注意不是相对速度)增加，即劳务支出有上涨的趋势。


---

## 对数到线性模型(lin-log model)

如果我们的目的是测量X的一个百分比变化时，Y的绝对变化量，则要用**对数到线性模型**（lin-log model）。

`$$\begin {align} 
Y_{t}=\beta_{1}+\beta_{2} \ln X_{i}+u_{i}
\end {align}$$`


`$$\begin {align} 
\beta_2 &amp; =\frac{d Y}{d \ln X}=\frac{d Y}{d X / X}=\frac{\Delta \mathrm{Y}}{\Delta \mathrm{X} / X} \\
\Delta \mathrm{Y} &amp; =\beta_{2} \frac{\Delta \mathrm{X}}{\mathrm{X}}
\end {align}$$`

例如：恩格尔支出(Engel expenditure) 模型：

- “用于食物的总支出以算术级数增加，而总支出以几何级数增加。”

---

### 家庭食物支出案例



食物支出（`foodexp`）与家庭总支出（`totalexp`）的关系：

<div id="htmlwidget-a9a8b0cda378fc750d28" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-a9a8b0cda378fc750d28">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55],[217,196,303,270,325,260,300,325,336,345,325,362,315,355,325,370,390,420,410,383,315,267,420,300,410,220,403,350,390,385,470,322,540,433,295,340,500,450,415,540,360,450,395,430,332,397,446,480,352,410,380,610,530,360,305],[382,388,391,415,456,460,472,478,494,516,525,554,575,579,585,586,590,608,610,616,618,623,627,630,635,640,648,650,655,662,663,677,680,690,695,695,695,720,721,730,731,733,745,751,752,752,769,773,773,775,785,788,790,795,801],[5.94542060860658,5.96100533962327,5.96870755998537,6.0282785202307,6.12249280951439,6.13122648948314,6.15697898558556,6.16961073249146,6.20253551718792,6.24610676548156,6.26339826259162,6.31716468674728,6.35437004079735,6.361302477573,6.37161184723186,6.37331978957701,6.38012253689976,6.41017488196617,6.41345895716736,6.42324696353352,6.42648845745769,6.43454651878745,6.44094654063292,6.44571981938558,6.45362499889269,6.46146817635372,6.47389069635227,6.47697236288968,6.48463523563525,6.49526555593701,6.49677499018586,6.51767127291227,6.52209279817015,6.5366915975913,6.54391184556479,6.54391184556479,6.54391184556479,6.5792512120101,6.58063913728495,6.59304453414244,6.59441345974978,6.59714570188665,6.61338421837956,6.62140565176413,6.62273632394984,6.62273632394984,6.64509096950564,6.65027904858742,6.65027904858742,6.65286302935335,6.66568371778241,6.66949808985788,6.67203294546107,6.67834211465433,6.68586094706836]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>obs<\/th>\n      <th>foodexp<\/th>\n      <th>totalexp<\/th>\n      <th>ln_totalexp<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":5,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":["options.columnDefs.0.render"],"jsHooks":[]}</script>

---

### 家庭食物支出案例

原始数据作散点图：

&lt;img src="05-simple-reg-eq-forms-slide_files/figure-html/unnamed-chunk-28-1.png" style="display: block; margin: auto;" /&gt;

---

### 家庭食物支出案例

对家庭总支出取对数`ln(totalexp)`，再做散点图：

&lt;img src="05-simple-reg-eq-forms-slide_files/figure-html/unnamed-chunk-29-1.png" style="display: block; margin: auto;" /&gt;

---

### 家庭食物支出案例

.pull-left[
构建如下对数到线性模型：
`$$\begin {align} 
Y_{t}=\beta_{1}+\beta_{2} \ln X_{i}+u_{i}
\end {align}$$`

家庭食物支出案例的OLS估计结果如下：

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{foodexp}=&amp;&amp;-1283.91&amp;&amp;+257.27log(totalexp)\\ &amp;\text{(t)}&amp;&amp;(-4.3848)&amp;&amp;(5.6625)\\&amp;\text{(se)}&amp;&amp;(292.8105)&amp;&amp;(45.4341)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.3769;&amp;&amp; \bar{R^2}=0.3652\\&amp; &amp;&amp; F^{\ast}=32.06;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

]

.pull-right[
对比构建如下经典线性模型及其OLS估计结果：
`$$\begin {align} 
Y_{t}=\beta_{1}+\beta_{2} X_{i}+u_{i}
\end {align}$$`


`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{foodexp}=&amp;&amp;+94.21&amp;&amp;+0.44totalexp\\ &amp;\text{(t)}&amp;&amp;(1.8524)&amp;&amp;(5.5770)\\&amp;\text{(se)}&amp;&amp;(50.8563)&amp;&amp;(0.0783)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.3698;&amp;&amp; \bar{R^2}=0.3579\\&amp; &amp;&amp; F^{\ast}=31.10;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`
]

---
layout: false
class: center, middle, duke-softblue,hide_logo
name: reciprocal-mod

# 5.6 倒数模型

---
layout: true
  
&lt;div class="my-header-h2"&gt;&lt;/div&gt;
&lt;div class="watermark1"&gt;&lt;/div&gt;
&lt;div class="watermark2"&gt;&lt;/div&gt;
&lt;div class="watermark3"&gt;&lt;/div&gt;

&lt;div class="my-footer"&gt;&lt;span&gt;huhuaping@   &lt;a href="#chapter05"&gt;第5章：一元回归：模型形式扩展&lt;/a&gt;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&lt;a href="#reciprocal-mod"&gt;5.6 倒数模型&lt;/a&gt; &lt;/span&gt;&lt;/div&gt; 

---

## 倒数模型

.pull-left[
**形式**：

`$$\begin {align} 
Y_{i}=\beta_{1}+\beta_{2}\left(\frac{1}{X_{i}}\right)+u_{i}
 \end {align}$$`
 
**特征**：总有一条内在的渐近线！

- a.平均固定成本(AFC)曲线

- b.菲利普斯曲线（Phillips curve）

- c.恩格尔曲线（the Engel expenditure curve）

]

.pull-right[

&lt;img src="../pic/chpt4-reciprocal-model.png" width="567" style="display: block; margin: auto;" /&gt;



`$$\begin {align} 
X \rightarrow \infty ;
\quad \beta_{2}\left(\frac{1}{X}\right) \rightarrow 0 ;
\quad Y \rightarrow \beta_{1}
\end {align}$$`

]
 
---

### 儿童死亡率案例



儿童死亡率（`CM`，千分数）与人均GNP（`PGNP`，1980年的人均GNP）的关系：

<div id="htmlwidget-38af3248add32e4cafb2" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-38af3248add32e4cafb2">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,57,58,59,60,61,62,63,64],[128,204,202,197,96,209,170,240,241,55,75,129,24,165,94,96,148,98,161,118,269,189,126,12,167,135,107,72,128,27,152,224,142,104,287,41,312,77,142,262,215,246,191,182,37,103,67,143,83,223,240,312,12,52,79,61,168,28,121,115,186,47,178,142],[1870,130,310,570,2050,200,670,300,120,290,1180,900,1730,1150,1160,1270,580,660,420,1080,290,270,560,4240,240,430,3020,1420,420,19830,420,530,8640,350,230,1620,190,2090,900,230,140,330,1010,300,1730,780,1300,930,690,200,450,280,4430,270,1340,670,410,4370,1310,1470,300,3630,220,560],[0.00053475935828877,0.00769230769230769,0.0032258064516129,0.00175438596491228,0.00048780487804878,0.005,0.00149253731343284,0.00333333333333333,0.00833333333333333,0.00344827586206897,0.000847457627118644,0.00111111111111111,0.000578034682080925,0.000869565217391304,0.000862068965517241,0.00078740157480315,0.00172413793103448,0.00151515151515152,0.00238095238095238,0.000925925925925926,0.00344827586206897,0.0037037037037037,0.00178571428571429,0.000235849056603774,0.00416666666666667,0.00232558139534884,0.00033112582781457,0.000704225352112676,0.00238095238095238,5.04286434694907e-05,0.00238095238095238,0.00188679245283019,0.000115740740740741,0.00285714285714286,0.00434782608695652,0.000617283950617284,0.00526315789473684,0.000478468899521531,0.00111111111111111,0.00434782608695652,0.00714285714285714,0.00303030303030303,0.00099009900990099,0.00333333333333333,0.000578034682080925,0.00128205128205128,0.000769230769230769,0.0010752688172043,0.00144927536231884,0.005,0.00222222222222222,0.00357142857142857,0.000225733634311512,0.0037037037037037,0.000746268656716418,0.00149253731343284,0.0024390243902439,0.00022883295194508,0.000763358778625954,0.000680272108843537,0.00333333333333333,0.000275482093663912,0.00454545454545455,0.00178571428571429]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>obs<\/th>\n      <th>CM<\/th>\n      <th>PGNP<\/th>\n      <th>rep_PGNP<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":5,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":["options.columnDefs.0.render"],"jsHooks":[]}</script>

---

### 儿童死亡率案例

原始数据作散点图：

&lt;img src="05-simple-reg-eq-forms-slide_files/figure-html/unnamed-chunk-35-1.png" style="display: block; margin: auto;" /&gt;

---

### 儿童死亡率案例

把PGNP取倒数
`\(1/PGNP\)`再作散点图：

&lt;img src="05-simple-reg-eq-forms-slide_files/figure-html/unnamed-chunk-36-1.png" style="display: block; margin: auto;" /&gt;

---

### 儿童死亡率案例


.pull-left[
构建如下倒数模型：
`$$\begin {align} 
Y_{i}=\beta_{1}+\beta_{2}\left(\frac{1}{X_{i}}\right)+u_{i}
 \end {align}$$`

儿童死亡率案例倒数模型的OLS估计结果如下：

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{CM}=&amp;&amp;+81.79&amp;&amp;+27273.17rep_{PGNP}\\ &amp;\text{(t)}&amp;&amp;(7.5511)&amp;&amp;(7.2535)\\&amp;\text{(se)}&amp;&amp;(10.8321)&amp;&amp;(3759.9992)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.4591;&amp;&amp; \bar{R^2}=0.4503\\&amp; &amp;&amp; F^{\ast}=52.61;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

]

.pull-right[
对比构建如下经典线性模型：
`$$\begin {align} 
Y_{t}=\beta_{1}+\beta_{2} X_{i}+u_{i}
\end {align}$$`

其OLS估计结果如下：

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{CM}=&amp;&amp;+157.42&amp;&amp;-0.01PGNP\\ &amp;\text{(t)}&amp;&amp;(15.9893)&amp;&amp;(-3.5157)\\&amp;\text{(se)}&amp;&amp;(9.8456)&amp;&amp;(0.0032)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.1662;&amp;&amp; \bar{R^2}=0.1528\\&amp; &amp;&amp; F^{\ast}=12.36;&amp;&amp; p=0.0008 \end{alignedat} \end{equation}$$`
]


---

### 菲利普斯曲线



通货膨胀率（`infrate`，%）与失业率（`unrate`，%）的关系：

<div id="htmlwidget-7cfb44f1edbafad80213" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-7cfb44f1edbafad80213">{"x":{"filter":"none","vertical":false,"data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47"],["1960 ","1961 ","1962 ","1963 ","1964 ","1965 ","1966 ","1967 ","1968 ","1969 ","1970 ","1971 ","1972 ","1973 ","1974 ","1975 ","1976 ","1977 ","1978 ","1979 ","1980 ","1981 ","1982 ","1983 ","1984 ","1985 ","1986 ","1987 ","1988 ","1989 ","1990 ","1991 ","1992 ","1993 ","1994 ","1995 ","1996 ","1997 ","1998 ","1999 ","2000 ","2001 ","2002 ","2003 ","2004","2005","2006"],[1.71821305841924,1.0135135135135,1.00334448160535,1.32450331125829,1.30718954248366,1.61290322580645,2.85714285714285,3.08641975308642,4.19161676646706,5.45977011494255,5.72207084468663,4.38144329896908,3.20987654320987,6.22009569377991,11.036036036036,9.12778904665314,5.76208178438662,6.50263620386644,7.59075907590759,11.3496932515337,13.4986225895317,10.3155339805825,6.16061606160615,3.21243523316062,4.31726907630523,3.56111645813281,1.85873605947955,3.64963503649635,4.13732394366197,4.81825866441251,5.4032258064516,4.20811017597552,3.01027900146845,2.99358517462579,2.56055363321799,2.834008097166,2.95275590551181,2.2944550669216,1.55763239875389,2.20858895705521,3.36134453781512,2.84552845528456,1.5810276679842,2.27904391328516,2.66304347826087,3.38803599788248,3.22580645161289],[5.5,6.7,5.5,5.7,5.2,4.5,3.8,3.8,3.6,3.5,4.9,5.9,5.6,4.9,5.6,8.5,7.7,7.1,6.1,5.8,7.1,7.6,9.7,9.6,7.5,7.2,7,6.2,5.5,5.3,5.6,6.8,7.5,6.9,6.1,5.6,5.4,4.9,4.5,4.2,4,4.7,5.8,6,5.5,5.1,4.6],[0.181818181818182,0.149253731343284,0.181818181818182,0.175438596491228,0.192307692307692,0.222222222222222,0.263157894736842,0.263157894736842,0.277777777777778,0.285714285714286,0.204081632653061,0.169491525423729,0.178571428571429,0.204081632653061,0.178571428571429,0.117647058823529,0.12987012987013,0.140845070422535,0.163934426229508,0.172413793103448,0.140845070422535,0.131578947368421,0.103092783505155,0.104166666666667,0.133333333333333,0.138888888888889,0.142857142857143,0.161290322580645,0.181818181818182,0.188679245283019,0.178571428571429,0.147058823529412,0.133333333333333,0.144927536231884,0.163934426229508,0.178571428571429,0.185185185185185,0.204081632653061,0.222222222222222,0.238095238095238,0.25,0.212765957446809,0.172413793103448,0.166666666666667,0.181818181818182,0.196078431372549,0.217391304347826]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>year<\/th>\n      <th>infrate<\/th>\n      <th>unrate<\/th>\n      <th>rep_unrate<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"targets":2,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"targets":4,"render":"function(data, type, row, meta) {\n    return type !== 'display' ? data : DTWidget.formatRound(data, 4, 3, \",\", \".\", null);\n  }"},{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":5,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[5,10,25,50,100]}},"evals":["options.columnDefs.0.render","options.columnDefs.1.render"],"jsHooks":[]}</script>

---

### 菲利普斯曲线

原始数据作散点图：

&lt;img src="05-simple-reg-eq-forms-slide_files/figure-html/unnamed-chunk-41-1.png" style="display: block; margin: auto;" /&gt;

---

### 菲利普斯曲线

把失业率`unrate`取倒数
`\(1/unrate\)`再作散点图：

&lt;img src="05-simple-reg-eq-forms-slide_files/figure-html/unnamed-chunk-42-1.png" style="display: block; margin: auto;" /&gt;

---

### 菲利普斯曲线

.pull-left[
构建如下倒数模型：
`$$\begin {align} 
Y_{i}=\beta_{1}+\beta_{2}\left(\frac{1}{X_{i}}\right)+u_{i}
 \end {align}$$`

菲利普斯曲线案例倒数模型的OLS估计结果如下：

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{infrate}=&amp;&amp;+7.37&amp;&amp;-17.37rep_{unrate}\\ &amp;\text{(t)}&amp;&amp;(4.1723)&amp;&amp;(-1.8212)\\&amp;\text{(se)}&amp;&amp;(1.7670)&amp;&amp;(9.5364)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.0686;&amp;&amp; \bar{R^2}=0.0479\\&amp; &amp;&amp; F^{\ast}=3.32;&amp;&amp; p=0.0752 \end{alignedat} \end{equation}$$`

]

.pull-right[
对比构建如下经典线性模型及其OLS估计结果：
`$$\begin {align} 
Y_{t}=\beta_{1}+\beta_{2} X_{i}+u_{i}
\end {align}$$`


`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{infrate}=&amp;&amp;+0.81&amp;&amp;+0.59unrate\\ &amp;\text{(t)}&amp;&amp;(0.4642)&amp;&amp;(2.0377)\\&amp;\text{(se)}&amp;&amp;(1.7347)&amp;&amp;(0.2874)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.0845;&amp;&amp; \bar{R^2}=0.0641\\&amp; &amp;&amp; F^{\ast}=4.15;&amp;&amp; p=0.0475 \end{alignedat} \end{equation}$$`
]

---
layout: false
class: center, middle, duke-softblue,hide_logo
name: options

# 5.7 函数形式的选择 

---
layout: true
  
&lt;div class="my-header-h2"&gt;&lt;/div&gt;
&lt;div class="watermark1"&gt;&lt;/div&gt;
&lt;div class="watermark2"&gt;&lt;/div&gt;
&lt;div class="watermark3"&gt;&lt;/div&gt;

&lt;div class="my-footer"&gt;&lt;span&gt;huhuaping@   &lt;a href="#chapter05"&gt;第5章：一元回归：模型形式扩展&lt;/a&gt;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&lt;a href="#options"&gt;5.7 函数形式的选择 &lt;/a&gt;&lt;/span&gt;&lt;/div&gt; 

---

## 技巧和经验

选择适当模型时，需要一些技巧和经验：

1. 模型背后的理论(如菲利普斯曲线〉可能给出了一个特定的函数形式。

2. 最好能求出回归子相对回归元的变化率〈即斜率〉和回归子对回归元的弹性(见下页ppt)。

3. 所选模型的系数应该满足一定的先验预期。

4. 有时多个模型都能相当不错地拟合一个给定的数据集。

5. 通常不应该过分强调这个指标

6. 在有些情形中，确定一个特定的函数形式不是那么容易，此时我们或许可以使用所谓的博克斯-考克斯变换(Box-Cox transformations)

---

## 计算表一览

&lt;table class="table" style="margin-left: auto; margin-right: auto;"&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:center;"&gt; 模型 &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; 方程 &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; 斜率 &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; 点弹性 &lt;/th&gt;
   &lt;th style="text-align:center;"&gt; 平均弹性 &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; models &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; eq &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{dY}{dX}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{dY}{dX}\cdot\frac{X_i}{Y_i}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\frac{dY}{dX}\cdot\frac{\bar{X}}{\bar{Y}}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; \(M_1\)线性模型 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(Y_i=\beta_1+\beta_2X_i+u_i\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\beta_2\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\beta_2{X_i}/{Y_i}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\beta_2{\bar{X}}/{\bar{Y}}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; \(M_2\)过原点模型 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(Y_i=\beta_2X_i+u_i\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\beta_2\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\beta_2{X_i}/{Y_i}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\beta_2{\bar{X}}/{\bar{Y}}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; \(M_3\)双对数模型 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(ln(Y_i)=\beta_1+\beta_2ln(X_i)+u_i\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\beta_2Y_i/X_i\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\beta_2\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\beta_2\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; \(M_4\)线性到对数模型 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(ln(Y_i)=\beta_1+\beta_2X_i+u_i\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\beta_2Y_i\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\beta_2{X_i}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\beta_2{\bar{X}}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; \(M_5\)对数到线性模型 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(Y_i=\beta_1+\beta_2ln(X_i)+u_i\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\beta_2/X_i\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\beta_2/{Y_i}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\beta_2/{\bar{Y}}\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; \(M_6\)倒数模型 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(Y_i=\beta_1+\beta_2/X_i+u_i\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(-\beta_2/X_i^2\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(-\beta_2/({X_i}{Y_i})\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(-\beta_2/({\bar{X}}{\bar{Y}})\) &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:center;"&gt; \(M_7\)对数倒数模型 &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(ln(Y_i)=\beta_1-\beta_2/X_i+u_i\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\beta_2Y_i/X_i^2\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\beta_2/{X_i}\) &lt;/td&gt;
   &lt;td style="text-align:center;"&gt; \(\beta_2/{\bar{X}}\) &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;



---

layout:false
background-image: url("../pic/thank-you-gif-funny-little-yellow.gif")
class: inverse,center
# 本章结束


    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
