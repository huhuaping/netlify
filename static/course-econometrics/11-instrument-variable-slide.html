<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>11-instrument-variable-slide.utf8.md</title>
    <meta charset="utf-8" />
    <link href="libs/remark-css-0.0.1/default.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/default-fonts.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/duke-blue.css" rel="stylesheet" />
    <link href="libs/remark-css-0.0.1/hygge-duke.css" rel="stylesheet" />
    <script src="libs/htmlwidgets-1.5.1/htmlwidgets.js"></script>
    <script src="libs/jquery-1.12.4/jquery.min.js"></script>
    <link href="libs/datatables-css-0.0.0/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding-0.8/datatables.js"></script>
    <link href="libs/dt-core-1.10.16/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core-1.10.16/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core-1.10.16/js/jquery.dataTables.min.js"></script>
    <link href="libs/crosstalk-1.0.0/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk-1.0.0/js/crosstalk.min.js"></script>
    <link rel="stylesheet" href="libs\cc-fonts.css" type="text/css" />
    <link rel="stylesheet" href="libs\figure-captions.css" type="text/css" />
    <link rel="stylesheet" href="libs\animate.css" type="text/css" />
    <link rel="stylesheet" href="libs\mycss\my-custom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

background-image: url("pic/slide-front-page.jpg")
class: center,middle

# 计量经济学(Econometrics)

### 胡华平

### 西北农林科技大学

### 经济管理学院数量经济教研室

### huhuaping01@hotmail.com

### 2020-03-14










---
class: center, middle,inverse
# 第11章：内生自变量问题

.red[
11.1 简单回归模型中的遗漏变量

11.2 内生变量法下的估计问题

11.3 多元回归模型的IV估计

11.4 工具变量法的一些讨论

11.5 解释变量的内生性检验（豪斯曼检验）

11.6 工具变量的外生性检验
]

---
layout: false
class: inverse, center, middle, duke-softblue

# 11.1 简单回归模型中的遗漏变量

---
layout: true
  
&lt;div class="my-header"&gt;&lt;/div&gt;

&lt;div class="my-footer"&gt;&lt;span&gt;huhuaping@   第11章：内生自变量问题   
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
11.1 简单回归模型中的遗漏变量 &lt;/span&gt;&lt;/div&gt; 

---

## 一个简单示例

假定工资水平的**“真实模型”**为：

`$$\begin {align} 
\log (wage_i)=\beta_{0}+\beta_{1} educ_i+\beta_{2} abil_i+u_i
\end {align}$$`

--

然而，因为能力变量（
`\(abil_i\)`）无法观测得到，所以我们经常用智商水平变量（
`\(IQ_i\)`）来替换，并构建如下**“代理变量模型”**：

`$$\begin {align} 
\log (wage_i)=\beta_{0}+\beta_{1} educ_i+\beta_{2} IQ_i+u_i^{\ast}
\end {align}$$`

--

进一步地，如果拿不到智力水平（
`\(IQ_i\)`）数据，我们很可能构建出如下**遗漏重要变量**的**“偏误模型”**：

`$$\begin {align} 
\log (wage_i)=\beta_{0}+\beta_{1} educ_i+v_i
\end {align}$$`

--

- 此时，我们可以认为重要变量
`\(abil_i\)`被遗漏，从而进入到随机干扰项
`\(v_i\)`中。

--

- 又因为，一般情况下我们认为教育水平（
`\(educ_i\)`）与能力（
`\(abil_i\)`）是相关的，从而可以认为
自变量
`\(educ_i\)`与随机干扰项
`\(v_i\)`是相关的。而这是违背CLRM假设的（违背了哪一条？）。

---

## 知识回顾

对于总体回归模型：

`$$\begin{align}
Y_i &amp;=  \beta_1 +\beta_2X_i + u_i &amp;&amp; \text{(PRM)}
\end{align}$$`

- 在CLRM假设下：**CLRM假设3**——X是固定的（给定的）或独立于误差项。也即自变量X**不是**随机变量。此时，我们可以使用OLS方法，并得到**BLUE**。

`$$\begin{align}
Cov(X_i, u_i)= 0\\ 
E(X_i u_i)= 0
\end{align}$$`

--

- 如果违背上述假设，也即自变量X与随机干扰项相关。此时使用OLS估计将不再能得到**BLUE**，而应该采用**工具变量法**（IV）进行估计。

`$$\begin{align}
Cov(X_i, u_i)= 0\\ 
E(X_i u_i)= 0
\end{align}$$`

--

事实上，无论
`\(X_i\)`与
`\(u_i\)`是否相关，我们都可以采用**IV法**得到**BLUE**。

---

## 代理变量


**代理变量**（proxy variable）：一般因为某些原因，某个变量
`\(X_i\)`不能直接观测得到（数据不可得），那么常常会找一个能够观测到到的、并与
`\(X_i\)`高度相关的变量
`\(D_i\)`作为替代。

--

- 假定工资水平的**“真实模型”**为：

`$$\begin {align} 
\log (wage_i)=\beta_{0}+\beta_{1} educ_i+\beta_{2} abil_i+u_i
\end {align}$$`

--

- 然而，因为能力变量（
`\(abil_i\)`）无法观测得到，所以我们经常用智商水平变量（
`\(IQ_i\)`）来替换，并构建如下**“代理变量模型”**：

`$$\begin {align} 
\log (wage_i)=\beta_{0}+\beta_{1} educ_i+\beta_{2} IQ_i+u_i^{\ast}
\end {align}$$`

此时，智力水平
`\(IQ_i\)`就可以认为是变量
能力
`\(abil_i\)`的**代理变量**。

---

## 工具变量


**代理变量**（proxy variable）：一般因为某些原因，某个变量
`\(X_i\)`不能直接观测得到（数据不可得），那么常常会找一个能够观测到到的、并与
`\(X_i\)`高度相关的变量
`\(D_i\)`作为替代。

**工具变量**（instrument variable）：一般记为
`\(Z_i\)`，是指一个具备如下**两个性质**的可观测的变量：

`$$\begin{align}
Y_i &amp;=  \beta_1 +\beta_2X_i + u_i &amp;&amp; \text{(PRM)}
\end{align}$$`

`$$\begin{align}
Cov(Z_i, u_i) &amp; = 0 &amp;&amp; \text{(instrumental exogeneity)}\\ 
Cov(Z_i, X_i) &amp; \neq 0 &amp;&amp; \text{(instrumental relevance)}
\end{align}$$`

- 工具外生性（instrumental exogeneity）：工具变量对于总体回归模型是外生的。


- 工具相关性（instrumental relevance）：工具变量对于解释
`\(X_i\)`的变异时有很重要的作用。

**思考**： 我们很容易就能检验出模型是不是具有工具外生性或工具相关性么？为什么？

???

从遗漏变量角度来看，工具变量
`\(Z_i\)`对
`\(Y_i\)`没有多余的影响，并且
`\(Z_i\)`与遗漏变量也不相关。

`$$\begin{align}
X_i &amp;=  \pi_1 +\pi_2Z_i + v_i \\
\pi_2 &amp; = \frac{cov(X_i,Z_i)}{var(Z_i)}
\end{align}$$`

---

## 对示例的进一步扩展

对于**“真实模型”**：

`$$\begin {align} 
\log (wage_i)=\beta_{0}+\beta_{1} educ_i+\beta_{2} abil_i+u_i
\end {align}$$`

我们很可能构建出如下**遗漏重要变量**的**“偏误模型”**：

`$$\begin {align} 
\log (wage_i)=\beta_{0}+\beta_{1} educ_i+v_i
\end {align}$$`

因此，对于教育
`\(edu_i\)`的工具变量
`\(Z_i\)`而言：

- 工具变量
`\(Z_i\)`必须与能力
`\(abil_i\)`不相关，但又必须与教育
`\(edu_i\)`相关。

--

- 选择方案1：家庭背景教育如母亲的教育
`\(MotherEdu_i\)`就可能是工具变量备选方案之一。因为我们通常可以认为**母亲教育水平**与孩子教育是正相关的。

--

- 选择方案2：另一个工具变量的备选方案是家庭中**兄弟姐妹的数量**
`\(sibs\)`。因为我们通常可以认为家庭中兄弟姐妹数量会导致较低的平均教育水平（也即负相关）。

**提问**：哪一个方案更好呢？为什么？

???

对于能力
`\(abil_i\)`的工具变量
`\(Z_i\)`：

- 工具变量
`\(Z_i\)`必须与教育
`\(edu_i\)`不相关，但又必须与能力
`\(abil_i\)`相关。

- 智商水平
`\(IQ_i\)`就是一个符合以上条件的、较理想的工具变量。

---
class: middle, center, duke-orange

## 学习成绩与逃课次数的例子

---

## 模型设定

假设**“真实模型”**是：

`$$\begin {align} 
score_i=\alpha_{1}+\alpha_{2}skipped_i+ \alpha_3 abil_i + \alpha_4 mot_i + \alpha_5 income_i +u_i
\end {align}$$`

一个遗漏了重要变量的**“偏误模型”**是：

`$$\begin {align} 
score_i=\beta_{1}+\beta_{2}skipped_i+v_i
\end {align}$$`


- 学习成绩受到逃课次数的影响，但是我们也很担心以上模型中
`\(skipped_i\)`与
`\(v_i\)`中的某些因素相关，例如越有能力
`\(abil_i\)`、越积极
`\(mot_i\)`的学生，逃课也越少。

- 因为自变量
`\(skipped_i\)`可能与随机干扰项
`\(v_i\)`相关。此时，对于以上简单的回归，可能得不出可靠的估计。

---

## 模型设定

`$$\begin {align} 
score_i=\beta_{1}+\beta_{2}skipped_i+v_i
\end {align}$$`

逃课次数
`\(skipped_i\)`的工具变量
`\(Z_i\)`有哪些可供备选的呢？

--

- 宿舍跟上课地点的距离
`\(distance\)`。我们一般认为，它与逃课次数相关
`\(skipped_i\)`，但是它与
`\(v_i\)`中的某些因素也会相关么？

--

- 如果收入水平
`\(income\)`确实影响了学习成绩，但是模型却没有引入收入水平
`\(income\)`变量，也就意味着
`\(v_i\)`中包含了遗漏的重要变量——收入水平
`\(income\)`。此时，距离
`\(distance\)`就会与收入水平
`\(income\)`相关，进而与
`\(v_i\)`相关。——因为收入少的学生，更倾向于在外租房（合租）；收入多的学生，更倾向于住校。

???

- 此外，如果能找到能力
`\(abil_i\)`的一个合适的工具变量
`\(Z_{2i}\)`，那么也可以减弱我们对一元回归模型估计问题的担忧。例如，累计学积分
`\(GPA\)`。


---
layout:false
class: middle, center, inverse

# 11.2 内生变量法下的估计问题

---
layout: true
  
&lt;div class="my-header"&gt;&lt;/div&gt;

&lt;div class="my-footer"&gt;&lt;span&gt;huhuaping@   第11章：内生自变量问题   
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
11.2 内生变量法下的估计问题 &lt;/span&gt;&lt;/div&gt; 

---
class: page-font-21
## 工具变量法下系数的估计过程

把上述**“偏误模型”**记为：

`$$\begin {align} 
score_i &amp; =\beta_{1}+\beta_{2}skipped_i+u_i \\
Y_i &amp; = \beta_{1}+\beta_{2}X_i+u_i
\end {align}$$`

假设我们找到了理想的工具变量
`\(Z_i\)`，并构建如下的**工具变量模型**：

`$$\begin {align} 
Y_i &amp; = \alpha_{1}+\alpha_{2}Z_i+v_i
\end {align}$$`

`$$\begin {align} 
cov(Z_i, Y_i) &amp; = \alpha_{2}cov(Z_i,X_i)+ cov(Z_i,u_i)  &amp;&amp; \leftarrow [cov(Z_i,u_i)=0] \\
\alpha_2|_{IV}^{plim} &amp; = \frac{cov(Z_i, Y_i)}{cov(Z_i, X_i)} \\
&amp; = \frac{\sum{z_iy_i}}{\sum{z_ix_i}} &amp;&amp; \leftarrow [if \quad X_i=Z_i] \\
&amp; = \frac{\sum{x_iy_i}}{\sum{x_i^2}} =\beta_2
\end {align}$$`

这将意味着工具变量法IV会得到最小二乘法OLS下的估计结果。

---

## 工具变量法下系数的真实方差

.pull-left[

对于**“偏误模型”**和**工具变量模型**：

`$$\begin{align}
Y_i &amp;=  \beta_1 +\beta_2X_i + u_i &amp;&amp; \text{(PRM)} \\
Y_i &amp;=  \alpha_1 +\alpha_2Z_i + v_i &amp;&amp; \text{(IV)}
\end{align}$$`

如果如下三个条件成立：

`$$\begin{align}
Cov(Z_i, u_i) &amp; = 0 \\ 
Cov(Z_i, X_i) &amp; \neq 0 \\
E(v_i^2|Z_i) &amp; \equiv \sigma^2 \equiv var(u_i)
\end{align}$$`

]

--

.pull-right[

可以证明斜率系数
`\(\alpha_2\)`的渐近方差为：

`$$\begin{align}
var(\alpha_2) \simeq \frac{\sigma^2}{n \sigma^2_{X_i} \rho^2_{(X_i,Z_i)}} 
\end{align}$$`


其中：

- `\(\sigma^2\)`是
`\(v_i\)`的**总体方差**，也即
`\(var(v_i) \equiv \sigma^2\)`。

- `\(\sigma^2_{X_i}\)`是
`\(X_i\)`的**总体方差**，也即
`\(var(X_i) \equiv \sigma^2_{X_i}\)`。

- `\(\rho^2_{(X_i,Z_i)}\)`是
`\(X_i\)`和
`\(Z_i\)`的**总体相关系数**的平方，也即
`\(\rho^2_{(X_i,Z_i)} \equiv \frac{[cov(X_i,Z_i)]^2}{var(X_i)var(Z_i)}\)`；
]

---

## 工具变量法下系数的样本方差

对于给定的样本数据，我们可以计算出

`$$\begin{align}
var(\alpha_2) \simeq \frac{\sigma^2}{n \sigma^2_{X_i} \rho^2_{(X_i,Z_i)}}  
\simeq \frac{\hat{\sigma}^2}{n S^2_{X_i} R^2_{(X_i,Z_i)}} 
\end{align}$$`

其中：

- `\(\sigma^2_{X_i} \simeq S^2_{X_i}=\frac{\sum{(X_i-\bar{X})^2}}{n-1}\)`。

- `\(\rho^2_{(X_i,Z_i)}\simeq R^2\)`，其中
`\(R^2\)`为通过做
`\(X_i\)`对
`\(Z_i\)`的回归来获得的**判定系数**。

`$$\begin{align}
X_i = \hat{\pi}_1 +\hat{\pi}_2 Z_i + \epsilon_i 
\end{align}$$`

- `\(\hat{\sigma}^2 = \frac{\sum{e_i^2}}{n-2}\)`，是来自对**工具变量回归**的残差计算。

`$$\begin{align}
Y_i = \hat{\alpha}_1 +\hat{\alpha}_2 Z_i + e_i 
\end{align}$$`

---
class: middle, center, duke-orange

## 已婚女性的教育回报案例




---

## 变量说明

研究者关注428名已婚女性**时均工资**
`\(wage\)`与其**受教育年数**
`\(educ\)`之间的关系，并考虑如下变量：

<div id="htmlwidget-d2720b5693d1d3ff597e" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d2720b5693d1d3ff597e">{"x":{"filter":"none","caption":"<caption>变量说明<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22"],["wage","educ","exper","fatheduc","motheduc","inlf","hours","kidslt6","kidsge6","age","repwage","hushrs","husage","huseduc","huswage","faminc","mtr","unem","city","nwifeinc","lwage","expersq"],[["时均工资"],["受教育年数"],["就业次数"],["父亲的受教育年数"],["母亲的受教育年数"],["是否是劳动力"],["工作时长"],["六岁以下孩子数"],["6-18岁孩子数"],["年龄"],["回访年的时均工资"],["丈夫工作时长"],["丈夫年龄"],["丈夫的受教育年数"],["丈夫的时均工资"],["家庭收入"],["征收税率"],["所在地区失业率"],["居住地是否为SMSA"],["扣除妇女工资的家庭收入/1000"],["工资的对数"],["就业次数的平方"]]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>vars<\/th>\n      <th>mark<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":6,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[6,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---

## 原始数据


<div id="htmlwidget-d7c5613a96a870003e1d" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-d7c5613a96a870003e1d">{"x":{"filter":"none","caption":"<caption>已婚女性的教育回报数据n=(428)<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428"],[3.35400009155273,1.3889000415802,4.54549980163574,1.09650003910065,4.59180021286011,4.74209976196289,8.33329963684082,7.84310007095337,2.12619996070862,4.6875,4.06300020217896,4.59180021286011,2.08330011367798,2.26679992675781,3.67969989776611,1.34720003604889,3.21429991722107,5.17500019073486,2,7.5528998374939,3.50519990921021,3.57139992713928,3.25,3.25,2.15450000762939,3.7878999710083,4,4.72690010070801,7.25589990615845,5.86709976196289,1.53849995136261,2.45900011062622,5.85109996795654,3.57139992713928,3.80679988861084,2.46379995346069,2.37529993057251,4.53509998321533,5.61829996109009,14.6309995651245,2.67860007286072,3.91939997673035,2.57290005683899,4.53749990463257,2,3.4721999168396,2.01609992980957,4.57159996032715,2.27270007133484,2.63750004768372,2.28990006446838,1.09889996051788,1.1764999628067,1.60000002384186,1.87619996070862,4.04370021820068,9.63539981842041,8.04090023040771,4.59899997711182,2.14289999008179,4.40000009536743,3.53539991378784,2.71740007400513,6.25,11.9329996109009,3.59310007095337,6.9443998336792,2.91669988632202,3.07690000534058,3.75,5.72590017318726,3.67569994926453,5.16480016708374,8.22369956970215,4.33650016784668,4.98190021514893,0.357100009918213,2.96740007400513,1,2.55539989471436,0.860199987888336,1,2.92610001564026,3.54609990119934,1.62639999389648,8.33329963684082,3.0952000617981,2.70000004768372,5.25209999084473,1.41540002822876,4.79860019683838,1.66670000553131,1.12170004844666,0.5,0.714299976825714,2.79609990119934,4.85830020904541,1.74349999427795,2.46309995651245,2.42129993438721,1.53450000286102,2.88179993629456,2.40689992904663,5.23260021209717,3.75,1.3889000415802,4,3.23130011558533,3.40140008926392,1.33329999446869,9.30230045318604,4.5,4.62349987030029,3.9556999206543,5.81400012969971,0.5,4.08160018920898,6,3.66669988632202,3.86129999160767,2.76290011405945,2.93099999427795,4.38840007781982,5.41669988632202,9.86110019683838,0.16159999370575,0.382600009441376,3.63639998435974,2.37470006942749,4.66669988632202,1.85189998149872,5.19999980926514,3.2985999584198,8.53330039978027,2.06349992752075,2.56410002708435,2.1875,6.25,3.33330011367798,4.4443998336792,6.63350009918213,8.42240047454834,4.39559984207153,2.44569993019104,1.22449994087219,1.625,3,4.72690010070801,1.12929999828339,7.40240001678467,4.45949983596802,2.47250008583069,1.88240003585815,4,8.1899995803833,7.09679985046387,1.66670000553131,3.4449999332428,4.23470020294189,2.7778000831604,1.88919997215271,5.03520011901855,1.25,2.85710000991821,4.11670017242432,1.77779996395111,13.5539999008179,4.56269979476929,2.12770009040833,2.98909997940063,2.56539988517761,5.6121997833252,2.80539989471436,1.60699999332428,2.25,2.03250002861023,5.53200006484985,1.58449995517731,3.7878999710083,3,8.65380001068115,4.21049976348877,4.6875,4.0984001159668,25,2.6331000328064,6,5.41260004043579,0.664200007915497,1.25,2.27539992332458,3.4614999294281,4.16669988632202,4.46869993209839,1.75,3.66939997673035,6.58260011672974,2.59999990463257,4.86509990692139,5.78700017929077,4.54080009460449,9.50570011138916,10.6379995346069,1.1110999584198,4.05410003662109,2.68709993362427,2.97620010375977,3.17280006408691,3.54999995231628,17.9069995880127,3.41739988327026,3.33330011367798,3.88599991798401,2.31110000610352,1.71080005168915,2.1143000125885,9.9330997467041,3.02769994735718,1.86049997806549,0.128199994564056,6.63269996643066,5.63910007476807,1.59899997711182,2.66669988632202,7.92080020904541,5.33979988098145,4,6.04489994049072,6.25,2.97620010375977,4.23390007019043,3.49160003662109,4.96449995040894,2.76920008659363,3.65849995613098,5.39349985122681,0.6564000248909,4.76879978179932,8.555100440979,10.4589996337891,2.63750004768372,6.84929990768433,5.08720016479492,0.961499989032745,4.30660009384155,7.06669998168945,2.52530002593994,7.894700050354,4.14890003204346,8.17459964752197,9.59710025787354,2.01640009880066,7.6217999458313,3.19749999046326,1.60000002384186,4.0984001159668,1.4815000295639,3.63639998435974,1,2.60419988632202,1.75,4.80000019073486,5.53000020980835,4.0984001159668,1.25,1.66670000553131,3.79010009765625,2.36360001564026,10.2040004730225,6.81820011138916,7.21460008621216,2.44840002059937,1.19869995117188,1.64100003242493,1.7820999622345,2.94120001792908,4.96890020370483,1.86049997806549,8.03569984436035,3.97160005569458,3.04159998893738,2.90700006484985,3.06119990348816,4.89659976959229,4.01609992980957,5.5556001663208,1.22269999980927,2.68390011787415,2.67379999160767,9.32940006256104,3.13809990882874,0.542599976062775,8.61110019683838,3.6686999797821,2.31850004196167,2.88199996948242,3.16659998893738,3.64580011367798,6.25,10.2489995956421,3.20959997177124,7.65220022201538,1.97239995002747,4.69799995422363,2.12339997291565,2.33330011367798,2.38960003852844,1.25639998912811,1.09379994869232,3.75,3.30719995498657,5.13520002365112,6.63269996643066,4.5644998550415,11.8479995727539,3.75,4.36509990692139,3.93330001831055,3.33330011367798,3.31590008735657,3.56159996986389,1.60000002384186,2.22550010681152,4.78719997406006,5.80649995803833,2.3585000038147,2,1.89999997615814,5.1230001449585,5.49450016021729,6.32180023193359,7.14289999008179,2.375,2.54290008544922,2.17980003356934,2.59999990463257,3.72939991950989,4.375,4.44329977035522,4.28770017623901,1.66670000553131,3.2558000087738,5.41130018234253,2.20499992370605,4.0625,0.64819997549057,5.38259983062744,0.170900002121925,23.4669990539551,9.57849979400635,3.69479990005493,2.2221999168396,1.74899995326996,1.15939998626709,6.99009990692139,3.96830010414124,21.4290008544922,0.476200014352798,2.15050005912781,1.85780000686646,4.32950019836426,8.9286003112793,2.7778000831604,2.65650010108948,2.5,18.2670001983643,0.819000005722046,2,15.3850002288818,6.47749996185303,8.33329963684082,4.55030012130737,2.49580001831055,4.47970008850098,2.23239994049072,2.07100009918213,1.67599999904633,3.40910005569458,2.5,3.96090006828308,6.22749996185303,3.92860007286072,2.90000009536743,4.08160018920898,2.84999990463257,7.01529979705811,2.93880009651184,1.92309999465942,6.875,3.90019989013672,2,4.97629976272583,1.20190000534058,22.5,6.86770009994507,3.56130003929138,1.97920000553131,5.3713002204895,1.7441999912262,5.09479999542236,2.5,3.82500004768372,1,3.07170009613037,1.71630001068115,4.02089977264404,5.45849990844727,25,2.38969993591309,3.21339988708496,3.37700009346008,1.77779996395111,3.16330003738403,2.70269989967346,1.69270002841949,0.213699996471405,6.76690006256104,1.74070000648499,2.5,4.48589992523193,2.57200002670288,3.46000003814697,4.78259992599487,2.31180000305176,5.3060998916626,5.86749982833862,3.40910005569458,4.08160018920898],[12,12,12,12,14,12,16,12,12,12,12,11,12,12,10,11,12,12,12,12,16,12,13,12,12,17,12,12,17,12,11,16,13,12,16,11,12,10,14,17,12,12,16,12,12,12,16,12,12,12,12,12,12,8,10,16,14,17,14,12,14,12,8,12,12,8,17,12,12,12,12,12,9,10,12,12,12,17,15,12,6,14,12,14,9,17,13,9,15,12,12,12,12,12,12,12,12,13,12,13,12,12,12,16,12,13,11,12,12,12,17,14,16,17,12,11,12,12,17,10,13,11,12,16,17,12,16,12,16,8,12,12,12,13,11,12,12,14,12,12,12,17,14,12,9,12,12,12,14,16,17,15,12,16,17,17,12,16,13,12,11,16,14,16,12,9,17,14,12,12,11,12,12,10,12,5,17,11,12,12,14,11,12,14,12,10,16,13,12,12,12,11,12,9,13,12,12,12,13,16,12,16,17,12,12,9,12,12,13,12,12,12,12,10,12,16,12,11,12,10,12,12,12,12,16,17,12,17,12,12,12,8,12,13,12,12,8,12,17,17,12,13,12,12,12,12,9,10,12,16,13,8,16,13,12,11,13,12,12,10,12,17,15,16,10,11,12,12,14,16,14,8,7,12,12,14,12,12,12,14,16,12,12,12,13,13,10,12,12,12,12,14,17,10,9,12,12,16,12,17,12,17,11,16,11,13,11,8,11,12,10,17,12,12,17,14,12,12,12,12,12,12,9,10,12,12,12,12,12,17,12,17,12,10,12,12,12,12,12,12,16,13,13,12,16,17,12,14,12,17,12,14,12,12,17,16,16,12,9,12,12,16,14,12,12,11,12,16,17,17,14,12,14,12,10,12,13,16,12,7,16,14,12,10,12,16,10,12,14,12,6,15,12,17,14,13,6,16,14,15,14,8,14,12,12,12,12,12,12,8,12,17,12,12,14,13,17,8,12,11,12,12,17,10,12,13,12,12],[7,7,7,7,14,7,7,3,7,7,3,7,16,10,7,10,7,12,7,7,16,10,3,7,7,14,7,7,12,12,7,3,10,14,12,3,3,3,7,17,12,9,16,3,7,7,16,10,7,7,7,3,7,7,3,12,7,17,7,7,3,12,7,7,7,12,16,7,7,7,12,10,9,0,10,14,7,3,12,12,7,17,3,7,7,12,7,7,12,10,0,12,10,7,7,7,3,12,7,12,7,7,10,14,7,12,7,7,10,7,12,7,7,17,7,7,7,10,10,12,7,12,7,10,7,10,7,7,7,7,7,7,16,12,7,3,7,7,7,12,7,12,12,14,7,7,7,12,12,14,10,12,7,16,7,17,3,10,9,7,3,16,12,7,7,7,12,3,7,7,7,7,10,10,7,12,17,10,7,7,12,7,12,7,7,7,7,14,7,12,7,7,12,3,7,12,12,7,7,14,12,17,17,7,7,10,7,7,7,3,0,7,12,7,7,12,7,7,12,7,7,3,7,7,10,12,7,12,7,7,7,7,12,7,7,7,7,7,14,17,7,10,7,7,12,7,7,9,7,14,7,3,16,3,16,7,16,12,7,7,12,12,12,16,7,9,7,12,12,10,7,12,7,7,3,10,17,7,3,3,12,7,7,7,10,7,10,7,9,9,12,12,12,7,9,12,7,12,7,12,12,14,7,14,10,12,7,7,12,7,7,12,12,12,12,14,10,7,7,7,7,7,7,7,7,7,12,12,7,14,10,12,7,7,12,7,10,12,10,7,14,7,12,12,7,16,0,12,7,17,7,12,3,7,14,7,12,12,7,7,14,7,12,12,7,7,7,7,3,12,7,7,14,10,10,10,10,12,3,7,16,7,7,0,7,7,10,7,12,7,7,7,7,16,12,10,7,7,16,7,7,7,12,10,10,10,7,10,12,12,7,17,12,16,10,16,7,7,9,3,7,7,7,7,7,7,16,12]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>wage<\/th>\n      <th>educ<\/th>\n      <th>fatheduc<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":8,"scrollX":true,"scrollCollapse":true,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100],"rowCallback":"function(row, data) {\nDTWidget.formatRound(this, row, data, 1, 4, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>

---

## 散点图1

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="11-instrument-variable-slide_files/figure-html/unnamed-chunk-5-1.png" alt="受教育年数与时均工资的散点图"  /&gt;
&lt;p class="caption"&gt;受教育年数与时均工资的散点图&lt;/p&gt;
&lt;/div&gt;

---

## 散点图2

&lt;div class="figure" style="text-align: center"&gt;
&lt;img src="11-instrument-variable-slide_files/figure-html/unnamed-chunk-6-1.png" alt="考虑父亲受教育年数的散点图"  /&gt;
&lt;p class="caption"&gt;考虑父亲受教育年数的散点图&lt;/p&gt;
&lt;/div&gt;

---

## OLS回归




如果直接构建如下的**“偏误模型”**，并坚持采用OLS估计：

`$$\begin{equation} \begin{alignedat}{999} &amp;log(wage)=&amp;&amp; + \beta_{1} &amp;&amp; + \beta_{2} educ&amp;&amp;+u_i\\ \end{alignedat} \end{equation}$$`

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{log(wage)}=&amp;&amp;-0.19&amp;&amp;+0.11educ\\ &amp;\text{(t)}&amp;&amp;(-0.9998)&amp;&amp;(7.5451)\\&amp;\text{(se)}&amp;&amp;(0.1852)&amp;&amp;(0.0144)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.1179;&amp;&amp; \bar{R^2}=0.1158\\&amp; &amp;&amp; F^{\ast}=56.93;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

---

## 工具变量法回归（IV）:手工分步计算

采用工具变量法的第一阶段回归：

`$$\begin{equation} \begin{alignedat}{999} &amp;educ=&amp;&amp; + \beta_{1} &amp;&amp; + \beta_{2} fatheduc&amp;&amp;+u_i\\ \end{alignedat} \end{equation}$$`

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{educ}=&amp;&amp;+10.24&amp;&amp;+0.27fatheduc\\ &amp;\text{(t)}&amp;&amp;(37.0993)&amp;&amp;(9.4255)\\&amp;\text{(se)}&amp;&amp;(0.2759)&amp;&amp;(0.0286)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.1726;&amp;&amp; \bar{R^2}=0.1706\\&amp; &amp;&amp; F^{\ast}=88.84;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

采用工具变量法的第二阶段回归：

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{log(wage)}=&amp;&amp;+0.44&amp;&amp;+0.06educ.hat\\ &amp;\text{(t)}&amp;&amp;(0.9443)&amp;&amp;(1.6081)\\&amp;\text{(se)}&amp;&amp;(0.4671)&amp;&amp;(0.0368)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.0060;&amp;&amp; \bar{R^2}=0.0037\\&amp; &amp;&amp; F^{\ast}=2.59;&amp;&amp; p=0.1086 \end{alignedat} \end{equation}$$`

---

## 工具变量法回归（IV）：R软件自动计算

采用R包`AER`的工具变量回归函数`ivreg()`，可以得到如下回归结果：

.pull-left[


```

Call:
ivreg(formula = log(wage) ~ educ | fatheduc, data = mroz)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.0870 -0.3393  0.0525  0.4042  2.0677 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)  
(Intercept)  0.44110    0.44610   0.989   0.3233  
educ         0.05917    0.03514   1.684   0.0929 .
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6894 on 426 degrees of freedom
Multiple R-Squared: 0.09344,	Adjusted R-squared: 0.09131 
Wald test: 2.835 on 1 and 426 DF,  p-value: 0.09294 
```

]

.pull-right[

**工具变量回归模型**：

`$$\begin{align}
log(wage) = \lambda_1 + \lambda_2educ|fatheduc + \epsilon_i
\end{align}$$`

**提问**：

- 手工分步计算与软件自动计算有哪些不同？


- 判定系数和系数标准误差为什么会不同？

]

---

## 工具变量法回归（IV）：EViews软件自动计算

EViews软件下工具变量法的实现：

&lt;img src="pic/chpt11-eq-iv-estimation.png" width="431" style="display: block; margin: auto;" /&gt;

---

## 工具变量法回归（IV）：EViews软件自动计算

EViews软件下工具变量法的结果：

&lt;img src="pic/chpt11-eq-iv-eviews.png" width="590" style="display: block; margin: auto;" /&gt;

---

layout:false
class: middle, center, inverse

# 11.3 多元回归模型的IV估计

---
layout: true
  
&lt;div class="my-header"&gt;&lt;/div&gt;

&lt;div class="my-footer"&gt;&lt;span&gt;huhuaping@   第11章：内生自变量问题   
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
11.3 多元回归模型的IV估计 &lt;/span&gt;&lt;/div&gt; 

---

## 新的符号表达体系

对于多元回归模型，我们可以记为：

`$$\begin {align} 
\log (wage) &amp; = \beta_{1}+\beta_{2} educ+\lambda_{1} exper+u_{i} \\
Y_{1i} &amp; =\beta_{1}+\beta_{2} Y_{2i}+\lambda_{1} Z_{1i}+u_{i} \\
E(u_i)&amp;=0;  \quad cov(Y_{2i}, u_i) \neq 0 ;\\
cov(Z_{1i},u_i)&amp;=0;\quad cov(Y_{2i},Z_{1i})=0
\end {align}$$`

- **内生变量**（endogenous variable）：用符号
`\(Y_i\)`表达。例如，因变量（工资水平）
`\(Y_{1i}\)`显然是内生变量；而其中的一个自变量（教育年数）
`\(Y_{2i}\)`我们在这里认为也是内生的——也即允许它跟随机干扰项
`\(u_i\)`**相关**。

- **外生变量**（exogenous variable）：用符号
`\(Z_i\)`表达。例如另一个自变量（工作经历）
`\(Z_{1i}\)`则认为它是外生的——也即它跟随机干扰项
`\(u_i\)`**不相关**。


---

## 约简方程

`$$\begin {align} 
\log (wage) &amp; = \beta_{1}+\beta_{2} educ+\lambda_{1} exper+u_{i} \\
Y_{1i} &amp; =\beta_{1}+\beta_{2} Y_{2i}+\lambda_{1} Z_{1i}+u_{i} \\
\end {align}$$`

如果我们给内生变量
`\(Y_{2i}\)`找到一个理想的工具变量
`\(Z_{2i}\)`，则可以构建如下的**约简方程**：

`$$\begin {align} 
Y_{2i} &amp; =\pi_{0}+\pi_{1} Z_{1i}+\pi_{2} Z_{2i}+v_{i} \\
E(v_i)&amp;=0; \quad cov(Y_{2i},Z_{1i})=0;\\
cov(Z_{1i},v_i) &amp;=0; \quad cov(Z_{2i}, v_i) = 0
\end {align}$$`

- **约简方程**（reductive equation）：是指一个**内生变量**对全部**外生变量**的回归方程。

- 因为
`\(Z_{1i};Z_{2i}\)`为外生变量都为**外生变量**，所以满足CLRM假设，上述**偏相关分析模型**可以直接使用OLS方法而得到**BLUE**。**偏相关分析模型**可以用于检验
`\(Y_{2i}\)`与
`\(Z_{2i}\)`是否相关，也即检验：
`\(H_0:\pi_2=0; \quad H_1:\pi_2 \neq 0\)`。具体可以采用通常的**t检验**方法。


**提问1**：我们能不能检验
`\(Z_{2i}\)`与
`\(u_i\)`相关？能不能检验
`\(Z_{1i}\)`与
`\(u_i\)`相关？

**提问2**：还能不能构造别的**简约方程**？

---

## 两阶段最小二乘法（2SLS）

`$$\begin {align} 
\log (wage) &amp; = \beta_{1}+\beta_{2} educ+\lambda_{1} exper+u_{i} \\
Y_{1i} &amp; =\beta_{1}+\beta_{2} Y_{2i}+\lambda_{1} Z_{1i}+u_{i} \\
\end {align}$$`

第一阶段OLS回归：对约简方程进行回归。

`$$\begin {align} 
Y_{2i} &amp; =\pi_{0}+\pi_{1} Z_{1i}+\pi_{2} Z_{2i}+v_{i}  
&amp;&amp; \leftarrow \left[ \pi_2 \neq 0 \right]\\
\hat{Y}_{2i} &amp; =\pi_{0}+\pi_{1} Z_{1i}+\pi_{2} Z_{2i}
\end {align}$$`

第二阶段OLS回归：基于估计值进行回归。

`$$\begin {align} 
Y_{1i} &amp; =\alpha_{0}+\alpha_{1} Z_{1i}+\beta_{2} \hat{Y}_{2i}+\epsilon_{i}
\end {align}$$`

---
class: middle, center, duke-orange

## 已婚女性的教育回报案例

---

## 原始数据


<div id="htmlwidget-1a306128e73bb2940dfa" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-1a306128e73bb2940dfa">{"x":{"filter":"none","caption":"<caption>已婚女性的教育回报数据n=(428)<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428"],[3.35400009155273,1.3889000415802,4.54549980163574,1.09650003910065,4.59180021286011,4.74209976196289,8.33329963684082,7.84310007095337,2.12619996070862,4.6875,4.06300020217896,4.59180021286011,2.08330011367798,2.26679992675781,3.67969989776611,1.34720003604889,3.21429991722107,5.17500019073486,2,7.5528998374939,3.50519990921021,3.57139992713928,3.25,3.25,2.15450000762939,3.7878999710083,4,4.72690010070801,7.25589990615845,5.86709976196289,1.53849995136261,2.45900011062622,5.85109996795654,3.57139992713928,3.80679988861084,2.46379995346069,2.37529993057251,4.53509998321533,5.61829996109009,14.6309995651245,2.67860007286072,3.91939997673035,2.57290005683899,4.53749990463257,2,3.4721999168396,2.01609992980957,4.57159996032715,2.27270007133484,2.63750004768372,2.28990006446838,1.09889996051788,1.1764999628067,1.60000002384186,1.87619996070862,4.04370021820068,9.63539981842041,8.04090023040771,4.59899997711182,2.14289999008179,4.40000009536743,3.53539991378784,2.71740007400513,6.25,11.9329996109009,3.59310007095337,6.9443998336792,2.91669988632202,3.07690000534058,3.75,5.72590017318726,3.67569994926453,5.16480016708374,8.22369956970215,4.33650016784668,4.98190021514893,0.357100009918213,2.96740007400513,1,2.55539989471436,0.860199987888336,1,2.92610001564026,3.54609990119934,1.62639999389648,8.33329963684082,3.0952000617981,2.70000004768372,5.25209999084473,1.41540002822876,4.79860019683838,1.66670000553131,1.12170004844666,0.5,0.714299976825714,2.79609990119934,4.85830020904541,1.74349999427795,2.46309995651245,2.42129993438721,1.53450000286102,2.88179993629456,2.40689992904663,5.23260021209717,3.75,1.3889000415802,4,3.23130011558533,3.40140008926392,1.33329999446869,9.30230045318604,4.5,4.62349987030029,3.9556999206543,5.81400012969971,0.5,4.08160018920898,6,3.66669988632202,3.86129999160767,2.76290011405945,2.93099999427795,4.38840007781982,5.41669988632202,9.86110019683838,0.16159999370575,0.382600009441376,3.63639998435974,2.37470006942749,4.66669988632202,1.85189998149872,5.19999980926514,3.2985999584198,8.53330039978027,2.06349992752075,2.56410002708435,2.1875,6.25,3.33330011367798,4.4443998336792,6.63350009918213,8.42240047454834,4.39559984207153,2.44569993019104,1.22449994087219,1.625,3,4.72690010070801,1.12929999828339,7.40240001678467,4.45949983596802,2.47250008583069,1.88240003585815,4,8.1899995803833,7.09679985046387,1.66670000553131,3.4449999332428,4.23470020294189,2.7778000831604,1.88919997215271,5.03520011901855,1.25,2.85710000991821,4.11670017242432,1.77779996395111,13.5539999008179,4.56269979476929,2.12770009040833,2.98909997940063,2.56539988517761,5.6121997833252,2.80539989471436,1.60699999332428,2.25,2.03250002861023,5.53200006484985,1.58449995517731,3.7878999710083,3,8.65380001068115,4.21049976348877,4.6875,4.0984001159668,25,2.6331000328064,6,5.41260004043579,0.664200007915497,1.25,2.27539992332458,3.4614999294281,4.16669988632202,4.46869993209839,1.75,3.66939997673035,6.58260011672974,2.59999990463257,4.86509990692139,5.78700017929077,4.54080009460449,9.50570011138916,10.6379995346069,1.1110999584198,4.05410003662109,2.68709993362427,2.97620010375977,3.17280006408691,3.54999995231628,17.9069995880127,3.41739988327026,3.33330011367798,3.88599991798401,2.31110000610352,1.71080005168915,2.1143000125885,9.9330997467041,3.02769994735718,1.86049997806549,0.128199994564056,6.63269996643066,5.63910007476807,1.59899997711182,2.66669988632202,7.92080020904541,5.33979988098145,4,6.04489994049072,6.25,2.97620010375977,4.23390007019043,3.49160003662109,4.96449995040894,2.76920008659363,3.65849995613098,5.39349985122681,0.6564000248909,4.76879978179932,8.555100440979,10.4589996337891,2.63750004768372,6.84929990768433,5.08720016479492,0.961499989032745,4.30660009384155,7.06669998168945,2.52530002593994,7.894700050354,4.14890003204346,8.17459964752197,9.59710025787354,2.01640009880066,7.6217999458313,3.19749999046326,1.60000002384186,4.0984001159668,1.4815000295639,3.63639998435974,1,2.60419988632202,1.75,4.80000019073486,5.53000020980835,4.0984001159668,1.25,1.66670000553131,3.79010009765625,2.36360001564026,10.2040004730225,6.81820011138916,7.21460008621216,2.44840002059937,1.19869995117188,1.64100003242493,1.7820999622345,2.94120001792908,4.96890020370483,1.86049997806549,8.03569984436035,3.97160005569458,3.04159998893738,2.90700006484985,3.06119990348816,4.89659976959229,4.01609992980957,5.5556001663208,1.22269999980927,2.68390011787415,2.67379999160767,9.32940006256104,3.13809990882874,0.542599976062775,8.61110019683838,3.6686999797821,2.31850004196167,2.88199996948242,3.16659998893738,3.64580011367798,6.25,10.2489995956421,3.20959997177124,7.65220022201538,1.97239995002747,4.69799995422363,2.12339997291565,2.33330011367798,2.38960003852844,1.25639998912811,1.09379994869232,3.75,3.30719995498657,5.13520002365112,6.63269996643066,4.5644998550415,11.8479995727539,3.75,4.36509990692139,3.93330001831055,3.33330011367798,3.31590008735657,3.56159996986389,1.60000002384186,2.22550010681152,4.78719997406006,5.80649995803833,2.3585000038147,2,1.89999997615814,5.1230001449585,5.49450016021729,6.32180023193359,7.14289999008179,2.375,2.54290008544922,2.17980003356934,2.59999990463257,3.72939991950989,4.375,4.44329977035522,4.28770017623901,1.66670000553131,3.2558000087738,5.41130018234253,2.20499992370605,4.0625,0.64819997549057,5.38259983062744,0.170900002121925,23.4669990539551,9.57849979400635,3.69479990005493,2.2221999168396,1.74899995326996,1.15939998626709,6.99009990692139,3.96830010414124,21.4290008544922,0.476200014352798,2.15050005912781,1.85780000686646,4.32950019836426,8.9286003112793,2.7778000831604,2.65650010108948,2.5,18.2670001983643,0.819000005722046,2,15.3850002288818,6.47749996185303,8.33329963684082,4.55030012130737,2.49580001831055,4.47970008850098,2.23239994049072,2.07100009918213,1.67599999904633,3.40910005569458,2.5,3.96090006828308,6.22749996185303,3.92860007286072,2.90000009536743,4.08160018920898,2.84999990463257,7.01529979705811,2.93880009651184,1.92309999465942,6.875,3.90019989013672,2,4.97629976272583,1.20190000534058,22.5,6.86770009994507,3.56130003929138,1.97920000553131,5.3713002204895,1.7441999912262,5.09479999542236,2.5,3.82500004768372,1,3.07170009613037,1.71630001068115,4.02089977264404,5.45849990844727,25,2.38969993591309,3.21339988708496,3.37700009346008,1.77779996395111,3.16330003738403,2.70269989967346,1.69270002841949,0.213699996471405,6.76690006256104,1.74070000648499,2.5,4.48589992523193,2.57200002670288,3.46000003814697,4.78259992599487,2.31180000305176,5.3060998916626,5.86749982833862,3.40910005569458,4.08160018920898],[12,12,12,12,14,12,16,12,12,12,12,11,12,12,10,11,12,12,12,12,16,12,13,12,12,17,12,12,17,12,11,16,13,12,16,11,12,10,14,17,12,12,16,12,12,12,16,12,12,12,12,12,12,8,10,16,14,17,14,12,14,12,8,12,12,8,17,12,12,12,12,12,9,10,12,12,12,17,15,12,6,14,12,14,9,17,13,9,15,12,12,12,12,12,12,12,12,13,12,13,12,12,12,16,12,13,11,12,12,12,17,14,16,17,12,11,12,12,17,10,13,11,12,16,17,12,16,12,16,8,12,12,12,13,11,12,12,14,12,12,12,17,14,12,9,12,12,12,14,16,17,15,12,16,17,17,12,16,13,12,11,16,14,16,12,9,17,14,12,12,11,12,12,10,12,5,17,11,12,12,14,11,12,14,12,10,16,13,12,12,12,11,12,9,13,12,12,12,13,16,12,16,17,12,12,9,12,12,13,12,12,12,12,10,12,16,12,11,12,10,12,12,12,12,16,17,12,17,12,12,12,8,12,13,12,12,8,12,17,17,12,13,12,12,12,12,9,10,12,16,13,8,16,13,12,11,13,12,12,10,12,17,15,16,10,11,12,12,14,16,14,8,7,12,12,14,12,12,12,14,16,12,12,12,13,13,10,12,12,12,12,14,17,10,9,12,12,16,12,17,12,17,11,16,11,13,11,8,11,12,10,17,12,12,17,14,12,12,12,12,12,12,9,10,12,12,12,12,12,17,12,17,12,10,12,12,12,12,12,12,16,13,13,12,16,17,12,14,12,17,12,14,12,12,17,16,16,12,9,12,12,16,14,12,12,11,12,16,17,17,14,12,14,12,10,12,13,16,12,7,16,14,12,10,12,16,10,12,14,12,6,15,12,17,14,13,6,16,14,15,14,8,14,12,12,12,12,12,12,8,12,17,12,12,14,13,17,8,12,11,12,12,17,10,12,13,12,12],[14,5,15,6,7,33,11,35,24,21,15,14,0,14,6,9,20,6,23,9,5,11,18,15,4,21,31,9,7,7,32,11,16,14,27,0,17,28,24,11,1,14,6,10,6,4,10,22,16,6,12,32,15,17,34,9,37,10,35,6,19,10,11,15,12,12,14,11,9,24,12,13,29,11,13,19,2,24,9,6,22,30,10,6,29,29,36,19,8,13,16,11,15,6,13,22,24,2,6,2,2,14,9,11,9,6,19,26,19,3,7,28,13,9,15,20,29,9,1,8,19,23,3,13,8,17,4,15,11,7,0,0,10,8,2,4,6,18,3,22,33,28,23,27,11,6,11,14,17,17,14,11,7,8,6,8,4,25,24,11,19,9,19,14,22,6,23,15,6,11,2,22,10,14,12,9,13,18,8,11,9,9,14,9,2,12,15,11,7,9,19,11,8,13,4,7,19,14,14,3,9,7,7,14,29,19,14,16,10,12,24,6,9,14,26,7,4,15,23,1,29,9,6,11,17,6,7,2,24,4,11,25,11,2,19,7,2,20,10,19,17,12,11,6,10,4,2,13,21,9,4,2,19,4,9,14,6,24,1,13,3,10,16,9,19,4,10,5,7,3,38,16,13,1,7,15,10,2,19,25,25,7,15,11,25,19,4,14,19,18,14,11,4,29,21,24,19,31,28,15,27,13,4,10,8,4,18,3,11,8,10,33,19,35,21,7,18,4,12,16,14,3,1,27,12,6,9,2,6,9,16,22,26,11,11,15,13,6,20,17,8,13,15,14,14,6,24,10,2,9,23,12,8,16,10,7,19,2,9,14,9,16,7,6,22,9,9,14,17,12,13,8,10,16,1,6,4,8,4,15,7,14,16,15,23,19,4,12,12,25,14,14,11,7,18,4,37,13,14,17,5,2,0,3,21,20,19,4,19,11,14,8,13,24,1,1,3,4,21,10,13,9,14,2,21,22,14,7],[7,7,7,7,14,7,7,3,7,7,3,7,16,10,7,10,7,12,7,7,16,10,3,7,7,14,7,7,12,12,7,3,10,14,12,3,3,3,7,17,12,9,16,3,7,7,16,10,7,7,7,3,7,7,3,12,7,17,7,7,3,12,7,7,7,12,16,7,7,7,12,10,9,0,10,14,7,3,12,12,7,17,3,7,7,12,7,7,12,10,0,12,10,7,7,7,3,12,7,12,7,7,10,14,7,12,7,7,10,7,12,7,7,17,7,7,7,10,10,12,7,12,7,10,7,10,7,7,7,7,7,7,16,12,7,3,7,7,7,12,7,12,12,14,7,7,7,12,12,14,10,12,7,16,7,17,3,10,9,7,3,16,12,7,7,7,12,3,7,7,7,7,10,10,7,12,17,10,7,7,12,7,12,7,7,7,7,14,7,12,7,7,12,3,7,12,12,7,7,14,12,17,17,7,7,10,7,7,7,3,0,7,12,7,7,12,7,7,12,7,7,3,7,7,10,12,7,12,7,7,7,7,12,7,7,7,7,7,14,17,7,10,7,7,12,7,7,9,7,14,7,3,16,3,16,7,16,12,7,7,12,12,12,16,7,9,7,12,12,10,7,12,7,7,3,10,17,7,3,3,12,7,7,7,10,7,10,7,9,9,12,12,12,7,9,12,7,12,7,12,12,14,7,14,10,12,7,7,12,7,7,12,12,12,12,14,10,7,7,7,7,7,7,7,7,7,12,12,7,14,10,12,7,7,12,7,10,12,10,7,14,7,12,12,7,16,0,12,7,17,7,12,3,7,14,7,12,12,7,7,14,7,12,12,7,7,7,7,3,12,7,7,14,10,10,10,10,12,3,7,16,7,7,0,7,7,10,7,12,7,7,7,7,16,12,10,7,7,16,7,7,7,12,10,10,10,7,10,12,12,7,17,12,16,10,16,7,7,9,3,7,7,7,7,7,7,16,12],[12,7,12,7,12,14,14,3,7,7,12,14,16,10,7,16,10,12,7,12,10,12,7,7,12,16,3,3,12,12,7,3,12,7,12,10,3,10,7,14,12,9,14,3,12,12,14,10,7,12,7,7,12,7,7,12,7,17,17,12,14,12,7,7,7,12,12,12,7,12,12,10,7,0,7,12,7,3,10,7,12,12,7,7,7,7,7,7,7,10,7,12,10,12,7,7,7,14,7,12,12,7,7,14,12,10,7,7,7,7,12,7,12,10,10,7,7,7,12,7,7,12,14,12,7,10,7,7,12,10,7,7,12,10,7,12,7,7,7,7,3,12,16,7,3,12,7,12,12,16,12,12,7,14,7,10,7,14,7,7,12,12,17,7,7,3,12,7,7,7,3,7,10,10,12,7,14,10,7,7,10,12,12,7,7,7,12,7,12,12,12,10,12,10,12,12,12,7,12,12,12,12,16,7,16,7,7,10,12,10,0,7,12,12,10,12,3,7,12,10,7,7,7,7,12,12,7,12,7,10,10,7,12,17,7,7,7,7,12,14,7,12,7,7,16,7,10,12,7,16,10,3,16,7,12,7,7,7,12,12,7,10,14,16,7,10,7,14,14,12,7,7,3,7,7,7,12,10,7,3,12,7,12,7,10,7,0,7,10,9,12,12,12,3,9,12,12,14,7,12,12,12,7,12,10,12,7,7,3,12,7,16,12,12,7,14,7,7,12,10,7,3,7,7,10,7,7,12,12,12,10,14,7,7,14,10,10,7,7,7,14,7,12,14,14,14,0,16,7,12,7,10,7,10,10,14,7,12,7,7,12,14,12,7,7,7,12,16,3,16,7,16,7,10,10,10,10,12,10,7,16,7,7,7,7,7,10,10,12,7,7,7,7,14,14,7,7,7,16,12,7,7,12,12,12,10,3,12,12,12,7,16,12,10,10,12,7,7,7,7,7,7,7,7,7,7,12,12]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>wage<\/th>\n      <th>educ<\/th>\n      <th>exper<\/th>\n      <th>fatheduc<\/th>\n      <th>motheduc<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":8,"scrollX":true,"scrollCollapse":true,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100],"rowCallback":"function(row, data) {\nDTWidget.formatRound(this, row, data, 1, 4, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>

---

## 偏误OLS回归：精炼报告




如果认为工作经历
`\(exper\)`是**外生变量**变量；且认为已婚女性的受教育年数
`\(educ\)`为**内生变量**。直接构建如下的**“偏误模型”**，并坚持采用OLS方法，估计结果为：

`$$\begin{equation} \begin{alignedat}{999} &amp;log(wage)=&amp;&amp; + \beta_{1} &amp;&amp; + \beta_{2} educ&amp;&amp; + \beta_{3} exper&amp;&amp; + \beta_{4} I(exper^2)&amp;&amp;+u_i\\ \end{alignedat} \end{equation}$$`

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{log(wage)}=&amp;&amp;-0.52&amp;&amp;+0.11educ&amp;&amp;+0.04exper&amp;&amp;-0.00I(exper^2)\\ &amp;\text{(t)}&amp;&amp;(-2.6282)&amp;&amp;(7.5983)&amp;&amp;(3.1549)&amp;&amp;(-2.0628)\\&amp;\text{(se)}&amp;&amp;(0.1986)&amp;&amp;(0.0141)&amp;&amp;(0.0132)&amp;&amp;(0.0004)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.1568;&amp;&amp; \bar{R^2}=0.1509\\&amp; &amp;&amp; F^{\ast}=26.29;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

---

## 偏误OLS回归：EViews报告

下面给出EViews软件分析报告：

&lt;img src="pic/chpt11-mroz2-eq-ols.png" width="564" style="display: block; margin: auto;" /&gt;

---

## 两阶段回归法（2SLS）:第一阶段

假设**父亲受教育年数**
`\(fatheduc\)`和**母亲受教育年数**
`\(motheduc\)`都是已婚女性**受教育年数**
`\(educ\)`的理想**工具变量**。

采用工具变量法的对如下**约简方程**：

`$$\begin{equation}
\begin{alignedat}{999} &amp;educ=&amp;&amp; + \pi_{1} &amp;&amp; + \pi_{2} exper&amp;&amp; + \pi_{3} exper^2&amp;&amp;+ \pi_{4} fatheduc&amp;&amp; + \pi_{5} motheduc&amp;&amp;+v_i\\ \end{alignedat}
\end{equation}$$`

对以上**约简方程**进行第一阶段OLS回归，估计结果为：

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{educ}=&amp;&amp;+9.10&amp;&amp;+0.05exper&amp;&amp;-0.00I(exper^2)&amp;&amp;+0.19fatheduc&amp;&amp;+0.16motheduc\\ &amp;\text{(t)}&amp;&amp;(21.3396)&amp;&amp;(1.1236)&amp;&amp;(-0.8386)&amp;&amp;(5.6152)&amp;&amp;(4.3906)\\&amp;\text{(se)}&amp;&amp;(0.4266)&amp;&amp;(0.0403)&amp;&amp;(0.0012)&amp;&amp;(0.0338)&amp;&amp;(0.0359)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.2115;&amp;&amp; \bar{R^2}=0.2040\\&amp; &amp;&amp; F^{\ast}=28.36;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

---

## 两阶段回归法（2SLS）:第二阶段

利用前述第一阶段回归得到的
`\(\widehat{educ}\)`以及原来的**外生变量**
`\(exper\)`，我们可以构建如下的第二阶段回归模型：

`$$\begin {align} 
log(wage) &amp; =\alpha_{1}+\alpha_{2} exper_{i}+\alpha_{3} exper_{i}^2 +\beta_{1} \widehat{educ}_{i}+\epsilon_{i}
\end {align}$$`

采用OLS方法对以上模型进行估计，得到如下结果：

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{log(wage)}=&amp;&amp;+0.05&amp;&amp;+0.06educ.hat&amp;&amp;+0.04exper&amp;&amp;-0.00I(exper^2)\\ &amp;\text{(t)}&amp;&amp;(0.1146)&amp;&amp;(1.8626)&amp;&amp;(3.1361)&amp;&amp;(-2.1344)\\&amp;\text{(se)}&amp;&amp;(0.4198)&amp;&amp;(0.0330)&amp;&amp;(0.0141)&amp;&amp;(0.0004)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.0498;&amp;&amp; \bar{R^2}=0.0431\\&amp; &amp;&amp; F^{\ast}=7.40;&amp;&amp; p=0.0001 \end{alignedat} \end{equation}$$`

---

### 两阶段最小二乘法（2SLS,不调整方差）：EViews实现

EViews软件的具体设置为：

&lt;img src="pic/chpt11-mroz2-eq-2sls-specif.png" width="634" style="display: block; margin: auto;" /&gt;

---

### 两阶段最小二乘法（2SLS,不调整方差）：EViews结果

EViews软件的分析结果：

&lt;img src="pic/chpt11-mroz2-eq-2sls.png" width="530" style="display: block; margin: auto;" /&gt;

---

### 两阶段最小二乘法（2SLS,怀特矫正）：EViews实现

EViews软件设置：

&lt;img src="pic/chpt11-mroz2-eq-2sls-adj-specif.png" width="634" style="display: block; margin: auto;" /&gt;

---

### 两阶段最小二乘法（2SLS,怀特矫正）：EViews结果

EViews软件分析结果：

&lt;img src="pic/chpt11-mroz2-eq-2sls-adj.png" width="536" style="display: block; margin: auto;" /&gt;

---
layout:false
class: middle, center, inverse

# 11.4 工具变量法的一些讨论

---
layout: true
  
&lt;div class="my-header"&gt;&lt;/div&gt;

&lt;div class="my-footer"&gt;&lt;span&gt;huhuaping@   第11章：内生自变量问题   
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
11.4 工具变量法的一些讨论 &lt;/span&gt;&lt;/div&gt;

---
class: duke-green, page-font-26

## 工具变量法回归中的判定系数

--

1. 与OLS中的怙况不同，由于IV的SSR实际上可能大亍SST。所以IV估计中的
`\(R^2\)`可能为负。尽管报告IV估计的
`\(R^2\)`也不会有什么害处，但也不是很有用。

--

2. 当自变量
`\(X_i\)`与随机干扰项
`\(v_i\)`**相关**时，因变量
`\(Y_i\)`的方差分解成
`\(\lambda_2^2var(X_i) + var(v_i)\)`，因此**判定系数**
`\(R^2\)`没有合理的解释。进一步地，工具变量回归下
`\(R^2\)`也**不能**用于联合约束的**F检验**。

--

3. 如果目标是为了得到最大的
`\(R^2\)`，我们将总是使用**OLS**。如果采用工具变量法（IV），拟合优度
`\(R^2\)`已经不是其考虑的方面了。

--

4. **两阶段最小二乘法**（2SLS）是GLS方法的一种，它是需要利用额外的信息（工具变量）。很多时候2SLS还需要考虑对**系数方差矩阵**的矫正——**怀特矫正**（White方法）或**HAC矫正**（Neway-West方法）。

---

## 低劣工具变量条件下IV的性质

`$$\begin {align} 
Y_i &amp; = \beta_{1}+\beta_{2}X_i+u_i \\
Y_i &amp; = \alpha_{1}+\alpha_{2}Z_i+v_i
\end {align}$$`

最小二乘法（OLS）估计下：

`$$\begin {align} 
\hat{\beta}_2|_{OLS}^{plim} &amp; = {\beta}_2 +corr(u_i, X_i) \cdot \frac{\sigma_{u_i}}{\sigma_{X_i}}
\end {align}$$`

工具变量法（IV）估计下：

`$$\begin {align} 
\hat{\alpha}_2|_{IV}^{plim} &amp; = {\alpha}_2 +\frac{corr(Z_i, v_i)}{corr(Z_i, X_i)} \cdot \frac{\sigma_{v_i}}{\sigma_{X_i}}
\end {align}$$`

- 如果
`\(corr(Z_i,X_i)=0.2\)`，要使得IV比OLS具有更小的渐近偏误，
`\(corr(Z_i,v_i)\)`必须小于
`\(corr(X_i,u_i)\)`的1/5.

---
layout:false
class: middle, center, inverse

# 11.5 解释变量的内生性检验

## （豪斯曼检验）

---
layout: true
  
&lt;div class="my-header"&gt;&lt;/div&gt;

&lt;div class="my-footer"&gt;&lt;span&gt;huhuaping@   第11章：内生自变量问题   
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
11.5 解释变量的内生性检验（豪斯曼检验） &lt;/span&gt;&lt;/div&gt; 

---

## 内生性检验的内容

**工具变量**（instrument variable）具备如下**两个性质**：

`$$\begin{align}
Cov(Z_i, u_i) &amp; = 0 &amp;&amp; \text{(instrumental exogeneity)}\\ 
Cov(Z_i, X_i) &amp; \neq 0 &amp;&amp; \text{(instrumental relevance)}
\end{align}$$`


我们先来检验**第二个**条件：一个变量
`\(X_i\)`是否真的是**内生性**的？

&gt; 因为
`\(u_i\)`不能直接观测得到，所以第一个条件的检验往往不是很直接。

---

## 豪斯曼检验：偏误模型和2SLS

给定如下的**“偏误回归模型”**：

`$$\begin {align} 
Y_{1i} &amp; =\beta_{1}+\beta_{2} Y_{2i}+\lambda_{1} Z_{1i} +\lambda_{2} Z_{2i}+u_{i} &amp;&amp; \text{(stucture eq.)}
\end {align}$$`

- 仅有1个疑似**内生变量**
`\(Y_{2i}\)`；2个**外生变量**
`\(Z_{1i};Z_{2i}\)`。

- 假定已经找到了变量
`\(Y_{2i}\)`的两个理想**工具变量**
`\(Z_{3i};Z_{4i}\)`。

我们可以利用**两阶段最小二乘法**（2SLS）方法进行估计：

`$$\begin{align}
Y_{2i} &amp;=  \pi_{0}  + \pi_{1}Z_{1i}  + \pi_{2}Z_{2i} + \pi_{3}Z_{3i} + \pi_{4}Z_{4i} +v_i  &amp;&amp; \text{( 1st eq. / reduce eq. )} \\
Y_{1i} &amp; =\alpha_{1}+\alpha_{2} \hat{Y}_{2i}+\gamma_{1} Z_{1i} +\gamma_{2} Z_{2i} + \epsilon_i &amp;&amp; \text{( 2st eq. )}
\end{align}$$`

---

## 豪斯曼检验：基本思想

**豪斯曼检验**（Hausman Test）的基本思想是：

- 如果疑似**内生变量**
`\(Y_{2i}\)`与随机干扰项
`\(u_i\)`**不相关**。那么以上模型符合**CLRM假设**，就可以直接使用**OLS估计**。而且使用OLS估计和使用**2SLS估计**结果应该是**一致的**（why？）。

- 如果疑似**内生变量**
`\(Y_{2i}\)`与随机干扰项
`\(u_i\)`**相关**。那么使用OLS估计和使用**2SLS估计**结果应该是有**差异的**（why？）。

- 如果有差异，将表明
`\(Y_{2i}\)`必定是**内生的**（其中
`\(Z_{ki}  \quad (k \in 1, 2, 3, 4)\)`仍旧保持**外生的**）。而且，理论上可以证明
`\(Z_{ki} \quad (k \in 1, 2, 3, 4)\)`与
`\(u_i\)`不相关的**充要条件**是
`\(v_i\)`与
`\(u_i\)`不相关，也即：

&gt; 若
`\(cov(u_i,v_i)=0\)`，则
`\(cov(Z_{ki},u_i)=0 \quad (k \in 1, 2, 3, 4)\)`。

---

## 豪斯曼检验：分析模型

为了证实上述观点，**豪斯曼**（Hausman）提出构建如下的回归模型，并检验
`\(H_0: \delta=0; H_1:\delta \neq 0\)`。


`$$\begin{align}
u_i &amp; = \delta v_i + \varepsilon_i &amp;&amp; \leftarrow [cov(v_i, \varepsilon_i)=0; E(\varepsilon_i)=0]
\end{align}$$`


`$$\begin{align}
Y_{1i} &amp; =\beta_{1}+\beta_{2} Y_{2i}+\lambda_{1} Z_{1i} +\lambda_{2} Z_{2i}+\delta v_{i} + \epsilon_i \\
&amp; \leftarrow \left[ v_i   = Y_{2i}- \pi_{0}  - \pi_{1}Z_{1i}  - \pi_{2}Z_{2i} + \pi_{3}Z_{3i} - \pi_{4}Z_{4i}  = Y_{2i}- E({Y}_{2i})  \right ]
\end{align}$$`


因为
`\(v_i\)`不能观测得到，实际上使用的是**约简方程**的残差
`\(\hat{v}_i\)`，最终估计如下的**豪斯曼检验方程**：


`$$\begin{align}
Y_{1i} &amp; =\beta_{1}+\beta_{2} Y_{2i}+\lambda_{1} Z_{1i} +\lambda_{2} Z_{2i}+\delta \hat{v}_{i} + \varepsilon_i \\
&amp;\leftarrow \left[ \hat{v}_i   = Y_{2i}- \hat{\pi}_{0}  - \hat{\pi}_{1}Z_{1i}  - \hat{\pi}_{2}Z_{2i} + \hat{\pi}_{3}Z_{3i} - \hat{\pi}_{4}Z_{4i}  = Y_{2i}- \hat{Y}_{2i} \right ]
\end{align}$$`

---

## 豪斯曼检验：操作过程

**步骤1**：明确**外生变量**（
`\(Z_{1i},Z_{2i}\)`）；**疑似内生变量**（
`\(Y_{2i}\)`）及其**工具变量**（
`\(Z_{3i};Z_{4i}\)`）：

`$$\begin {align} 
Y_{1i} &amp; =\beta_{1}+\beta_{2} Y_{2i}+\lambda_{1} Z_{1i} +\lambda_{2} Z_{2i}+u_{i} &amp;&amp; \text{(stucture eq.)} \\
Y_{2i} &amp;=  \pi_{0}  + \pi_{1}Z_{1i}  + \pi_{2}Z_{2i} + \pi_{3}Z_{3i} + \pi_{4}Z_{4i} +v_i  &amp;&amp; \text{( 1st eq. / reduce eq. )} \\
Y_{1i} &amp; =\alpha_{1}+\alpha_{2} \hat{Y}_{2i}+\gamma_{1} Z_{1i} +\gamma_{2} Z_{2i} + \epsilon_i &amp;&amp; \text{( 2st eq. )}
\end {align}$$`


**步骤2**：采用**OLS方法**估计**约简方程**并得到残差
`\(\hat{v}_i\)`：

`$$\begin{align}
\hat{v}_i   = Y_{2i}- \hat{\pi}_{0}  - \hat{\pi}_{1}Z_{1i}  - \hat{\pi}_{2}Z_{2i} + \hat{\pi}_{3}Z_{3i} - \hat{\pi}_{4}Z_{4i}  = Y_{2i}- \hat{Y}_{2i} 
\end{align}$$`

---

## 豪斯曼检验：操作过程

**步骤3**：采用**OLS方法**估计**豪斯曼检验方程**：

`$$\begin{align}
Y_{1i} &amp; =\beta_{1}+\beta_{2} Y_{2i}+\lambda_{1} Z_{1i} +\lambda_{2} Z_{2i}+\delta \hat{v}_{i} + \varepsilon_i
\end{align}$$`

**步骤4**：做出判断并得到**内生性检验**的结论：

给出检验假设：
`\(H_0: \delta=0; H_1:\delta \neq 0\)`。在给定置信水平
`\(\alpha\)`，对**豪斯曼检验方程**中的
`\(\delta\)`进行t检验（需要进行**异方差矫正**）：

- 如果t检验**显著**，则拒绝原假设
`\(H_0\)`，表明
`\(Y_{2i}\)`是**内生的**。

- 如果t检验结果**不显著**，则不能拒绝原假设
`\(H_0\)`，表明
`\(Y_{2i}\)`是**外生的**。

---

class: middle, center, duke-orange

## 已婚女性的教育回报案例




---

## 案例：明确变量和模型

如果认为工作经历
`\(exper\)`是**明确外生变量**。认为已婚女性的受教育年数
`\(educ\)`为**疑似内生变量**，如果找到它的2个**工具变量**分别为母亲受教育年数
`\(motheduc\)`和父亲受教育年数
`\(fatheduc\)`：

`$$\begin {align} 
log(wage_i) &amp; =\beta_1+\beta_2 educ_i+\lambda_1 exper_i +\lambda_{2} exper^2_i+u_{i} &amp;&amp; \text{(stucture eq.)} \\
educ_i &amp;=  \pi_{0}  + \pi_{1}exper_i  + \pi_{2}exper^2_i &amp;&amp; \\
&amp;+ \pi_{3}motheduc_{i} + \pi_{4}fatheduc_{i} +v_i  &amp;&amp; \text{( 1st eq. / reduce eq. )} \\
log(wage_i)  &amp; =\alpha_{1}+\alpha_{2} \widehat{educ}_i+\gamma_{1} exper_i +\gamma_{2} exper^2_i+ \epsilon_i &amp;&amp; \text{( 2st eq. )}
\end {align}$$`

---

## 案例：估计简约方程

采用**OLS方法**估计**约简方程**并得到残差
`\(\hat{v}_i\)`：

`$$\begin{align}
\hat{v}_i   = Y_{2i}- \hat{\pi}_{0}  - \hat{\pi}_{1}Z_{1i}  - \hat{\pi}_{2}Z_{2i} + \hat{\pi}_{3}Z_{3i} - \hat{\pi}_{4}Z_{4i}  = Y_{2i}- \hat{Y}_{2i} 
\end{align}$$`

对以上**约简方程**进行OLS回归，估计结果为：

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{educ}=&amp;&amp;+9.10&amp;&amp;+0.05exper&amp;&amp;-0.00I(exper^2)&amp;&amp;+0.19fatheduc&amp;&amp;+0.16motheduc\\ &amp;\text{(t)}&amp;&amp;(21.3396)&amp;&amp;(1.1236)&amp;&amp;(-0.8386)&amp;&amp;(5.6152)&amp;&amp;(4.3906)\\&amp;\text{(se)}&amp;&amp;(0.4266)&amp;&amp;(0.0403)&amp;&amp;(0.0012)&amp;&amp;(0.0338)&amp;&amp;(0.0359)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.2115;&amp;&amp; \bar{R^2}=0.2040\\&amp; &amp;&amp; F^{\ast}=28.36;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

---

## 案例：估计简约方程的残差数据

<div id="htmlwidget-4e9335281f7d76869a6d" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-4e9335281f7d76869a6d">{"x":{"filter":"none","caption":"<caption>已婚女性的教育回报数据n=(428)<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428"],[3.35400009155273,1.3889000415802,4.54549980163574,1.09650003910065,4.59180021286011,4.74209976196289,8.33329963684082,7.84310007095337,2.12619996070862,4.6875,4.06300020217896,4.59180021286011,2.08330011367798,2.26679992675781,3.67969989776611,1.34720003604889,3.21429991722107,5.17500019073486,2,7.5528998374939,3.50519990921021,3.57139992713928,3.25,3.25,2.15450000762939,3.7878999710083,4,4.72690010070801,7.25589990615845,5.86709976196289,1.53849995136261,2.45900011062622,5.85109996795654,3.57139992713928,3.80679988861084,2.46379995346069,2.37529993057251,4.53509998321533,5.61829996109009,14.6309995651245,2.67860007286072,3.91939997673035,2.57290005683899,4.53749990463257,2,3.4721999168396,2.01609992980957,4.57159996032715,2.27270007133484,2.63750004768372,2.28990006446838,1.09889996051788,1.1764999628067,1.60000002384186,1.87619996070862,4.04370021820068,9.63539981842041,8.04090023040771,4.59899997711182,2.14289999008179,4.40000009536743,3.53539991378784,2.71740007400513,6.25,11.9329996109009,3.59310007095337,6.9443998336792,2.91669988632202,3.07690000534058,3.75,5.72590017318726,3.67569994926453,5.16480016708374,8.22369956970215,4.33650016784668,4.98190021514893,0.357100009918213,2.96740007400513,1,2.55539989471436,0.860199987888336,1,2.92610001564026,3.54609990119934,1.62639999389648,8.33329963684082,3.0952000617981,2.70000004768372,5.25209999084473,1.41540002822876,4.79860019683838,1.66670000553131,1.12170004844666,0.5,0.714299976825714,2.79609990119934,4.85830020904541,1.74349999427795,2.46309995651245,2.42129993438721,1.53450000286102,2.88179993629456,2.40689992904663,5.23260021209717,3.75,1.3889000415802,4,3.23130011558533,3.40140008926392,1.33329999446869,9.30230045318604,4.5,4.62349987030029,3.9556999206543,5.81400012969971,0.5,4.08160018920898,6,3.66669988632202,3.86129999160767,2.76290011405945,2.93099999427795,4.38840007781982,5.41669988632202,9.86110019683838,0.16159999370575,0.382600009441376,3.63639998435974,2.37470006942749,4.66669988632202,1.85189998149872,5.19999980926514,3.2985999584198,8.53330039978027,2.06349992752075,2.56410002708435,2.1875,6.25,3.33330011367798,4.4443998336792,6.63350009918213,8.42240047454834,4.39559984207153,2.44569993019104,1.22449994087219,1.625,3,4.72690010070801,1.12929999828339,7.40240001678467,4.45949983596802,2.47250008583069,1.88240003585815,4,8.1899995803833,7.09679985046387,1.66670000553131,3.4449999332428,4.23470020294189,2.7778000831604,1.88919997215271,5.03520011901855,1.25,2.85710000991821,4.11670017242432,1.77779996395111,13.5539999008179,4.56269979476929,2.12770009040833,2.98909997940063,2.56539988517761,5.6121997833252,2.80539989471436,1.60699999332428,2.25,2.03250002861023,5.53200006484985,1.58449995517731,3.7878999710083,3,8.65380001068115,4.21049976348877,4.6875,4.0984001159668,25,2.6331000328064,6,5.41260004043579,0.664200007915497,1.25,2.27539992332458,3.4614999294281,4.16669988632202,4.46869993209839,1.75,3.66939997673035,6.58260011672974,2.59999990463257,4.86509990692139,5.78700017929077,4.54080009460449,9.50570011138916,10.6379995346069,1.1110999584198,4.05410003662109,2.68709993362427,2.97620010375977,3.17280006408691,3.54999995231628,17.9069995880127,3.41739988327026,3.33330011367798,3.88599991798401,2.31110000610352,1.71080005168915,2.1143000125885,9.9330997467041,3.02769994735718,1.86049997806549,0.128199994564056,6.63269996643066,5.63910007476807,1.59899997711182,2.66669988632202,7.92080020904541,5.33979988098145,4,6.04489994049072,6.25,2.97620010375977,4.23390007019043,3.49160003662109,4.96449995040894,2.76920008659363,3.65849995613098,5.39349985122681,0.6564000248909,4.76879978179932,8.555100440979,10.4589996337891,2.63750004768372,6.84929990768433,5.08720016479492,0.961499989032745,4.30660009384155,7.06669998168945,2.52530002593994,7.894700050354,4.14890003204346,8.17459964752197,9.59710025787354,2.01640009880066,7.6217999458313,3.19749999046326,1.60000002384186,4.0984001159668,1.4815000295639,3.63639998435974,1,2.60419988632202,1.75,4.80000019073486,5.53000020980835,4.0984001159668,1.25,1.66670000553131,3.79010009765625,2.36360001564026,10.2040004730225,6.81820011138916,7.21460008621216,2.44840002059937,1.19869995117188,1.64100003242493,1.7820999622345,2.94120001792908,4.96890020370483,1.86049997806549,8.03569984436035,3.97160005569458,3.04159998893738,2.90700006484985,3.06119990348816,4.89659976959229,4.01609992980957,5.5556001663208,1.22269999980927,2.68390011787415,2.67379999160767,9.32940006256104,3.13809990882874,0.542599976062775,8.61110019683838,3.6686999797821,2.31850004196167,2.88199996948242,3.16659998893738,3.64580011367798,6.25,10.2489995956421,3.20959997177124,7.65220022201538,1.97239995002747,4.69799995422363,2.12339997291565,2.33330011367798,2.38960003852844,1.25639998912811,1.09379994869232,3.75,3.30719995498657,5.13520002365112,6.63269996643066,4.5644998550415,11.8479995727539,3.75,4.36509990692139,3.93330001831055,3.33330011367798,3.31590008735657,3.56159996986389,1.60000002384186,2.22550010681152,4.78719997406006,5.80649995803833,2.3585000038147,2,1.89999997615814,5.1230001449585,5.49450016021729,6.32180023193359,7.14289999008179,2.375,2.54290008544922,2.17980003356934,2.59999990463257,3.72939991950989,4.375,4.44329977035522,4.28770017623901,1.66670000553131,3.2558000087738,5.41130018234253,2.20499992370605,4.0625,0.64819997549057,5.38259983062744,0.170900002121925,23.4669990539551,9.57849979400635,3.69479990005493,2.2221999168396,1.74899995326996,1.15939998626709,6.99009990692139,3.96830010414124,21.4290008544922,0.476200014352798,2.15050005912781,1.85780000686646,4.32950019836426,8.9286003112793,2.7778000831604,2.65650010108948,2.5,18.2670001983643,0.819000005722046,2,15.3850002288818,6.47749996185303,8.33329963684082,4.55030012130737,2.49580001831055,4.47970008850098,2.23239994049072,2.07100009918213,1.67599999904633,3.40910005569458,2.5,3.96090006828308,6.22749996185303,3.92860007286072,2.90000009536743,4.08160018920898,2.84999990463257,7.01529979705811,2.93880009651184,1.92309999465942,6.875,3.90019989013672,2,4.97629976272583,1.20190000534058,22.5,6.86770009994507,3.56130003929138,1.97920000553131,5.3713002204895,1.7441999912262,5.09479999542236,2.5,3.82500004768372,1,3.07170009613037,1.71630001068115,4.02089977264404,5.45849990844727,25,2.38969993591309,3.21339988708496,3.37700009346008,1.77779996395111,3.16330003738403,2.70269989967346,1.69270002841949,0.213699996471405,6.76690006256104,1.74070000648499,2.5,4.48589992523193,2.57200002670288,3.46000003814697,4.78259992599487,2.31180000305176,5.3060998916626,5.86749982833862,3.40910005569458,4.08160018920898],[12,12,12,12,14,12,16,12,12,12,12,11,12,12,10,11,12,12,12,12,16,12,13,12,12,17,12,12,17,12,11,16,13,12,16,11,12,10,14,17,12,12,16,12,12,12,16,12,12,12,12,12,12,8,10,16,14,17,14,12,14,12,8,12,12,8,17,12,12,12,12,12,9,10,12,12,12,17,15,12,6,14,12,14,9,17,13,9,15,12,12,12,12,12,12,12,12,13,12,13,12,12,12,16,12,13,11,12,12,12,17,14,16,17,12,11,12,12,17,10,13,11,12,16,17,12,16,12,16,8,12,12,12,13,11,12,12,14,12,12,12,17,14,12,9,12,12,12,14,16,17,15,12,16,17,17,12,16,13,12,11,16,14,16,12,9,17,14,12,12,11,12,12,10,12,5,17,11,12,12,14,11,12,14,12,10,16,13,12,12,12,11,12,9,13,12,12,12,13,16,12,16,17,12,12,9,12,12,13,12,12,12,12,10,12,16,12,11,12,10,12,12,12,12,16,17,12,17,12,12,12,8,12,13,12,12,8,12,17,17,12,13,12,12,12,12,9,10,12,16,13,8,16,13,12,11,13,12,12,10,12,17,15,16,10,11,12,12,14,16,14,8,7,12,12,14,12,12,12,14,16,12,12,12,13,13,10,12,12,12,12,14,17,10,9,12,12,16,12,17,12,17,11,16,11,13,11,8,11,12,10,17,12,12,17,14,12,12,12,12,12,12,9,10,12,12,12,12,12,17,12,17,12,10,12,12,12,12,12,12,16,13,13,12,16,17,12,14,12,17,12,14,12,12,17,16,16,12,9,12,12,16,14,12,12,11,12,16,17,17,14,12,14,12,10,12,13,16,12,7,16,14,12,10,12,16,10,12,14,12,6,15,12,17,14,13,6,16,14,15,14,8,14,12,12,12,12,12,12,8,12,17,12,12,14,13,17,8,12,11,12,12,17,10,12,13,12,12],[7,7,7,7,14,7,7,3,7,7,3,7,16,10,7,10,7,12,7,7,16,10,3,7,7,14,7,7,12,12,7,3,10,14,12,3,3,3,7,17,12,9,16,3,7,7,16,10,7,7,7,3,7,7,3,12,7,17,7,7,3,12,7,7,7,12,16,7,7,7,12,10,9,0,10,14,7,3,12,12,7,17,3,7,7,12,7,7,12,10,0,12,10,7,7,7,3,12,7,12,7,7,10,14,7,12,7,7,10,7,12,7,7,17,7,7,7,10,10,12,7,12,7,10,7,10,7,7,7,7,7,7,16,12,7,3,7,7,7,12,7,12,12,14,7,7,7,12,12,14,10,12,7,16,7,17,3,10,9,7,3,16,12,7,7,7,12,3,7,7,7,7,10,10,7,12,17,10,7,7,12,7,12,7,7,7,7,14,7,12,7,7,12,3,7,12,12,7,7,14,12,17,17,7,7,10,7,7,7,3,0,7,12,7,7,12,7,7,12,7,7,3,7,7,10,12,7,12,7,7,7,7,12,7,7,7,7,7,14,17,7,10,7,7,12,7,7,9,7,14,7,3,16,3,16,7,16,12,7,7,12,12,12,16,7,9,7,12,12,10,7,12,7,7,3,10,17,7,3,3,12,7,7,7,10,7,10,7,9,9,12,12,12,7,9,12,7,12,7,12,12,14,7,14,10,12,7,7,12,7,7,12,12,12,12,14,10,7,7,7,7,7,7,7,7,7,12,12,7,14,10,12,7,7,12,7,10,12,10,7,14,7,12,12,7,16,0,12,7,17,7,12,3,7,14,7,12,12,7,7,14,7,12,12,7,7,7,7,3,12,7,7,14,10,10,10,10,12,3,7,16,7,7,0,7,7,10,7,12,7,7,7,7,16,12,10,7,7,16,7,7,7,12,10,10,10,7,10,12,12,7,17,12,16,10,16,7,7,9,3,7,7,7,7,7,7,16,12],[12,7,12,7,12,14,14,3,7,7,12,14,16,10,7,16,10,12,7,12,10,12,7,7,12,16,3,3,12,12,7,3,12,7,12,10,3,10,7,14,12,9,14,3,12,12,14,10,7,12,7,7,12,7,7,12,7,17,17,12,14,12,7,7,7,12,12,12,7,12,12,10,7,0,7,12,7,3,10,7,12,12,7,7,7,7,7,7,7,10,7,12,10,12,7,7,7,14,7,12,12,7,7,14,12,10,7,7,7,7,12,7,12,10,10,7,7,7,12,7,7,12,14,12,7,10,7,7,12,10,7,7,12,10,7,12,7,7,7,7,3,12,16,7,3,12,7,12,12,16,12,12,7,14,7,10,7,14,7,7,12,12,17,7,7,3,12,7,7,7,3,7,10,10,12,7,14,10,7,7,10,12,12,7,7,7,12,7,12,12,12,10,12,10,12,12,12,7,12,12,12,12,16,7,16,7,7,10,12,10,0,7,12,12,10,12,3,7,12,10,7,7,7,7,12,12,7,12,7,10,10,7,12,17,7,7,7,7,12,14,7,12,7,7,16,7,10,12,7,16,10,3,16,7,12,7,7,7,12,12,7,10,14,16,7,10,7,14,14,12,7,7,3,7,7,7,12,10,7,3,12,7,12,7,10,7,0,7,10,9,12,12,12,3,9,12,12,14,7,12,12,12,7,12,10,12,7,7,3,12,7,16,12,12,7,14,7,7,12,10,7,3,7,7,10,7,7,12,12,12,10,14,7,7,14,10,10,7,7,7,14,7,12,14,14,14,0,16,7,12,7,10,7,10,10,14,7,12,7,7,12,14,12,7,7,7,12,16,3,16,7,16,7,10,10,10,10,12,10,7,16,7,7,7,7,7,10,10,12,7,7,7,7,14,14,7,7,7,16,12,7,7,12,12,12,10,3,12,12,12,7,16,12,10,10,12,7,7,7,7,7,7,7,7,7,7,12,12],[14,5,15,6,7,33,11,35,24,21,15,14,0,14,6,9,20,6,23,9,5,11,18,15,4,21,31,9,7,7,32,11,16,14,27,0,17,28,24,11,1,14,6,10,6,4,10,22,16,6,12,32,15,17,34,9,37,10,35,6,19,10,11,15,12,12,14,11,9,24,12,13,29,11,13,19,2,24,9,6,22,30,10,6,29,29,36,19,8,13,16,11,15,6,13,22,24,2,6,2,2,14,9,11,9,6,19,26,19,3,7,28,13,9,15,20,29,9,1,8,19,23,3,13,8,17,4,15,11,7,0,0,10,8,2,4,6,18,3,22,33,28,23,27,11,6,11,14,17,17,14,11,7,8,6,8,4,25,24,11,19,9,19,14,22,6,23,15,6,11,2,22,10,14,12,9,13,18,8,11,9,9,14,9,2,12,15,11,7,9,19,11,8,13,4,7,19,14,14,3,9,7,7,14,29,19,14,16,10,12,24,6,9,14,26,7,4,15,23,1,29,9,6,11,17,6,7,2,24,4,11,25,11,2,19,7,2,20,10,19,17,12,11,6,10,4,2,13,21,9,4,2,19,4,9,14,6,24,1,13,3,10,16,9,19,4,10,5,7,3,38,16,13,1,7,15,10,2,19,25,25,7,15,11,25,19,4,14,19,18,14,11,4,29,21,24,19,31,28,15,27,13,4,10,8,4,18,3,11,8,10,33,19,35,21,7,18,4,12,16,14,3,1,27,12,6,9,2,6,9,16,22,26,11,11,15,13,6,20,17,8,13,15,14,14,6,24,10,2,9,23,12,8,16,10,7,19,2,9,14,9,16,7,6,22,9,9,14,17,12,13,8,10,16,1,6,4,8,4,15,7,14,16,15,23,19,4,12,12,25,14,14,11,7,18,4,37,13,14,17,5,2,0,3,21,20,19,4,19,11,14,8,13,24,1,1,3,4,21,10,13,9,14,2,21,22,14,7],[12.756017473225,11.7335580528393,12.7719792588351,11.7676834756791,13.9146147514322,13.0293763579735,13.0112170904032,10.4908298336813,12.0368319794436,12.0373829885555,12.0137856182153,13.0712115387216,14.6569671960569,13.009468638192,11.7676834756791,13.8449691779147,12.5063213926766,13.5034106901968,12.0390338310619,12.6459358164555,13.9122848424796,13.2646682553709,11.2615767198185,11.9839940950922,12.485399611828,14.7825951543775,11.3345217935194,11.2275625217181,13.5355179311223,13.5355179311223,11.9465626175807,10.5194560895489,13.3545680929964,13.2948711805661,13.7538445476203,11.2472556675509,10.6212813489564,11.7224402114528,12.0368319794436,14.9067011919528,13.3126017568543,12.6623231952885,14.5767983963138,10.4954215762808,12.555668639422,12.485399611828,14.6931182685297,13.0806538294765,11.9979376987886,12.555668639422,11.9300541925169,11.1883689769609,12.7719792588351,12.0098631205706,11.1456198173517,13.5936778672303,11.8245533542003,15.3554577769305,13.4553819327814,12.555668639422,12.3726450070121,13.6197305624127,11.9080378611631,11.9839940950922,11.9300541925169,13.6657814070346,14.461953164619,12.6960230249061,11.8579506527125,12.8248171431865,13.6657814070346,12.991488670667,12.3746468129467,9.47801976083825,12.5186975724212,14.1424834532194,11.6190726928337,10.6482502078294,13.2784838017331,12.7154255264538,12.8272026645088,14.664708314825,11.1258097072752,11.7676834756791,11.9955499926368,12.9432920434116,11.8529915707051,12.0276594183918,12.7776218263905,12.991488670667,10.6710988277039,13.6437650756808,13.0254304238028,12.555668639422,11.9500523419563,12.0392175007659,11.2786383388237,13.6699939728486,11.7676834756791,13.3547999073514,12.4070578565767,11.9680323094814,12.4265958831774,14.3380559614879,12.6459358164555,13.1882166246996,12.0276594183918,12.0263737304639,12.5963046488566,11.6592526614166,13.5355179311223,12.0078427538269,12.7380375056993,14.2262258525078,12.4567851933379,12.0335302944308,11.9955499926368,12.4265958831774,12.9335049365443,12.7776218263905,12.0276594183918,13.7747610455796,12.7624318906567,13.3066827361641,11.8298797756157,13.0512994492813,11.6974144480851,11.9839940950922,12.6960230249061,12.2725818148503,11.532658209925,11.532658209925,14.3779242030325,13.2504129246363,11.6190726928337,11.7272059712082,11.7676834756791,12.0197703604384,11.6592526614166,12.9869595515406,11.2958089977389,13.7435699683446,14.405149176574,13.3449562041872,11.2776497301687,12.555668639422,11.9080378611631,13.7037595239991,13.7455903350884,14.7550752863927,13.3246627036892,13.6437650756808,11.7997907166046,14.6389946962505,11.7676834756791,14.198154975411,10.9392208074653,13.7044364056159,12.4159287997535,11.9080378611631,12.0574509415149,14.3518715078501,14.5513717966525,11.9680323094814,12.0392175007659,11.1372953446847,13.7747610455796,11.2258004544723,11.7676834756791,11.9080378611631,10.9886845618393,12.0392175007659,12.9254396766056,13.009468638192,12.7180393562598,12.8056927034873,14.948715672746,13.061206689149,11.8298797756157,11.9080378611631,13.2784838017331,12.6459358164555,13.7037595239991,11.8579506527125,11.6190726928337,11.9300541925169,12.7719792588351,13.2348767322478,12.5877758803475,13.5936778672303,12.8156445821347,12.3808289594089,13.5656069901334,11.6646497995823,12.485399611828,13.5355179311223,13.7633866329095,11.9680323094814,12.7560174732244,13.7740766962442,13.5936778672303,14.4832599818971,15.1136481128915,11.9680323094814,13.4139232873742,12.5963046488566,11.9680323094814,12.4707287970344,12.6719885116379,11.6446516501428,9.60681387911872,11.7676834756791,13.5936778672303,12.7560174732244,12.4991648287097,13.5355179311223,11.0670263170907,11.9839940950922,13.7747610455796,12.0496656405823,11.9955499926368,11.0997570120927,11.7676834756791,11.9080378611631,13.3664935147785,13.5034106901968,11.7997907166046,13.3547999073514,12.0368319794436,12.1702055463309,12.3808289594089,12.0326119459109,13.6437650756808,13.1950430203196,12.0276594183918,11.7997907166046,11.6190726928337,12.0335302944308,13.9988273827226,15.0263227491815,12.0098631205706,13.2866845867247,11.9080378611631,11.7676834756791,14.2501186934071,11.6974144480851,12.0918637910795,13.1171343260092,12.0373829885555,14.6031628185345,12.1702055463309,10.2304909212195,15.1519684045237,10.9392208074653,14.3518715078501,11.9680323094814,13.4736191670737,12.9845740302183,12.3648597060795,12.7380375056993,12.6069947121913,13.3045364969155,14.0488589788035,14.9822596388445,12.0276594183918,12.5493023666408,11.884003347895,13.7844793328542,13.8507119966195,13.0158830556244,11.7940969557812,12.9456797495633,11.3196642109619,11.5768745423365,11.0415970759847,12.552639325557,14.5674726131875,12.0918637910795,11.2694657777719,10.6440301742967,13.7683391604286,11.7997907166046,12.7719792588351,11.9080378611631,13.0740482746215,12.0276594183918,11.1628804493098,11.9680323094814,12.8795473369474,12.7140612462455,13.7037595239991,13.6437650756808,13.4331416626028,11.3651618616425,12.7316738743626,13.7725591939613,12.8156445821347,14.0158312045287,12.0078427538269,13.7197213096099,13.7538445476203,14.064876376784,11.6974144480851,13.9988273827226,12.8713161043264,13.4331416626028,12.0197703604384,11.6592526614166,12.2253917809435,12.6178649393587,11.884003347895,14.2923124742454,13.7633866329095,13.6151388198132,12.9851250393303,14.2298088169294,12.5884155909032,11.6974144480851,12.7180393562598,12.4707287970344,11.9680323094814,11.0288645304222,11.5768745423365,12.0181173331026,12.4028452907627,11.7676834756791,12.8056927034873,13.3547999073514,12.555668639422,13.9727746875402,13.0393740274992,14.0901387807808,12.0263737304639,11.9080378611631,13.958959141178,12.4567851933379,12.991488670667,12.7154255264538,12.6021755248957,12.0098631205706,14.2598978759405,11.9500523419563,13.7197213096099,14.0189535894963,13.0712115387216,14.5767983963138,9.60681387911872,14.2501186934071,11.6190726928337,14.541419918005,12.0390338310619,13.3505873415374,11.0716861349959,12.4707287970344,13.6836333172254,12.9029699458447,12.9754014691665,13.3547999073514,11.8579506527125,11.9680323094814,13.9727746875402,13.1011169280287,13.5355179311223,12.7154255264538,12.0392175007659,11.8579506527125,12.6459358164555,13.3864056042188,10.6212813489564,14.296169538029,11.9500523419563,13.2482530703531,13.2108422189797,13.0393740274992,12.6183108710472,12.8091198043897,12.7388507767957,13.5656069901334,11.412011905711,11.9839940950922,14.9240997027365,11.9680323094814,11.9979376987886,10.6571552240075,12.0390338310619,12.0276594183918,12.7388507767957,12.4028452907627,13.6657814070346,12.0326119459109,11.9680323094814,11.9680323094814,11.9080378611631,14.6089056372393,14.0706916404533,12.2660596785499,11.8245533542003,11.9500523419563,15.0923412956133,12.7978482843136,11.7335580528392,11.6190726928337,13.2683854244427,13.0158830556244,13.3940133827633,13.0749666231414,11.3972712873974,13.0540448422929,13.7633866329095,13.6437650756808,11.9680323094814,15.1437371719026,13.6857795564741,14.2155587690839,12.6183108710472,14.0707953974741,11.6592526614166,11.6974144480851,12.4164798088654,11.1258097072752,11.9500523419563,11.8579506527125,11.9680323094814,11.6190726928337,12.0373829885555,12.0392175007659,14.461953164619,13.5355179311223],[-0.756017473224986,0.266441947160748,-0.771979258835125,0.232316524320935,0.0853852485677888,-1.02937635797346,2.98878290959675,1.50917016631872,-0.0368319794435641,-0.0373829885555029,-0.0137856182153079,-2.07121153872156,-2.65696719605691,-1.00946863819205,-1.76768347567907,-2.84496917791472,-0.506321392676582,-1.50341069019682,-0.0390338310618854,-0.645935816455478,2.08771515752038,-1.26466825537093,1.73842328018145,0.0160059049078449,-0.485399611828042,2.21740484562246,0.66547820648063,0.772437478281871,3.4644820688777,-1.5355179311223,-0.946562617580693,5.48054391045111,-0.354568092996403,-1.29487118056608,2.2461554523797,-0.247255667550934,1.37871865104356,-1.72244021145283,1.96316802055644,2.0932988080472,-1.31260175685425,-0.6623231952885,1.42320160368618,1.50457842371923,-0.555668639422042,-0.485399611828042,1.30688173147028,-1.08065382947651,0.00206230121143271,-0.555668639422042,0.0699458074831314,0.811631023039126,-0.771979258835127,-4.00986312057064,-1.14561981735174,2.40632213276975,2.17544664579971,1.64454222306954,0.544618067218578,-0.555668639422042,1.6273549929879,-1.61973056241271,-3.90803786116309,0.0160059049078449,0.0699458074831314,-5.66578140703461,2.53804683538103,-0.696023024906061,0.142049347287493,-0.824817143186536,-1.66578140703461,-0.991488670666953,-3.37464681294674,0.521980239161754,-0.51869757242117,-2.14248345321941,0.380927307166296,6.35174979217063,1.72151619826694,-0.715425526453844,-6.82720266450884,-0.664708314824981,0.87419029272485,2.23231652432093,-2.99554999263683,4.05670795658839,1.14700842929494,-3.02765941839175,2.22237817360952,-0.991488670666953,1.32890117229612,-1.64376507568084,-1.0254304238028,-0.555668639422042,0.0499476580436942,-0.0392175007658651,0.721361661176255,-0.669993972848638,0.23231652432093,-0.354799907351449,-0.407057856576675,0.0319676905185988,-0.426595883177371,1.66194403851207,-0.645935816455478,-0.188216624699627,-1.02765941839175,-0.0263737304638966,-0.596304648856618,0.340747338583442,3.4644820688777,1.99215724617314,3.26196249430072,2.77377414749216,-0.456785193337938,-1.0335302944308,0.00445000736316756,-0.426595883177371,4.06649506345566,-2.77762182639048,0.972340581608246,-2.77476104557963,-0.762431890656718,2.69331726383586,5.1701202243843,-1.05129944928129,4.30258555191493,0.0160059049078449,3.30397697509394,-4.27258181485034,0.46734179007503,0.46734179007503,-2.37792420303253,-0.25041292463626,-0.619072692833704,0.272794028791777,0.23231652432093,1.98022963956163,0.340747338583442,-0.986959551540639,0.704191002261081,3.25643003165539,-0.405149176574008,-1.34495620418723,-2.27764973016871,-0.555668639422042,0.0919621388369104,-1.70375952399915,0.254409664911617,1.24492471360733,3.67533729631076,1.35623492431916,0.200209283395443,1.36100530374954,5.23231652432093,2.80184502458897,1.06077919253475,2.29556359438407,0.584071200246526,0.0919621388369104,-1.05745094151491,1.64812849214993,-0.551371796652471,4.0319676905186,-0.0392175007658651,-2.13729534468469,3.22523895442037,2.77419954552766,0.23231652432093,0.0919621388369104,0.0113154381606739,-0.0392175007658651,-0.925439676605616,-3.00946863819205,-0.71803935625984,-7.80569270348728,2.05128432725399,-2.06120668914901,0.170120224384297,0.0919621388369104,0.721516198266936,-1.64593581645548,-1.70375952399915,2.14204934728749,0.380927307166296,-1.93005419251687,3.22802074116487,-0.234876732247773,-0.587775880347529,-1.59367786723025,-0.815644582134726,-1.38082895940887,-1.56560699013345,-2.66464979958227,0.514600388171958,-1.5355179311223,-1.7633866329095,0.0319676905185988,0.243982526775627,2.22592330375579,-1.59367786723025,1.51674001810292,1.88635188710855,0.0319676905185988,-1.41392328737418,-3.59630464885662,0.0319676905185988,-0.47072879703435,0.328011488362059,0.355348349857167,2.39318612088128,0.23231652432093,-1.59367786723025,-2.75601747322437,-0.49916482870968,2.4644820688777,0.932973682909307,-0.983994095092155,-1.77476104557963,-2.04966564058229,0.00445000736316756,0.900242987907312,0.23231652432093,0.0919621388369104,2.63350648522153,3.49658930980318,0.200209283395443,3.64520009264855,-0.0368319794435641,-0.170205546330853,-0.380828959408873,-4.0326119459109,-1.64376507568084,-0.195043020319647,-0.0276594183917537,0.200209283395443,-3.6190726928337,-0.0335302944307991,3.00117261727738,1.97367725081854,-0.00986312057063796,-0.286684586724705,0.0919621388369104,0.23231652432093,-2.25011869340709,0.30258555191493,-3.09186379107949,-3.11713432600919,-0.0373829885555029,1.39683718146546,0.829794453669147,-2.23049092121951,0.848031595476304,2.06077919253475,-2.35187150785007,-0.968032309481401,-0.473619167073663,-0.984574030218338,-0.364859706079479,-2.73803750569928,-0.606994712191332,3.69546350308447,0.951141021196498,1.01774036115555,-2.02765941839175,-1.54930236664076,0.115996652105031,-1.78447933285418,0.149288003380509,2.98411694437561,2.20590304421881,-4.94567974956334,-4.31966421096193,0.423125457663492,0.958402924015262,1.44736067444298,-2.56747261318749,-0.0918637910794867,0.730534222228065,3.3559698257033,2.23166083957135,0.200209283395443,-0.771979258835127,0.0919621388369104,-0.0740482746215486,0.972340581608246,-1.16288044930977,0.0319676905185988,-0.879547336947446,-0.714061246245465,-1.70375952399915,0.356234924319165,3.56685833739718,-1.36516186164246,-3.7316738743626,-1.77255919396131,-0.815644582134726,1.98416879547132,-0.00784275382686224,3.2802786903901,-1.7538445476203,2.93512362321604,-0.69741444808507,2.00117261727738,-1.87131610432635,-0.433141662602816,-1.01977036043837,-3.65925266141656,-1.22539178094349,-0.617864939358674,-1.88400334789497,2.70768752575458,-1.7633866329095,-1.61513881981322,4.01487496066972,-0.229808816929401,-0.588415590903231,0.30258555191493,-0.71803935625984,-0.47072879703435,0.0319676905185988,0.97113546957782,-2.57687454233651,-2.01811733310255,-0.402845290762652,0.23231652432093,-0.805692703487281,-1.35479990735145,-0.555668639422042,3.02722531245984,-1.03937402749921,2.9098612192192,-0.0263737304638966,-1.90803786116309,-1.95895914117802,-0.456785193337938,-0.991488670666953,-0.715425526453844,-0.602175524895664,-0.00986312057063796,1.74010212405945,1.04994765804369,-0.719721309609901,-2.01895358949634,2.92878846127844,2.42320160368618,2.39318612088128,-0.250118693407092,0.380927307166296,2.45858008199497,-0.0390338310618854,0.649412658462575,0.928313865004116,-0.47072879703435,3.31636668277456,3.09703005415528,3.02459853083347,-1.35479990735145,-2.85795065271251,0.0319676905185988,-1.97277468754016,2.89888307197127,0.464482068877697,-0.715425526453844,-0.0392175007658651,-0.857950652712507,-0.645935816455478,2.61359439578125,6.37871865104356,2.70383046197101,2.04994765804369,-1.24825307035305,0.789157781020347,-1.03937402749921,-2.61831087104715,-0.809119804389717,0.261149223204283,2.43439300986655,0.587988094288966,-4.98399409509215,1.0759002972635,2.0319676905186,0.00206230121143271,-0.657155224007472,-0.0390338310618854,3.97234058160825,-2.73885077679572,-0.402845290762652,0.334218592965386,-0.0326119459109012,-5.9680323094814,3.0319676905186,0.0919621388369104,2.39109436276069,-0.0706916404533011,0.733940321450066,-5.82455335420029,4.04994765804369,-1.09234129561334,2.20215171568639,2.26644194716076,-3.6190726928337,0.731614575557284,-1.01588305562439,-1.39401338276334,-1.07496662314145,0.602728712602624,-1.05404484229291,-1.7633866329095,-5.64376507568083,0.0319676905185988,1.8562628280974,-1.68577955647405,-2.21555876908394,1.38168912895284,-1.07079539747407,5.34074733858344,-3.69741444808507,-0.416479808865412,-0.12580970727515,0.0499476580436942,0.142049347287493,5.0319676905186,-1.6190726928337,-0.0373829885555029,0.960782499234135,-2.46195316461897,-1.5355179311223]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>wage<\/th>\n      <th>educ<\/th>\n      <th>fatheduc<\/th>\n      <th>motheduc<\/th>\n      <th>exper<\/th>\n      <th>educ.hat<\/th>\n      <th>vi.hat<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":8,"scrollX":true,"scrollCollapse":true,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100],"rowCallback":"function(row, data) {\nDTWidget.formatRound(this, row, data, 1, 4, 3, \",\", \".\");\nDTWidget.formatRound(this, row, data, 6, 4, 3, \",\", \".\");\nDTWidget.formatRound(this, row, data, 7, 4, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>

---

## 案例：估计豪斯曼检验方程

为了检验
`\(educ_i\)`是否为**内生变量**，构建如下**豪斯曼检验模型**：

`$$\begin{align}
log(wage_i) &amp; =\beta_{1}+\beta_{2} educ_i+\lambda_{1} exper_i +\lambda_{2} exper^2_i+\delta \hat{v}_{i} + \varepsilon_i
\end{align}$$`

对以上**豪斯曼检验方程**进行OLS回归，估计结果为：

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{log(wage)}=&amp;&amp;+0.05&amp;&amp;+0.06educ&amp;&amp;+0.04exper&amp;&amp;-0.00I(exper^2)&amp;&amp;+0.06vi.hat\\ &amp;\text{(t)}&amp;&amp;(0.1219)&amp;&amp;(1.9815)&amp;&amp;(3.3363)&amp;&amp;(-2.2706)&amp;&amp;(1.6711)\\&amp;\text{(se)}&amp;&amp;(0.3946)&amp;&amp;(0.0310)&amp;&amp;(0.0132)&amp;&amp;(0.0004)&amp;&amp;(0.0348)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.1624;&amp;&amp; \bar{R^2}=0.1544\\&amp; &amp;&amp; F^{\ast}=20.50;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

---

## 案例：得出豪斯曼检验结论

可以看到
`\(\hat{v}_i\)`（也即`vi.hat`）前的系数
`\(\delta\)`对应的t样本统计量值为`1.6711`。


- 若给定置信水平
`\(\alpha=0.05\)`，查t表可知
`\(t_{1-\alpha/2}(n-k)=t_{0.975}(428-5)=\)` 1.9656。因此
`\(t^{\ast} &lt; t_{1-\alpha/2}(n-k)\)`，不能拒绝原假设
`\(H_0\)`，认为模型中的
`\(educ\)`是**外生的**。

- 若给定置信水平
`\(\alpha=0.1\)`，查t表可知
`\(t_{1-\alpha/2}(n-k)=t_{0.95}(428-5)=\)` 1.6485。因此
`\(t^{\ast} &gt; t_{1-\alpha/2}(n-k)\)`，则拒绝原假设
`\(H_0\)`，接受备择假设
`\(H_1\)`，认为模型中的
`\(educ\)`是**内生的**。

- 你如何看待以上的结论？

---

### 案例：豪斯曼检验EViews操作1

&lt;img src="pic/chpt11-mroz2-hausman-step.png" width="546" style="display: block; margin: auto;" /&gt;

---

### 案例：豪斯曼检验EViews操作2

&lt;img src="pic/chpt11-mroz2-hausman-step2.png" width="548" style="display: block; margin: auto;" /&gt;

---

### 案例：豪斯曼检验EViews结果

&lt;img src="pic/chpt11-mroz2-hausman-test.png" width="623" style="display: block; margin: auto;" /&gt;

---
layout:false
class: middle, center, inverse
# 11.6 工具变量的外生性检验

---
layout: true
  
&lt;div class="my-header"&gt;&lt;/div&gt;

&lt;div class="my-footer"&gt;&lt;span&gt;huhuaping@   第11章：内生自变量问题   
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
11.6 工具变量的外生性检验 &lt;/span&gt;&lt;/div&gt; 

---

## 外生性检验的内容

**工具变量**（instrument variable）具备如下**两个性质**：

`$$\begin{align}
Cov(Z_i, u_i) &amp; = 0 &amp;&amp; \text{(instrumental exogeneity)}\\ 
Cov(Z_i, X_i) &amp; \neq 0 &amp;&amp; \text{(instrumental relevance)}
\end{align}$$`


我们现在来检验**第一个**条件：工具变量
`\(Z_i\)`是否真的是**外生性**的？

- 因为
`\(u_i\)`不能直接观测得到，所以第一个条件的检验往往不是很直接。

- 如果只有一个**工具变量**，第一个条件往往不能检验。（为什么？）

---

## 外生性检验：基本思路

考虑如下**分析情形**：有明确的**外生变量**（
`\(Z_{1i},Z_{2i}\)`）；有**疑似内生变量**（
`\(Y_{2i}\)`）及其2个**工具变量**（
`\(Z_{3i};Z_{4i}\)`）。考虑如下的一个**偏误模型**（结构模型）：

`$$\begin {align} 
Y_{1i} &amp; =\beta_{1}+\beta_{2} Y_{2i}+\lambda_{1} Z_{1i} +\lambda_{2} Z_{2i}+u_{i} &amp;&amp; \text{(stucture eq.)} 
\end {align}$$`

- 仅利用工具变量
`\(Z_{3i}\)`时的**2SLS**分析为：

`$$\begin {align} 
Y_{2i} &amp;=  \acute{\pi}_{0}  + \acute{\pi}_{1}Z_{1i}  + \acute{\pi}_{2}Z_{2i} + \acute{\pi}_{3}Z_{3i} +\acute{v}_i  &amp;&amp; \text{( 1st eq. / reduce eq. )} \\
Y_{1i} &amp; =\acute{\alpha}_{1}+\acute{\alpha}_{2} \acute{\hat{Y}}_{2i}+\acute{\gamma}_{1} Z_{1i} +\acute{\gamma}_{2} Z_{2i} + \acute{\epsilon}_i &amp;&amp; \text{( 2st eq. )}
\end {align}$$`


- 仅利用工具变量
`\(Z_{4i}\)`时的**2SLS**分析为：

`$$\begin {align} 
Y_{2i} &amp;=  \grave{\pi}_{0}  + \grave{\pi}_{1}Z_{1i}  + \grave{\pi}_{2}Z_{2i} + \grave{\pi}_{4}Z_{4i} +\grave{v}_i  &amp;&amp; \text{( 1st eq. / reduce eq. )} \\
Y_{1i} &amp; =\grave{\alpha}_{1}+\grave{\alpha}_{2} \grave{\hat{Y}}_{2i}+\grave{\gamma}_{1} Z_{1i} +\grave{\gamma}_{2} Z_{2i}  + \grave{\epsilon}_i &amp;&amp; \text{( 2st eq. )}
\end {align}$$`

---

## 外生性检验：基本思路

- 如果：所有的
`\(Z_{ki}  \quad (k \in 1, 2, 3, 4)\)`都是**外生的**；而且**疑似内生变量**（
`\(Y_i\)`）确实与变量
`\(Z_{3i},Z_{4i}\)`部分相关。

- 那么：两次**2SLS**估计得到的
`\(\acute{\alpha}_2\)`和
`\(\grave{\alpha}_2\)`就都是真值
`\(\alpha_2\)`的**一致估计量**。

- 因此：我们可以基于这两个估计量的差（
`\(\acute{\alpha}_2-\grave{\alpha}_2\)`）来检验
`\(Z_{3i}\)`和
`\(Z_{4i}\)`是否都是**外生的**。——但是我们**很难区分**是哪一个或全部两个都是外生的？

- 然而：假设我们选择工具变量（
`\(Z_{3i},Z_{4i}\)`）的逻辑是相同的，如果一个**不是外生的**，那么另一个往往也**不是外生的**。

---

## 外生性检验：操作过程

**步骤1**：用两阶段法估计**结构方程**（使用2个工具变量），获得2SLS的残差
`\(\hat{u}_i\)`：

`$$\begin {align} 
Y_{1i} &amp; =\beta_{1}+\beta_{2} Y_{2i}+\lambda_{1} Z_{1i} +\lambda_{2} Z_{2i}+u_{i} &amp;&amp; \text{(stucture eq.)} \\
Y_{2i} &amp;=  \pi_{0}  + \pi_{1}Z_{1i}  + \pi_{2}Z_{2i} + \pi_{3}Z_{3i} + \pi_{4}Z_{4i} +v_i  &amp;&amp; \text{( 1st eq. / reduce eq. )} \\
Y_{1i} &amp; =\alpha_{1}+\alpha_{2} \hat{Y}_{2i}+\gamma_{1} Z_{1i} +\gamma_{2} Z_{2i} + \epsilon_i &amp;&amp; \text{( 2st eq. )}
\end {align}$$`

**步骤2**：构建外生性检验模型。将残差
`\(\hat{u}_i\)`对所有外生变量进行回归，并获得判定系数
`\(R^2\)`。

`$$\begin{align}
\hat{u}_{i} &amp; =\lambda_{0}+\lambda_{1} Z_{1i} +\lambda_{2} Z_{2i}+\lambda_{3} Z_{3i} +\lambda_{4} Z_{4i} + \varepsilon_i
\end{align}$$`

---

## 外生性检验：操作过程

**步骤3**：构建**卡方统计量**，根据原假设（
`\(H_0:\)`全部工具变量都是**外生的**）/备择假设（
`\(H_1:\)`部分工具变量不是**外生的**），做出判断并得到假设检验结论。

`$$\begin{align}
{\chi^2}^\ast &amp; = nR^2 \simeq \chi^2(q) &amp;&amp; \leftarrow [q =(n_{iv} -n_{env})]
\end{align}$$`

- 卡方分布的自由度为
`\(q =(n_{iv} -n_{env})\)`，其中
`\(n_{iv}\)`指**工具变量**的个数（也即
`\((mothedu_i,fatheduc_i)\)`），
`\(n_{env}\)`指**内生变量**的个数（也即
`\(edu_i\)`）——（不包括结构模型中的因变量
`\(log(wage_i)\)`）。

- 如果卡方统计量值**大于**查表值，也即
`\({\chi^2}^\ast &gt; \chi^2_{1-\alpha}(q)\)`，则拒绝原假设
`\(H_0\)`，接收备择假设
`\(H_1\)`，表明**至少**部分工具变量**不是外生的**。

- 如果卡方统计量值**小于**查表值，也即
`\({\chi^2}^\ast &lt; \chi^2_{1-\alpha}(q)\)`，则接受原假设
`\(H_0\)`，表明**全部**工具变量**是外生的**。

---
class: middle, center, duke-orange

## 已婚女性的教育回报案例

## 外生性检验

---

## 案例：明确变量和模型

如果认为工作经历
`\(exper\)`是**明确外生变量**。认为已婚女性的受教育年数
`\(educ\)`为**疑似内生变量**，如果找到它的2个**工具变量**分别为母亲受教育年数
`\(motheduc\)`和父亲受教育年数
`\(fatheduc\)`：

`$$\begin {align} 
log(wage_i) &amp; =\beta_1+\beta_2 educ_i+\lambda_1 exper_i +\lambda_{2} exper^2_i+u_{i} &amp;&amp; \text{(stucture eq.)} \\
educ_i &amp;=  \pi_{0}  + \pi_{1}exper_i  + \pi_{2}exper^2_i &amp;&amp; \\
&amp;+ \pi_{3}motheduc_{i} + \pi_{4}fatheduc_{i} +v_i  &amp;&amp; \text{( 1st eq. / reduce eq. )} \\
log(wage_i)  &amp; =\alpha_{1}+\alpha_{2} \widehat{educ}_i+\gamma_{1} exper_i +\gamma_{2} exper^2_i  &amp;&amp; \text{( 2st eq. )}
\end {align}$$`

---

## 案例：两阶段最小二乘法估计（2SLS）

采用**2SLS方法**估计前述**结构方程**并得到残差
`\(\hat{u}_i\)`，`R软件`估计结果为：


```

Call:
ivreg(formula = log(wage) ~ educ + exper + I(exper^2) | exper + 
    I(exper^2) + fatheduc + motheduc, data = mroz)

Residuals:
    Min      1Q  Median      3Q     Max 
-3.0986 -0.3196  0.0551  0.3689  2.3493 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)   
(Intercept)  0.0481003  0.4003281   0.120  0.90442   
educ         0.0613966  0.0314367   1.953  0.05147 . 
exper        0.0441704  0.0134325   3.288  0.00109 **
I(exper^2)  -0.0008990  0.0004017  -2.238  0.02574 * 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.6747 on 424 degrees of freedom
Multiple R-Squared: 0.1357,	Adjusted R-squared: 0.1296 
Wald test: 8.141 on 3 and 424 DF,  p-value: 2.787e-05 
```

---

## 案例：2SLS的残差数据

<div id="htmlwidget-cf77731d8d50c582c031" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-cf77731d8d50c582c031">{"x":{"filter":"none","caption":"<caption>已婚女性的教育回报数据n=(428)<\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30","31","32","33","34","35","36","37","38","39","40","41","42","43","44","45","46","47","48","49","50","51","52","53","54","55","56","57","58","59","60","61","62","63","64","65","66","67","68","69","70","71","72","73","74","75","76","77","78","79","80","81","82","83","84","85","86","87","88","89","90","91","92","93","94","95","96","97","98","99","100","101","102","103","104","105","106","107","108","109","110","111","112","113","114","115","116","117","118","119","120","121","122","123","124","125","126","127","128","129","130","131","132","133","134","135","136","137","138","139","140","141","142","143","144","145","146","147","148","149","150","151","152","153","154","155","156","157","158","159","160","161","162","163","164","165","166","167","168","169","170","171","172","173","174","175","176","177","178","179","180","181","182","183","184","185","186","187","188","189","190","191","192","193","194","195","196","197","198","199","200","201","202","203","204","205","206","207","208","209","210","211","212","213","214","215","216","217","218","219","220","221","222","223","224","225","226","227","228","229","230","231","232","233","234","235","236","237","238","239","240","241","242","243","244","245","246","247","248","249","250","251","252","253","254","255","256","257","258","259","260","261","262","263","264","265","266","267","268","269","270","271","272","273","274","275","276","277","278","279","280","281","282","283","284","285","286","287","288","289","290","291","292","293","294","295","296","297","298","299","300","301","302","303","304","305","306","307","308","309","310","311","312","313","314","315","316","317","318","319","320","321","322","323","324","325","326","327","328","329","330","331","332","333","334","335","336","337","338","339","340","341","342","343","344","345","346","347","348","349","350","351","352","353","354","355","356","357","358","359","360","361","362","363","364","365","366","367","368","369","370","371","372","373","374","375","376","377","378","379","380","381","382","383","384","385","386","387","388","389","390","391","392","393","394","395","396","397","398","399","400","401","402","403","404","405","406","407","408","409","410","411","412","413","414","415","416","417","418","419","420","421","422","423","424","425","426","427","428"],[3.35400009155273,1.3889000415802,4.54549980163574,1.09650003910065,4.59180021286011,4.74209976196289,8.33329963684082,7.84310007095337,2.12619996070862,4.6875,4.06300020217896,4.59180021286011,2.08330011367798,2.26679992675781,3.67969989776611,1.34720003604889,3.21429991722107,5.17500019073486,2,7.5528998374939,3.50519990921021,3.57139992713928,3.25,3.25,2.15450000762939,3.7878999710083,4,4.72690010070801,7.25589990615845,5.86709976196289,1.53849995136261,2.45900011062622,5.85109996795654,3.57139992713928,3.80679988861084,2.46379995346069,2.37529993057251,4.53509998321533,5.61829996109009,14.6309995651245,2.67860007286072,3.91939997673035,2.57290005683899,4.53749990463257,2,3.4721999168396,2.01609992980957,4.57159996032715,2.27270007133484,2.63750004768372,2.28990006446838,1.09889996051788,1.1764999628067,1.60000002384186,1.87619996070862,4.04370021820068,9.63539981842041,8.04090023040771,4.59899997711182,2.14289999008179,4.40000009536743,3.53539991378784,2.71740007400513,6.25,11.9329996109009,3.59310007095337,6.9443998336792,2.91669988632202,3.07690000534058,3.75,5.72590017318726,3.67569994926453,5.16480016708374,8.22369956970215,4.33650016784668,4.98190021514893,0.357100009918213,2.96740007400513,1,2.55539989471436,0.860199987888336,1,2.92610001564026,3.54609990119934,1.62639999389648,8.33329963684082,3.0952000617981,2.70000004768372,5.25209999084473,1.41540002822876,4.79860019683838,1.66670000553131,1.12170004844666,0.5,0.714299976825714,2.79609990119934,4.85830020904541,1.74349999427795,2.46309995651245,2.42129993438721,1.53450000286102,2.88179993629456,2.40689992904663,5.23260021209717,3.75,1.3889000415802,4,3.23130011558533,3.40140008926392,1.33329999446869,9.30230045318604,4.5,4.62349987030029,3.9556999206543,5.81400012969971,0.5,4.08160018920898,6,3.66669988632202,3.86129999160767,2.76290011405945,2.93099999427795,4.38840007781982,5.41669988632202,9.86110019683838,0.16159999370575,0.382600009441376,3.63639998435974,2.37470006942749,4.66669988632202,1.85189998149872,5.19999980926514,3.2985999584198,8.53330039978027,2.06349992752075,2.56410002708435,2.1875,6.25,3.33330011367798,4.4443998336792,6.63350009918213,8.42240047454834,4.39559984207153,2.44569993019104,1.22449994087219,1.625,3,4.72690010070801,1.12929999828339,7.40240001678467,4.45949983596802,2.47250008583069,1.88240003585815,4,8.1899995803833,7.09679985046387,1.66670000553131,3.4449999332428,4.23470020294189,2.7778000831604,1.88919997215271,5.03520011901855,1.25,2.85710000991821,4.11670017242432,1.77779996395111,13.5539999008179,4.56269979476929,2.12770009040833,2.98909997940063,2.56539988517761,5.6121997833252,2.80539989471436,1.60699999332428,2.25,2.03250002861023,5.53200006484985,1.58449995517731,3.7878999710083,3,8.65380001068115,4.21049976348877,4.6875,4.0984001159668,25,2.6331000328064,6,5.41260004043579,0.664200007915497,1.25,2.27539992332458,3.4614999294281,4.16669988632202,4.46869993209839,1.75,3.66939997673035,6.58260011672974,2.59999990463257,4.86509990692139,5.78700017929077,4.54080009460449,9.50570011138916,10.6379995346069,1.1110999584198,4.05410003662109,2.68709993362427,2.97620010375977,3.17280006408691,3.54999995231628,17.9069995880127,3.41739988327026,3.33330011367798,3.88599991798401,2.31110000610352,1.71080005168915,2.1143000125885,9.9330997467041,3.02769994735718,1.86049997806549,0.128199994564056,6.63269996643066,5.63910007476807,1.59899997711182,2.66669988632202,7.92080020904541,5.33979988098145,4,6.04489994049072,6.25,2.97620010375977,4.23390007019043,3.49160003662109,4.96449995040894,2.76920008659363,3.65849995613098,5.39349985122681,0.6564000248909,4.76879978179932,8.555100440979,10.4589996337891,2.63750004768372,6.84929990768433,5.08720016479492,0.961499989032745,4.30660009384155,7.06669998168945,2.52530002593994,7.894700050354,4.14890003204346,8.17459964752197,9.59710025787354,2.01640009880066,7.6217999458313,3.19749999046326,1.60000002384186,4.0984001159668,1.4815000295639,3.63639998435974,1,2.60419988632202,1.75,4.80000019073486,5.53000020980835,4.0984001159668,1.25,1.66670000553131,3.79010009765625,2.36360001564026,10.2040004730225,6.81820011138916,7.21460008621216,2.44840002059937,1.19869995117188,1.64100003242493,1.7820999622345,2.94120001792908,4.96890020370483,1.86049997806549,8.03569984436035,3.97160005569458,3.04159998893738,2.90700006484985,3.06119990348816,4.89659976959229,4.01609992980957,5.5556001663208,1.22269999980927,2.68390011787415,2.67379999160767,9.32940006256104,3.13809990882874,0.542599976062775,8.61110019683838,3.6686999797821,2.31850004196167,2.88199996948242,3.16659998893738,3.64580011367798,6.25,10.2489995956421,3.20959997177124,7.65220022201538,1.97239995002747,4.69799995422363,2.12339997291565,2.33330011367798,2.38960003852844,1.25639998912811,1.09379994869232,3.75,3.30719995498657,5.13520002365112,6.63269996643066,4.5644998550415,11.8479995727539,3.75,4.36509990692139,3.93330001831055,3.33330011367798,3.31590008735657,3.56159996986389,1.60000002384186,2.22550010681152,4.78719997406006,5.80649995803833,2.3585000038147,2,1.89999997615814,5.1230001449585,5.49450016021729,6.32180023193359,7.14289999008179,2.375,2.54290008544922,2.17980003356934,2.59999990463257,3.72939991950989,4.375,4.44329977035522,4.28770017623901,1.66670000553131,3.2558000087738,5.41130018234253,2.20499992370605,4.0625,0.64819997549057,5.38259983062744,0.170900002121925,23.4669990539551,9.57849979400635,3.69479990005493,2.2221999168396,1.74899995326996,1.15939998626709,6.99009990692139,3.96830010414124,21.4290008544922,0.476200014352798,2.15050005912781,1.85780000686646,4.32950019836426,8.9286003112793,2.7778000831604,2.65650010108948,2.5,18.2670001983643,0.819000005722046,2,15.3850002288818,6.47749996185303,8.33329963684082,4.55030012130737,2.49580001831055,4.47970008850098,2.23239994049072,2.07100009918213,1.67599999904633,3.40910005569458,2.5,3.96090006828308,6.22749996185303,3.92860007286072,2.90000009536743,4.08160018920898,2.84999990463257,7.01529979705811,2.93880009651184,1.92309999465942,6.875,3.90019989013672,2,4.97629976272583,1.20190000534058,22.5,6.86770009994507,3.56130003929138,1.97920000553131,5.3713002204895,1.7441999912262,5.09479999542236,2.5,3.82500004768372,1,3.07170009613037,1.71630001068115,4.02089977264404,5.45849990844727,25,2.38969993591309,3.21339988708496,3.37700009346008,1.77779996395111,3.16330003738403,2.70269989967346,1.69270002841949,0.213699996471405,6.76690006256104,1.74070000648499,2.5,4.48589992523193,2.57200002670288,3.46000003814697,4.78259992599487,2.31180000305176,5.3060998916626,5.86749982833862,3.40910005569458,4.08160018920898],[12,12,12,12,14,12,16,12,12,12,12,11,12,12,10,11,12,12,12,12,16,12,13,12,12,17,12,12,17,12,11,16,13,12,16,11,12,10,14,17,12,12,16,12,12,12,16,12,12,12,12,12,12,8,10,16,14,17,14,12,14,12,8,12,12,8,17,12,12,12,12,12,9,10,12,12,12,17,15,12,6,14,12,14,9,17,13,9,15,12,12,12,12,12,12,12,12,13,12,13,12,12,12,16,12,13,11,12,12,12,17,14,16,17,12,11,12,12,17,10,13,11,12,16,17,12,16,12,16,8,12,12,12,13,11,12,12,14,12,12,12,17,14,12,9,12,12,12,14,16,17,15,12,16,17,17,12,16,13,12,11,16,14,16,12,9,17,14,12,12,11,12,12,10,12,5,17,11,12,12,14,11,12,14,12,10,16,13,12,12,12,11,12,9,13,12,12,12,13,16,12,16,17,12,12,9,12,12,13,12,12,12,12,10,12,16,12,11,12,10,12,12,12,12,16,17,12,17,12,12,12,8,12,13,12,12,8,12,17,17,12,13,12,12,12,12,9,10,12,16,13,8,16,13,12,11,13,12,12,10,12,17,15,16,10,11,12,12,14,16,14,8,7,12,12,14,12,12,12,14,16,12,12,12,13,13,10,12,12,12,12,14,17,10,9,12,12,16,12,17,12,17,11,16,11,13,11,8,11,12,10,17,12,12,17,14,12,12,12,12,12,12,9,10,12,12,12,12,12,17,12,17,12,10,12,12,12,12,12,12,16,13,13,12,16,17,12,14,12,17,12,14,12,12,17,16,16,12,9,12,12,16,14,12,12,11,12,16,17,17,14,12,14,12,10,12,13,16,12,7,16,14,12,10,12,16,10,12,14,12,6,15,12,17,14,13,6,16,14,15,14,8,14,12,12,12,12,12,12,8,12,17,12,12,14,13,17,8,12,11,12,12,17,10,12,13,12,12],[7,7,7,7,14,7,7,3,7,7,3,7,16,10,7,10,7,12,7,7,16,10,3,7,7,14,7,7,12,12,7,3,10,14,12,3,3,3,7,17,12,9,16,3,7,7,16,10,7,7,7,3,7,7,3,12,7,17,7,7,3,12,7,7,7,12,16,7,7,7,12,10,9,0,10,14,7,3,12,12,7,17,3,7,7,12,7,7,12,10,0,12,10,7,7,7,3,12,7,12,7,7,10,14,7,12,7,7,10,7,12,7,7,17,7,7,7,10,10,12,7,12,7,10,7,10,7,7,7,7,7,7,16,12,7,3,7,7,7,12,7,12,12,14,7,7,7,12,12,14,10,12,7,16,7,17,3,10,9,7,3,16,12,7,7,7,12,3,7,7,7,7,10,10,7,12,17,10,7,7,12,7,12,7,7,7,7,14,7,12,7,7,12,3,7,12,12,7,7,14,12,17,17,7,7,10,7,7,7,3,0,7,12,7,7,12,7,7,12,7,7,3,7,7,10,12,7,12,7,7,7,7,12,7,7,7,7,7,14,17,7,10,7,7,12,7,7,9,7,14,7,3,16,3,16,7,16,12,7,7,12,12,12,16,7,9,7,12,12,10,7,12,7,7,3,10,17,7,3,3,12,7,7,7,10,7,10,7,9,9,12,12,12,7,9,12,7,12,7,12,12,14,7,14,10,12,7,7,12,7,7,12,12,12,12,14,10,7,7,7,7,7,7,7,7,7,12,12,7,14,10,12,7,7,12,7,10,12,10,7,14,7,12,12,7,16,0,12,7,17,7,12,3,7,14,7,12,12,7,7,14,7,12,12,7,7,7,7,3,12,7,7,14,10,10,10,10,12,3,7,16,7,7,0,7,7,10,7,12,7,7,7,7,16,12,10,7,7,16,7,7,7,12,10,10,10,7,10,12,12,7,17,12,16,10,16,7,7,9,3,7,7,7,7,7,7,16,12],[12,7,12,7,12,14,14,3,7,7,12,14,16,10,7,16,10,12,7,12,10,12,7,7,12,16,3,3,12,12,7,3,12,7,12,10,3,10,7,14,12,9,14,3,12,12,14,10,7,12,7,7,12,7,7,12,7,17,17,12,14,12,7,7,7,12,12,12,7,12,12,10,7,0,7,12,7,3,10,7,12,12,7,7,7,7,7,7,7,10,7,12,10,12,7,7,7,14,7,12,12,7,7,14,12,10,7,7,7,7,12,7,12,10,10,7,7,7,12,7,7,12,14,12,7,10,7,7,12,10,7,7,12,10,7,12,7,7,7,7,3,12,16,7,3,12,7,12,12,16,12,12,7,14,7,10,7,14,7,7,12,12,17,7,7,3,12,7,7,7,3,7,10,10,12,7,14,10,7,7,10,12,12,7,7,7,12,7,12,12,12,10,12,10,12,12,12,7,12,12,12,12,16,7,16,7,7,10,12,10,0,7,12,12,10,12,3,7,12,10,7,7,7,7,12,12,7,12,7,10,10,7,12,17,7,7,7,7,12,14,7,12,7,7,16,7,10,12,7,16,10,3,16,7,12,7,7,7,12,12,7,10,14,16,7,10,7,14,14,12,7,7,3,7,7,7,12,10,7,3,12,7,12,7,10,7,0,7,10,9,12,12,12,3,9,12,12,14,7,12,12,12,7,12,10,12,7,7,3,12,7,16,12,12,7,14,7,7,12,10,7,3,7,7,10,7,7,12,12,12,10,14,7,7,14,10,10,7,7,7,14,7,12,14,14,14,0,16,7,12,7,10,7,10,10,14,7,12,7,7,12,14,12,7,7,7,12,16,3,16,7,16,7,10,10,10,10,12,10,7,16,7,7,7,7,7,10,10,12,7,7,7,7,14,14,7,7,7,16,12,7,7,12,12,12,10,3,12,12,12,7,16,12,10,10,12,7,7,7,7,7,7,7,7,7,7,12,12],[14,5,15,6,7,33,11,35,24,21,15,14,0,14,6,9,20,6,23,9,5,11,18,15,4,21,31,9,7,7,32,11,16,14,27,0,17,28,24,11,1,14,6,10,6,4,10,22,16,6,12,32,15,17,34,9,37,10,35,6,19,10,11,15,12,12,14,11,9,24,12,13,29,11,13,19,2,24,9,6,22,30,10,6,29,29,36,19,8,13,16,11,15,6,13,22,24,2,6,2,2,14,9,11,9,6,19,26,19,3,7,28,13,9,15,20,29,9,1,8,19,23,3,13,8,17,4,15,11,7,0,0,10,8,2,4,6,18,3,22,33,28,23,27,11,6,11,14,17,17,14,11,7,8,6,8,4,25,24,11,19,9,19,14,22,6,23,15,6,11,2,22,10,14,12,9,13,18,8,11,9,9,14,9,2,12,15,11,7,9,19,11,8,13,4,7,19,14,14,3,9,7,7,14,29,19,14,16,10,12,24,6,9,14,26,7,4,15,23,1,29,9,6,11,17,6,7,2,24,4,11,25,11,2,19,7,2,20,10,19,17,12,11,6,10,4,2,13,21,9,4,2,19,4,9,14,6,24,1,13,3,10,16,9,19,4,10,5,7,3,38,16,13,1,7,15,10,2,19,25,25,7,15,11,25,19,4,14,19,18,14,11,4,29,21,24,19,31,28,15,27,13,4,10,8,4,18,3,11,8,10,33,19,35,21,7,18,4,12,16,14,3,1,27,12,6,9,2,6,9,16,22,26,11,11,15,13,6,20,17,8,13,15,14,14,6,24,10,2,9,23,12,8,16,10,7,19,2,9,14,9,16,7,6,22,9,9,14,17,12,13,8,10,16,1,6,4,8,4,15,7,14,16,15,23,19,4,12,12,25,14,14,11,7,18,4,37,13,14,17,5,2,0,3,21,20,19,4,19,11,14,8,13,24,1,1,3,4,21,10,13,9,14,2,21,22,14,7],[12.756017473225,11.7335580528393,12.7719792588351,11.7676834756791,13.9146147514322,13.0293763579735,13.0112170904032,10.4908298336813,12.0368319794436,12.0373829885555,12.0137856182153,13.0712115387216,14.6569671960569,13.009468638192,11.7676834756791,13.8449691779147,12.5063213926766,13.5034106901968,12.0390338310619,12.6459358164555,13.9122848424796,13.2646682553709,11.2615767198185,11.9839940950922,12.485399611828,14.7825951543775,11.3345217935194,11.2275625217181,13.5355179311223,13.5355179311223,11.9465626175807,10.5194560895489,13.3545680929964,13.2948711805661,13.7538445476203,11.2472556675509,10.6212813489564,11.7224402114528,12.0368319794436,14.9067011919528,13.3126017568543,12.6623231952885,14.5767983963138,10.4954215762808,12.555668639422,12.485399611828,14.6931182685297,13.0806538294765,11.9979376987886,12.555668639422,11.9300541925169,11.1883689769609,12.7719792588351,12.0098631205706,11.1456198173517,13.5936778672303,11.8245533542003,15.3554577769305,13.4553819327814,12.555668639422,12.3726450070121,13.6197305624127,11.9080378611631,11.9839940950922,11.9300541925169,13.6657814070346,14.461953164619,12.6960230249061,11.8579506527125,12.8248171431865,13.6657814070346,12.991488670667,12.3746468129467,9.47801976083825,12.5186975724212,14.1424834532194,11.6190726928337,10.6482502078294,13.2784838017331,12.7154255264538,12.8272026645088,14.664708314825,11.1258097072752,11.7676834756791,11.9955499926368,12.9432920434116,11.8529915707051,12.0276594183918,12.7776218263905,12.991488670667,10.6710988277039,13.6437650756808,13.0254304238028,12.555668639422,11.9500523419563,12.0392175007659,11.2786383388237,13.6699939728486,11.7676834756791,13.3547999073514,12.4070578565767,11.9680323094814,12.4265958831774,14.3380559614879,12.6459358164555,13.1882166246996,12.0276594183918,12.0263737304639,12.5963046488566,11.6592526614166,13.5355179311223,12.0078427538269,12.7380375056993,14.2262258525078,12.4567851933379,12.0335302944308,11.9955499926368,12.4265958831774,12.9335049365443,12.7776218263905,12.0276594183918,13.7747610455796,12.7624318906567,13.3066827361641,11.8298797756157,13.0512994492813,11.6974144480851,11.9839940950922,12.6960230249061,12.2725818148503,11.532658209925,11.532658209925,14.3779242030325,13.2504129246363,11.6190726928337,11.7272059712082,11.7676834756791,12.0197703604384,11.6592526614166,12.9869595515406,11.2958089977389,13.7435699683446,14.405149176574,13.3449562041872,11.2776497301687,12.555668639422,11.9080378611631,13.7037595239991,13.7455903350884,14.7550752863927,13.3246627036892,13.6437650756808,11.7997907166046,14.6389946962505,11.7676834756791,14.198154975411,10.9392208074653,13.7044364056159,12.4159287997535,11.9080378611631,12.0574509415149,14.3518715078501,14.5513717966525,11.9680323094814,12.0392175007659,11.1372953446847,13.7747610455796,11.2258004544723,11.7676834756791,11.9080378611631,10.9886845618393,12.0392175007659,12.9254396766056,13.009468638192,12.7180393562598,12.8056927034873,14.948715672746,13.061206689149,11.8298797756157,11.9080378611631,13.2784838017331,12.6459358164555,13.7037595239991,11.8579506527125,11.6190726928337,11.9300541925169,12.7719792588351,13.2348767322478,12.5877758803475,13.5936778672303,12.8156445821347,12.3808289594089,13.5656069901334,11.6646497995823,12.485399611828,13.5355179311223,13.7633866329095,11.9680323094814,12.7560174732244,13.7740766962442,13.5936778672303,14.4832599818971,15.1136481128915,11.9680323094814,13.4139232873742,12.5963046488566,11.9680323094814,12.4707287970344,12.6719885116379,11.6446516501428,9.60681387911872,11.7676834756791,13.5936778672303,12.7560174732244,12.4991648287097,13.5355179311223,11.0670263170907,11.9839940950922,13.7747610455796,12.0496656405823,11.9955499926368,11.0997570120927,11.7676834756791,11.9080378611631,13.3664935147785,13.5034106901968,11.7997907166046,13.3547999073514,12.0368319794436,12.1702055463309,12.3808289594089,12.0326119459109,13.6437650756808,13.1950430203196,12.0276594183918,11.7997907166046,11.6190726928337,12.0335302944308,13.9988273827226,15.0263227491815,12.0098631205706,13.2866845867247,11.9080378611631,11.7676834756791,14.2501186934071,11.6974144480851,12.0918637910795,13.1171343260092,12.0373829885555,14.6031628185345,12.1702055463309,10.2304909212195,15.1519684045237,10.9392208074653,14.3518715078501,11.9680323094814,13.4736191670737,12.9845740302183,12.3648597060795,12.7380375056993,12.6069947121913,13.3045364969155,14.0488589788035,14.9822596388445,12.0276594183918,12.5493023666408,11.884003347895,13.7844793328542,13.8507119966195,13.0158830556244,11.7940969557812,12.9456797495633,11.3196642109619,11.5768745423365,11.0415970759847,12.552639325557,14.5674726131875,12.0918637910795,11.2694657777719,10.6440301742967,13.7683391604286,11.7997907166046,12.7719792588351,11.9080378611631,13.0740482746215,12.0276594183918,11.1628804493098,11.9680323094814,12.8795473369474,12.7140612462455,13.7037595239991,13.6437650756808,13.4331416626028,11.3651618616425,12.7316738743626,13.7725591939613,12.8156445821347,14.0158312045287,12.0078427538269,13.7197213096099,13.7538445476203,14.064876376784,11.6974144480851,13.9988273827226,12.8713161043264,13.4331416626028,12.0197703604384,11.6592526614166,12.2253917809435,12.6178649393587,11.884003347895,14.2923124742454,13.7633866329095,13.6151388198132,12.9851250393303,14.2298088169294,12.5884155909032,11.6974144480851,12.7180393562598,12.4707287970344,11.9680323094814,11.0288645304222,11.5768745423365,12.0181173331026,12.4028452907627,11.7676834756791,12.8056927034873,13.3547999073514,12.555668639422,13.9727746875402,13.0393740274992,14.0901387807808,12.0263737304639,11.9080378611631,13.958959141178,12.4567851933379,12.991488670667,12.7154255264538,12.6021755248957,12.0098631205706,14.2598978759405,11.9500523419563,13.7197213096099,14.0189535894963,13.0712115387216,14.5767983963138,9.60681387911872,14.2501186934071,11.6190726928337,14.541419918005,12.0390338310619,13.3505873415374,11.0716861349959,12.4707287970344,13.6836333172254,12.9029699458447,12.9754014691665,13.3547999073514,11.8579506527125,11.9680323094814,13.9727746875402,13.1011169280287,13.5355179311223,12.7154255264538,12.0392175007659,11.8579506527125,12.6459358164555,13.3864056042188,10.6212813489564,14.296169538029,11.9500523419563,13.2482530703531,13.2108422189797,13.0393740274992,12.6183108710472,12.8091198043897,12.7388507767957,13.5656069901334,11.412011905711,11.9839940950922,14.9240997027365,11.9680323094814,11.9979376987886,10.6571552240075,12.0390338310619,12.0276594183918,12.7388507767957,12.4028452907627,13.6657814070346,12.0326119459109,11.9680323094814,11.9680323094814,11.9080378611631,14.6089056372393,14.0706916404533,12.2660596785499,11.8245533542003,11.9500523419563,15.0923412956133,12.7978482843136,11.7335580528392,11.6190726928337,13.2683854244427,13.0158830556244,13.3940133827633,13.0749666231414,11.3972712873974,13.0540448422929,13.7633866329095,13.6437650756808,11.9680323094814,15.1437371719026,13.6857795564741,14.2155587690839,12.6183108710472,14.0707953974741,11.6592526614166,11.6974144480851,12.4164798088654,11.1258097072752,11.9500523419563,11.8579506527125,11.9680323094814,11.6190726928337,12.0373829885555,12.0392175007659,14.461953164619,13.5355179311223],[-0.756017473224986,0.266441947160748,-0.771979258835125,0.232316524320935,0.0853852485677888,-1.02937635797346,2.98878290959675,1.50917016631872,-0.0368319794435641,-0.0373829885555029,-0.0137856182153079,-2.07121153872156,-2.65696719605691,-1.00946863819205,-1.76768347567907,-2.84496917791472,-0.506321392676582,-1.50341069019682,-0.0390338310618854,-0.645935816455478,2.08771515752038,-1.26466825537093,1.73842328018145,0.0160059049078449,-0.485399611828042,2.21740484562246,0.66547820648063,0.772437478281871,3.4644820688777,-1.5355179311223,-0.946562617580693,5.48054391045111,-0.354568092996403,-1.29487118056608,2.2461554523797,-0.247255667550934,1.37871865104356,-1.72244021145283,1.96316802055644,2.0932988080472,-1.31260175685425,-0.6623231952885,1.42320160368618,1.50457842371923,-0.555668639422042,-0.485399611828042,1.30688173147028,-1.08065382947651,0.00206230121143271,-0.555668639422042,0.0699458074831314,0.811631023039126,-0.771979258835127,-4.00986312057064,-1.14561981735174,2.40632213276975,2.17544664579971,1.64454222306954,0.544618067218578,-0.555668639422042,1.6273549929879,-1.61973056241271,-3.90803786116309,0.0160059049078449,0.0699458074831314,-5.66578140703461,2.53804683538103,-0.696023024906061,0.142049347287493,-0.824817143186536,-1.66578140703461,-0.991488670666953,-3.37464681294674,0.521980239161754,-0.51869757242117,-2.14248345321941,0.380927307166296,6.35174979217063,1.72151619826694,-0.715425526453844,-6.82720266450884,-0.664708314824981,0.87419029272485,2.23231652432093,-2.99554999263683,4.05670795658839,1.14700842929494,-3.02765941839175,2.22237817360952,-0.991488670666953,1.32890117229612,-1.64376507568084,-1.0254304238028,-0.555668639422042,0.0499476580436942,-0.0392175007658651,0.721361661176255,-0.669993972848638,0.23231652432093,-0.354799907351449,-0.407057856576675,0.0319676905185988,-0.426595883177371,1.66194403851207,-0.645935816455478,-0.188216624699627,-1.02765941839175,-0.0263737304638966,-0.596304648856618,0.340747338583442,3.4644820688777,1.99215724617314,3.26196249430072,2.77377414749216,-0.456785193337938,-1.0335302944308,0.00445000736316756,-0.426595883177371,4.06649506345566,-2.77762182639048,0.972340581608246,-2.77476104557963,-0.762431890656718,2.69331726383586,5.1701202243843,-1.05129944928129,4.30258555191493,0.0160059049078449,3.30397697509394,-4.27258181485034,0.46734179007503,0.46734179007503,-2.37792420303253,-0.25041292463626,-0.619072692833704,0.272794028791777,0.23231652432093,1.98022963956163,0.340747338583442,-0.986959551540639,0.704191002261081,3.25643003165539,-0.405149176574008,-1.34495620418723,-2.27764973016871,-0.555668639422042,0.0919621388369104,-1.70375952399915,0.254409664911617,1.24492471360733,3.67533729631076,1.35623492431916,0.200209283395443,1.36100530374954,5.23231652432093,2.80184502458897,1.06077919253475,2.29556359438407,0.584071200246526,0.0919621388369104,-1.05745094151491,1.64812849214993,-0.551371796652471,4.0319676905186,-0.0392175007658651,-2.13729534468469,3.22523895442037,2.77419954552766,0.23231652432093,0.0919621388369104,0.0113154381606739,-0.0392175007658651,-0.925439676605616,-3.00946863819205,-0.71803935625984,-7.80569270348728,2.05128432725399,-2.06120668914901,0.170120224384297,0.0919621388369104,0.721516198266936,-1.64593581645548,-1.70375952399915,2.14204934728749,0.380927307166296,-1.93005419251687,3.22802074116487,-0.234876732247773,-0.587775880347529,-1.59367786723025,-0.815644582134726,-1.38082895940887,-1.56560699013345,-2.66464979958227,0.514600388171958,-1.5355179311223,-1.7633866329095,0.0319676905185988,0.243982526775627,2.22592330375579,-1.59367786723025,1.51674001810292,1.88635188710855,0.0319676905185988,-1.41392328737418,-3.59630464885662,0.0319676905185988,-0.47072879703435,0.328011488362059,0.355348349857167,2.39318612088128,0.23231652432093,-1.59367786723025,-2.75601747322437,-0.49916482870968,2.4644820688777,0.932973682909307,-0.983994095092155,-1.77476104557963,-2.04966564058229,0.00445000736316756,0.900242987907312,0.23231652432093,0.0919621388369104,2.63350648522153,3.49658930980318,0.200209283395443,3.64520009264855,-0.0368319794435641,-0.170205546330853,-0.380828959408873,-4.0326119459109,-1.64376507568084,-0.195043020319647,-0.0276594183917537,0.200209283395443,-3.6190726928337,-0.0335302944307991,3.00117261727738,1.97367725081854,-0.00986312057063796,-0.286684586724705,0.0919621388369104,0.23231652432093,-2.25011869340709,0.30258555191493,-3.09186379107949,-3.11713432600919,-0.0373829885555029,1.39683718146546,0.829794453669147,-2.23049092121951,0.848031595476304,2.06077919253475,-2.35187150785007,-0.968032309481401,-0.473619167073663,-0.984574030218338,-0.364859706079479,-2.73803750569928,-0.606994712191332,3.69546350308447,0.951141021196498,1.01774036115555,-2.02765941839175,-1.54930236664076,0.115996652105031,-1.78447933285418,0.149288003380509,2.98411694437561,2.20590304421881,-4.94567974956334,-4.31966421096193,0.423125457663492,0.958402924015262,1.44736067444298,-2.56747261318749,-0.0918637910794867,0.730534222228065,3.3559698257033,2.23166083957135,0.200209283395443,-0.771979258835127,0.0919621388369104,-0.0740482746215486,0.972340581608246,-1.16288044930977,0.0319676905185988,-0.879547336947446,-0.714061246245465,-1.70375952399915,0.356234924319165,3.56685833739718,-1.36516186164246,-3.7316738743626,-1.77255919396131,-0.815644582134726,1.98416879547132,-0.00784275382686224,3.2802786903901,-1.7538445476203,2.93512362321604,-0.69741444808507,2.00117261727738,-1.87131610432635,-0.433141662602816,-1.01977036043837,-3.65925266141656,-1.22539178094349,-0.617864939358674,-1.88400334789497,2.70768752575458,-1.7633866329095,-1.61513881981322,4.01487496066972,-0.229808816929401,-0.588415590903231,0.30258555191493,-0.71803935625984,-0.47072879703435,0.0319676905185988,0.97113546957782,-2.57687454233651,-2.01811733310255,-0.402845290762652,0.23231652432093,-0.805692703487281,-1.35479990735145,-0.555668639422042,3.02722531245984,-1.03937402749921,2.9098612192192,-0.0263737304638966,-1.90803786116309,-1.95895914117802,-0.456785193337938,-0.991488670666953,-0.715425526453844,-0.602175524895664,-0.00986312057063796,1.74010212405945,1.04994765804369,-0.719721309609901,-2.01895358949634,2.92878846127844,2.42320160368618,2.39318612088128,-0.250118693407092,0.380927307166296,2.45858008199497,-0.0390338310618854,0.649412658462575,0.928313865004116,-0.47072879703435,3.31636668277456,3.09703005415528,3.02459853083347,-1.35479990735145,-2.85795065271251,0.0319676905185988,-1.97277468754016,2.89888307197127,0.464482068877697,-0.715425526453844,-0.0392175007658651,-0.857950652712507,-0.645935816455478,2.61359439578125,6.37871865104356,2.70383046197101,2.04994765804369,-1.24825307035305,0.789157781020347,-1.03937402749921,-2.61831087104715,-0.809119804389717,0.261149223204283,2.43439300986655,0.587988094288966,-4.98399409509215,1.0759002972635,2.0319676905186,0.00206230121143271,-0.657155224007472,-0.0390338310618854,3.97234058160825,-2.73885077679572,-0.402845290762652,0.334218592965386,-0.0326119459109012,-5.9680323094814,3.0319676905186,0.0919621388369104,2.39109436276069,-0.0706916404533011,0.733940321450066,-5.82455335420029,4.04994765804369,-1.09234129561334,2.20215171568639,2.26644194716076,-3.6190726928337,0.731614575557284,-1.01588305562439,-1.39401338276334,-1.07496662314145,0.602728712602624,-1.05404484229291,-1.7633866329095,-5.64376507568083,0.0319676905185988,1.8562628280974,-1.68577955647405,-2.21555876908394,1.38168912895284,-1.07079539747407,5.34074733858344,-3.69741444808507,-0.416479808865412,-0.12580970727515,0.0499476580436942,0.142049347287493,5.0319676905186,-1.6190726928337,-0.0373829885555029,0.960782499234135,-2.46195316461897,-1.5355179311223],[-0.0168936207790957,-0.654725475713332,0.268990102628786,-0.925395975965052,0.351475803505815,0.292975100461763,0.712714125556681,0.830048328829994,-0.572806464055426,0.228906879819095,0.156774080455303,0.358621467808292,-0.0509066150667724,-0.408678198474197,0.4081051565683,-0.750151828714639,-0.141070293189805,0.626320075508049,-0.632076792128521,0.912354725110101,0.0254234662407407,0.110998803790075,-0.171402407956784,-0.066492589969642,-0.179599223835941,-0.291163887644166,0.0960621128090489,0.443692768980421,0.624828684574411,0.719357344533758,-0.785563043193125,-0.507790558833782,0.443783121497143,0.0459103439030288,-0.230909227855015,0.178241638937846,-0.410830602218871,0.31780169889129,0.276093067935758,1.21420053975039,0.157163028524449,0.138891263449078,-0.31807212646907,0.375709358740475,-0.324372119940416,0.297630469424522,-0.68108841796079,0.198356032664972,-0.440481338529804,-0.0476877836190429,-0.356944767472115,-1.18345791268421,-1.08260368873952,-0.560364158675464,-0.495402662864305,0.0419968040787959,0.954175532390288,0.640891081713018,0.173459781258792,-0.255359253281869,0.0592420115211612,0.126159602901363,0.0833032319187228,0.587433877437022,1.29385469466466,0.339148930737163,0.403905099625507,-0.0915060503569733,0.0143457495144101,-0.00538695446584758,0.559546828455449,0.0945944795024922,0.516288483815267,1.0678545832677,0.259918512436381,0.306242094220292,-1.89934415008655,-0.546439765307334,-1.29376673544543,-0.079310574526515,-1.10371781121105,-1.42369225889819,-0.062996336123891,0.125535821948619,-0.639208948609424,0.503508533491197,-0.141473480078824,-0.122127616073445,0.393749169654124,-0.859736900807993,0.306874327808804,-0.651113224704934,-1.13030215145186,-1.71066648106031,-1.54360136667612,-0.293281657922279,0.253545831061786,-0.375106798494127,-0.116098598948552,-0.0466968234276341,-0.441400156537025,-0.168632234666127,-0.231237265879133,0.247362959956525,0.212178991136755,-0.750403832489442,0.148121696642284,-0.152702051462705,-0.0753821555247653,-0.621623231089576,0.873275496615857,0.0644454498615019,0.0784163531052371,-0.0414024365282719,0.515121238133567,-1.94043042371943,0.0967212999734701,0.68218262038249,0.164177631014639,0.393108231273392,-0.344685028186362,-0.18848368404534,0.569684414614009,0.23675114007024,0.900925661258391,-3.09858549013356,-2.15350961821643,0.0458465906532497,-0.542674224101193,0.736035585706567,-0.168647715489882,0.863798744322327,0.0568313035936281,1.00189063591488,-0.0838045895264476,-0.00555035502998824,-0.234759961250729,0.421127430583259,0.294682539299405,0.170137627606939,0.628627658415541,0.507073046097715,0.0325867742401598,-0.427780272367827,-0.775236415867007,-0.532011484718661,-0.0633465629215377,0.326222306349292,-1.27714960579467,0.480263440464816,-0.0389938404682708,-0.440918918960651,-0.417455511699122,0.060018907025698,0.778411401796258,0.571971874192502,-0.436312278566127,-0.335926307356184,0.0547731119509831,-0.140299574152162,-0.602019220178037,0.261289906653259,-1.19921899976326,-0.422826699085576,0.0935447017249731,-0.257952789352307,0.974474582374794,0.149973664539662,-0.262477673911722,-0.0669865197336277,0.133906242513006,0.403435549217902,-0.105120726059082,-0.629884971142226,-0.374522727899545,0.0294661297369867,0.196417183780527,-0.766995274704575,0.251122829538668,-0.0633465629215377,0.925628425490848,0.389401129337197,0.317852079819835,0.178226575359675,2.34927107138906,-0.0944978146393572,0.301025367450281,0.46537409592292,-1.45917504730146,-0.886433297531355,-0.477413465918304,0.141139778025252,0.346435389697942,0.474138312579769,-0.448938746382039,0.250025065441634,0.58486052845821,-0.27153590312904,0.293643310936085,0.600747239026595,0.403526379972344,0.956302025750815,1.00744621905954,-1.12169683329142,0.0899609089657327,-0.126916886278866,-0.136399957599712,-0.106835422933094,0.0688841413557923,1.6997387307317,-0.0982628005736013,0.186443537879308,0.247803481004179,-0.266530449435306,-0.788625492691883,-0.546865810243125,1.34871468368344,-0.075947719462039,-0.704378715673504,-2.75950178781186,0.582244141267449,0.620147642721823,-0.548140880962605,-0.181117141284756,0.547951403462793,0.350685731964773,0.336291271940584,0.622627033675945,0.505438669300143,0.143489448426141,0.281164719094484,0.168682932856561,0.440353725912728,0.087557118746236,-0.00251607799326514,0.635191408070246,-1.04500311985854,0.253414783141586,0.702877683726318,0.740910379080843,-0.306122801407527,0.677296870810768,0.464768761775445,-1.05678002586007,0.323481931647664,1.00823570193792,0.240945010943682,0.98183581495215,0.106850735112896,0.745868378491874,1.25290646205658,0.0772955542122201,0.485856746357545,0.153814717170837,-0.639573204698668,0.24494599932841,-0.685860821380115,-0.0361486174836292,-0.82813126864748,-0.127230357017608,-0.349664511144842,0.12496599348429,0.264548044959067,0.0554333176264319,-0.953632484296776,-0.374915649699506,0.195725609903788,-0.123051685484356,1.14998349972359,0.764728709191335,0.688090824973104,-0.120428648040677,-0.718928357581766,-0.332825436780278,-0.472210666173963,-0.289123176608763,0.466531708807164,-0.248759496464182,0.784324801537106,-0.070887884510054,-0.460466503328887,0.0171185547056036,-0.126340621885113,0.426582188076834,0.0016509591566185,0.353840535786582,-0.623303119705585,-0.239776306966514,-0.316068614916072,0.944509935383674,-0.0834298192951388,-1.89613503219598,0.898911041774402,0.112862813315113,-0.290882181929564,-0.268658307459865,-0.146910839752564,-0.242242912480113,0.51574277456678,0.775049369751629,-0.155965314353627,0.520860975462712,-0.206510226552288,0.164883541193559,-0.266273744918931,-0.161270911026757,-0.356138142522039,-0.43544330358463,-1.01090439770022,0.241066901354612,0.182228334234995,0.0656307263770142,0.592442662711732,0.288723102676216,0.849183385094347,0.148959493069771,0.18498030178142,0.422320867395752,0.018509894263796,-0.0627208155677037,0.0431625621609986,-0.439276654933368,0.156040275420548,0.3666273173286,0.57352502836113,-0.159493475140757,-0.416429668285619,-0.227750879855096,0.61622093275233,0.287187627885745,0.582554092507208,0.337628498934962,-0.460589182789331,-0.105860398220062,-0.382725706716383,-0.289636177963634,0.10909824381371,0.458387219309216,0.182717419909412,0.179796181448976,-0.815429827209479,-0.0881077023910819,0.381945178259316,-0.436319837178314,-0.070835279287323,-1.75805847091968,0.356028702896307,-3.02613675401053,2.28599038514747,0.842960988838511,-0.0182975740023461,-0.5097485431039,-0.521644769309391,-1.11354730383669,0.50084488481327,0.0827482130009292,1.51958937590574,-1.61152206826825,-0.159686561509135,-0.607654315809396,0.355875258877051,0.682223205163268,-0.151137069475063,-0.0405097955378678,-0.405216479824068,1.85691594417476,-1.30924803698801,-0.779486646383234,1.150455561029,0.375898539115997,0.790317137468016,0.434504252886734,-0.34485075113796,0.238106177739638,0.097739202360818,-0.289487670195979,-0.492144532826589,-0.0998271109160538,-0.0308671735766853,0.438306847432231,0.533385357382839,0.018442577654332,-0.19673915203759,0.284134786183935,-0.277905011870165,0.402937640403318,0.253636719886948,-0.531514479558275,0.619645441703519,0.0337641287260522,-0.165520357717021,0.193449397251214,-0.978055209169597,1.75652907569796,0.515375242630387,0.261571123460875,-0.137402508694249,0.228334393055367,-0.793544576429462,0.168076205946266,-0.18974009844996,0.717540241732171,-0.907653102318515,0.212950886481974,-0.775821694293619,0.0828258296007693,0.397604716621451,2.27171791941736,-0.428401485110008,0.250957195365129,-0.0100595423977876,-0.812295458412623,-0.0555332991030968,-0.332891558225657,-0.424599622378363,-2.43271003068305,0.69577964537552,-0.147284055082324,-0.39970177960328,0.425668936642164,-0.262465280654036,0.131691751249205,0.0309538603961679,0.0912149474522068,0.352864570231766,0.386524778921891,-0.000598968298555214,0.356486025582675]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>wage<\/th>\n      <th>educ<\/th>\n      <th>fatheduc<\/th>\n      <th>motheduc<\/th>\n      <th>exper<\/th>\n      <th>educ.hat<\/th>\n      <th>vi.hat<\/th>\n      <th>ui.hat<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":8,"scrollX":true,"scrollCollapse":true,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100],"rowCallback":"function(row, data) {\nDTWidget.formatRound(this, row, data, 1, 4, 3, \",\", \".\");\nDTWidget.formatRound(this, row, data, 6, 4, 3, \",\", \".\");\nDTWidget.formatRound(this, row, data, 7, 4, 3, \",\", \".\");\nDTWidget.formatRound(this, row, data, 8, 4, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>

---

## 案例：构建外生性检验模型




将残差
`\(\hat{u}_i\)`对所有外生变量进行回归，并获得判定系数
`\(R^2\)`。

`$$\begin{align}
\hat{u}_{i} &amp; =\lambda_{0}+\lambda_{1} exper_i +\lambda_{2} exper^2_i+\lambda_{3} montheduc_i +\lambda_{4} fatheduc_i + \varepsilon_i
\end{align}$$`

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{ui.hat}=&amp;&amp;+0.01&amp;&amp;-0.00exper&amp;&amp;+0.00I(exper^2)\\ &amp;\text{(t)}&amp;&amp;(0.0776)&amp;&amp;(-0.0014)&amp;&amp;(0.0018)\\&amp;\text{(se)}&amp;&amp;(0.1413)&amp;&amp;(0.0133)&amp;&amp;(0.0004)\\&amp;\text{(cont.)}&amp;&amp;-0.01motheduc&amp;&amp;+0.01fatheduc\\&amp;\text{(t)}&amp;&amp;(-0.5558)&amp;&amp;(0.5173)\\&amp;\text{(se)}&amp;&amp;(0.0119)&amp;&amp;(0.0112)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.0009;&amp;&amp; \bar{R^2}=-0.0086\\&amp; &amp;&amp; F^{\ast}=0.09;&amp;&amp; p=0.9845\\ \end{alignedat} \end{equation}$$`


---

## 案例：外生性检验验结论

- 原假设（
`\(H_0:\)`全部工具变量都是**外生的**）/备择假设（
`\(H_1:\)`部分工具变量不是**外生的**）.

- 构建并计算**卡方统计量**。容易发现，判定系数
`\(R^2=\)` 0.0009。可以计算得到样本卡方统计量为
`\({\chi^2}^\ast= nR^2=\)` 0.3781。

- 查卡方分布。容易计算出卡方分布的自由度为：
`\(q =(n_{iv} -n_{env})=\)` 1，其中
`\(n_{iv}=\)` 2（**工具变量**的个数，也即
`\((mothedu_i,fatheduc_i)\)`。
`\(n_{env}=\)` 1（**内生变量**的个数，也即
`\(edu_i\)`）。若给定置信水平
`\(\alpha=0.05\)`，查卡方分布表可知
`\(\chi^2_{1-\alpha}(q)=\chi^2_{0.95}(1)=\)` 3.8415。

- 给出假设检验结论。因为
`\({\chi^2}^{\ast} &lt; \chi^2_{1-\alpha}(q)\)`，不能拒绝原假设
`\(H_0\)`，认为模型中的工具变量
`\((motheduc_i,fatheduc_i)\)`都是**外生的**。

---

### 案例：工具外生性检验EViews操作1

&lt;img src="pic/chpt11-mroz2-exo-test-step1.png" width="566" style="display: block; margin: auto;" /&gt;

---

### 案例工具外生性检验EViews操作2

&lt;img src="pic/chpt11-mroz2-exo-test-step2.png" width="529" style="display: block; margin: auto;" /&gt;

---

### 案例：工具外生性检验EViews结果

&lt;img src="pic/chpt11-mroz2-exo-test-result.png" width="623" style="display: block; margin: auto;" /&gt;

---
layout: false
background-image: url("pic/thank-you-gif-funny-little-yellow.gif")
class: inverse,center
# 本章结束
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
