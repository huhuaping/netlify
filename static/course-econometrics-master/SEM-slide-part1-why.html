<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
  <head>
    <title>SEM-slide-part1-why.utf8.md</title>
    <meta charset="utf-8" />
    <link href="libs/remark-css/default.css" rel="stylesheet" />
    <link href="libs/remark-css/default-fonts.css" rel="stylesheet" />
    <link href="libs/remark-css/duke-blue.css" rel="stylesheet" />
    <link href="libs/remark-css/hygge-duke.css" rel="stylesheet" />
    <script src="libs/htmlwidgets/htmlwidgets.js"></script>
    <script src="libs/jquery/jquery.min.js"></script>
    <link href="libs/datatables-css/datatables-crosstalk.css" rel="stylesheet" />
    <script src="libs/datatables-binding/datatables.js"></script>
    <link href="libs/dt-core/css/jquery.dataTables.min.css" rel="stylesheet" />
    <link href="libs/dt-core/css/jquery.dataTables.extra.css" rel="stylesheet" />
    <script src="libs/dt-core/js/jquery.dataTables.min.js"></script>
    <link href="libs/crosstalk/css/crosstalk.css" rel="stylesheet" />
    <script src="libs/crosstalk/js/crosstalk.min.js"></script>
    <link rel="stylesheet" href="libs\cc-fonts.css" type="text/css" />
    <link rel="stylesheet" href="libs\figure-captions.css" type="text/css" />
    <link rel="stylesheet" href="libs\mycss\my-custom.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">

background-image: url("pic/slide-front-page.jpg")
class: center,middle

# 计量经济学I（研究生）
# (Econometrics I)

&lt;!---    chakra: libs/remark-latest.min.js ---&gt;

### 胡华平

### 西北农林科技大学

### 经济管理学院数量经济教研室

### huhuaping01@hotmail.com

### 2019-10-14








---
class: inverse, middle, center

# 模块2：结构方程模型（SEM）

## Chapter 18. 为什么要关心联立方程模型？

## Chapter 19. 联立方程模型的识别问题

## Chapter 20. 联立方程模型的估计方法

---
class: center, middle,inverse

## Chapter 18. 为什么要关心联立方程模型？

### 18.1 联立方程模型的本质
### 18.2 联立方程模型的表达和定义
### 18.3 OLS估计方法还合适么？

---
class: center, middle,duke-orange

## 18.1 联立方程模型的本质

---
layout: true
  
&lt;div class="my-header"&gt;&lt;/div&gt;

&lt;div class="my-footer"&gt;&lt;span&gt;huhuaping@   第18章 为什么要关心联立方程模型   
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
18.1 联立方程模型的本质&lt;/span&gt;&lt;/div&gt; 


---

### 联立方程模型的形态

**联立方程模型**（simultaneous equations model,SEM）：由多个方程组成的、方程之间存在相互关联的、联合影响的**内生变量**的方程系统。其基本形式如下：

`$$\begin{cases}
  \begin{align}
    Y_{1 i}=\beta_{10}+\gamma_{12} Y_{2 i}+\beta_{11} X_{1 i}+u_{1 i} \\
    Y_{2 i}=\beta_{20}+\gamma_{21} Y_{1 i}+\beta_{21} X_{1 i}+u_{2 i}
  \end{align}
\end{cases}$$`


---

### 常见的经济模型1：需求-供给模型

**需求-供给模型**：

`$$\begin{align}
\text { Demand function: } &amp; {Q_{t}^{d}=\alpha_{0}+\alpha_{1} P_{t}+u_{1 t}, \quad \alpha_{1}&lt;0} \\
{\text { supply function: }} &amp; {Q_{t}^{s}=\beta_{0}+\beta_{1} P_{t}+u_{2 t}, \quad \beta_{1}&gt;0} \\
{\text {Equilibrium condition:}} &amp; {Q_{t}^{d}=Q_{t}^{s}}
\end{align}$$`

---

### 常见的经济模型2：凯恩斯收入决定模型

**凯恩斯收入决定模型**（Keynesian model of income determination）：

`$$\begin{cases}
  \begin{align}
    C_t &amp;= \beta_0+\beta_1Y_t+\varepsilon_t &amp;&amp;\text{(消费函数)}\\
    Y_t &amp;= C_t+I_t &amp;&amp;\text{(收入恒等式)}
  \end{align}
\end{cases}$$`

---

### 常见的经济模型3：IS模型

**投资储蓄的IS宏观经济模型**：

`$$\begin{align}
\text { Consumption function: } &amp; C_{t}=\beta_{0}+\beta_{1} Y_{d t} &amp; &lt;\beta_{1}&lt;1 \\ 
\text { Tax function: } &amp; T_{t}=\alpha_{0}+\alpha_{1} Y_{t} &amp; \quad 0&lt;\alpha_{1}&lt;1  \\ 
\text { Investment function: } &amp; I_{t}=\gamma_{0}+\gamma_{1} r_{t} \\ 
\text { Definition: } &amp; \gamma_{d t}=Y_{t}-T_{t} \\
\text { Government expenditure: } &amp; G_{t}=\bar{G} \\ 
\text { National income identity: } &amp; Y_{t}=C_{t}+I_{t}+G_{t}
\end{align}$$`

其中：
`\(Y\)`表示国民收入；
`\(Y_d\)`表示可支配收入；
`\(r\)`表示利率；
`\(\bar{G}\)`表示给定政府支出水平。

---

### 常见的经济模型4：LM模型

**货币市场均衡的LM宏观经济模型**：

`$$\begin{align}
{\text { Money demand function: }} &amp; {M_{t}^{d}=a+b Y_{t}-c r_{t}} \\ 
{\text { Money supply function: }} &amp; {M_{t}^{s}=\bar{M}} \\
{\text { Equilibrium condition: }} &amp; {M_{t}^{d}=M_{t}^{s}}
\end{align}$$`

其中：
`\(Y\)`表示收入；
`\(r\)`表示利率;
`\(\bar{M}\)`表示给定货币供给量。


---

### 常见的经济模型5：克莱因模型

**克莱因模型**（Llein's model）：

`$$\begin{align}
\text { Consumption function: }  &amp; C_{t}=\beta_{0}+\beta_{1} P_{t}+\beta_{2}\left(W+W^{\prime}\right)_{t}+\beta_{3} P_{t-1}+u_{1 t} \\ 
\text { Investment function: } &amp; I_{t} =\beta_{4}+\beta_{5} P_{t}+\beta_{6} P_{t-1}+\beta_{7} K_{t-1}+u_{2 t} \\ 
\text { Demand for labor: } 
 &amp; w_{t}= \beta_{8}+\beta_{9}\left(Y+T-W^{\prime}\right)_{t}  +\beta_{10}\left(Y+T-W^{\prime}\right)_{t-1}+\beta_{11} t+u_{3 t} \\ \text { Identity: } &amp; Y_{t} = C_{t}+I_{t}+C_{t} \\ 
\text { Identity: }  &amp; Y_{t}=W_{t}^{\prime}+W_{t}+P_{t} \\ 
\text { Identity: }  &amp; K_{t}=K_{t-1}+I_{t} 
\end{align}$$`


其中：
`\(C\)`表示消费支出；
`\(Y\)`表示税后收入；
`\(P\)`表示利润；
`\(W\)`表示个人工资；
`\(W^{\prime}\)`表示政府工资；
`\(K\)`表示资本存货；
`\(T\)`表示税收。

---

### 生活中的模型1：凶杀犯罪率模型

`$$\begin{align}
\operatorname{murdpc} &amp;=\alpha_{1} \operatorname{polpc}+\beta_{10}+\beta_{11} \text {incpc}+u_{1} \\
\text { polpc } &amp;=\alpha_{2} \operatorname{murdpc}+\beta_{20}+\text { other factors. }
\end{align}$$`

其中：
`\(murdpc\)`表示人均凶杀犯罪数；
`\(polpc\)`表示人均警员数；
`\(incpc\)`表示人均收入。

---

### 生活中的模型2：住房支出-储蓄模型

`$$\begin{align}
\text {housing } &amp; =\alpha_{1} \text {saving}+\beta_{10}+\beta_{11} \text {inc}+\beta_{12} e d u c+\beta_{13} \text {age}+u_{1} \\ 
\text {saving} &amp;=\alpha_{2} \text {housing }+\beta_{20}+\beta_{21} \text {inc}+\beta_{22} e d u c+\beta_{23} \text {age}+u_{2}
\end{align}$$`

其中：
`\(housing\)`表示住房支出；
`\(saving\)`表示家庭储蓄；
`\(inc\)`表示家庭收入；
`\(educ\)`表示教育水平;
`\(age\)`表示年龄。

---

### 联立方程模型的特点

联立方程模型的本质是**内生变量**问题：

- 每一个方程都有其经济学因果关系（保持其他条件不变的）

- 样本数据只是各种变量的最终结果，但其中蕴含复杂相互因果互动关系

- 特定方程的参数估计，往往跟其他方程有联系

- 直接使用OLS方法估计参数将会不可靠


---

### 松露案例：变量说明


<div id="htmlwidget-6db32d368c961cdb51db" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-6db32d368c961cdb51db">{"x":{"filter":"none","data":[["1","2","3","4","5"],["P","Q","PS","DI","PF"],["松露市场价格","松露产量或需求量","松露替代品的市场价格","当地居民可支配收入","生产成本(小猪的租金)"],["美元/盎司","盎司","美元/盎司","美元/人","美元/小时"]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>变量<\/th>\n      <th>含义<\/th>\n      <th>单位<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"t","columnDefs":[{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":6,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[6,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>


???

案例来源：Hill, R. C., W. E. Griffiths and G. C. Lim. Principles of Econometrics 4th Edition  [M], Wiley, 2011. chpt 11。实例参考：[PoE with R](https://bookdown.org/ccolonescu/RPoE4/simultaneous-equations-models.html)

---

### 松露案例：数据表

<div id="htmlwidget-b1b809023632a1daa7e8" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-b1b809023632a1daa7e8">{"x":{"filter":"none","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20","21","22","23","24","25","26","27","28","29","30"],[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30],[29.64,40.23,34.71,41.43,53.37,38.52,54.33,40.56,67.35,49.65,58.17,66.87,49.95,64.95,52.68,61.2,80.55,89.94,70.77,57.33,46.23,77.43,83.01,70.71,66.75,76.8,83.7,81,88.44,105.45],[19.89,13.04,19.61,17.13,22.55,6.37,15.02,10.22,23.64,16.12,24.55,18.92,11.94,18.93,12.6,20.49,22.94,21.08,16.68,17.61,16.62,20.99,24.53,19.67,23.29,16.64,20.81,14.95,26.27,20.65],[19.97,18.04,22.36,20.87,19.79,15.98,17.94,17.09,22.72,15.74,24.64,23.7,15.93,23.34,15.21,26.04,22.95,27.1,23.65,20.06,26.38,24.28,26.64,22.65,19.68,23.82,28.98,18.52,28.16,28.43],[2.103,2.043,1.87,1.525,2.709,2.489,2.294,2.196,3.885,3.169,2.623,3.007,3.367,3.29,3.746,3.518,4.381,4.121,3.82,4.398,3.764,4.524,4.815,3.67,4.392,4.603,4.632,4.894,5.125,4.836],[10.52,19.67,13.74,17.95,13.71,24.95,24.17,23.61,19.52,20.03,15.38,22.98,25.76,25.17,25.82,19.31,26.02,29.65,27.45,18,18.87,24.58,25.25,24.24,22.63,27.35,27.8,30.34,24.12,34.01]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>id<\/th>\n      <th>P<\/th>\n      <th>Q<\/th>\n      <th>PS<\/th>\n      <th>DI<\/th>\n      <th>PF<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":8,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100]}},"evals":[],"jsHooks":[]}</script>

---

### 松露案例：散点图(P VS Q) 

&lt;img src="SEM-slide-part1-why_files/figure-html/scatter-truffles-1.png" style="display: block; margin: auto;" /&gt;

---

### 松露案例：矩阵散点图

&lt;img src="SEM-slide-part1-why_files/figure-html/unnamed-chunk-1-1.png" style="display: block; margin: auto;" /&gt;

---

### 松露案例：简单线性回归

从最简单线性回归模型开始。通常我们会使用价格(P)和产量(Q)数据直接做简单线性回归建模：

`$$\begin{align}
P &amp; = \hat{\beta}_1+\hat{\beta}_2Q +e_1 &amp;&amp; \text{(simple P model)}\\
Q &amp; = \hat{\beta}_1+\hat{\beta}_2P +e_2  &amp;&amp; \text{(simple Q model)}
\end{align}$$`




---

### 松露案例：简单线性回归

我们都知道，两个变量的线性回归是不对称的，因此有：

.pull-left[

- 简单的价格(P)模型回归结果如下：

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{P}=&amp;&amp;+23.23&amp;&amp;+2.14Q\\ &amp;\text{(t)}&amp;&amp;(1.8748)&amp;&amp;(3.2831)\\&amp;\text{(se)}&amp;&amp;(12.3885)&amp;&amp;(0.6518)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.2780;&amp;&amp; \bar{R^2}=0.2522\\&amp; &amp;&amp; F^{\ast}=10.78;&amp;&amp; p=0.0028 \end{alignedat} \end{equation}$$`

]

.pull-right[

- 简单的数量(Q)模型回归结果如下：

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{Q}=&amp;&amp;+10.31&amp;&amp;+0.13P\\ &amp;\text{(t)}&amp;&amp;(3.9866)&amp;&amp;(3.2831)\\&amp;\text{(se)}&amp;&amp;(2.5863)&amp;&amp;(0.0396)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.2780;&amp;&amp; \bar{R^2}=0.2522\\&amp; &amp;&amp; F^{\ast}=10.78;&amp;&amp; p=0.0028 \end{alignedat} \end{equation}$$`

]

---

### 松露案例：样本回归线1


&lt;img src="SEM-slide-part1-why_files/figure-html/scatter-truffles-left-1.png" style="display: block; margin: auto;" /&gt;

---

### 松露案例：样本回归线2

&lt;img src="SEM-slide-part1-why_files/figure-html/scatter-truffles-right-1.png" style="display: block; margin: auto;" /&gt;


---

### 松露案例：多元线性回归


当然，我们也可以继续使用更多的变量作为自变量X，构建如下的回归模型：

`$$\begin{align}
P &amp; = \hat{\beta}_1+\hat{\beta}_2Q +\hat{\beta}_3DI+\hat{\beta}_2PS +e_1 &amp;&amp; \text{(added P model)}\\
Q &amp; = \hat{\beta}_1+\hat{\beta}_2P +\hat{\beta}_2PF+e_2  &amp;&amp; \text{(added Q model)}
\end{align}$$`



- 我们努力地想让这些方程更加“合理”、“可信”。

---

### 松露案例：多元线性回归


- 增加变量的价格(P)模型回归结果如下：

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{P}=&amp;&amp;-13.62&amp;&amp;+0.15Q&amp;&amp;+12.36DI&amp;&amp;+1.36PS\\ &amp;\text{(t)}&amp;&amp;(-1.4987)&amp;&amp;(0.3032)&amp;&amp;(6.7701)&amp;&amp;(2.2909)\\&amp;\text{(se)}&amp;&amp;(9.0872)&amp;&amp;(0.4988)&amp;&amp;(1.8254)&amp;&amp;(0.5940)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.8013;&amp;&amp; \bar{R^2}=0.7784\\&amp; &amp;&amp; F^{\ast}=34.95;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

- 增加变量的数量(Q)模型回归结果如下：

`$$\begin{equation} \begin{alignedat}{999} &amp;\widehat{Q}=&amp;&amp;+20.03&amp;&amp;+0.34P&amp;&amp;-1.00PF\\ &amp;\text{(t)}&amp;&amp;(16.3938)&amp;&amp;(15.5436)&amp;&amp;(-13.1028)\\&amp;\text{(se)}&amp;&amp;(1.2220)&amp;&amp;(0.0217)&amp;&amp;(0.0764)\\&amp;\text{(fitness)}&amp;&amp; R^2=0.9019;&amp;&amp; \bar{R^2}=0.8946\\&amp; &amp;&amp; F^{\ast}=124.08;&amp;&amp; p=0.0000 \end{alignedat} \end{equation}$$`

---
class: center, middle,duke-orange

## 18.2 联立方程模型的表达和定义

---
layout: true
  
&lt;div class="my-header"&gt;&lt;/div&gt;

&lt;div class="my-footer"&gt;&lt;span&gt;huhuaping@   第18章 为什么要关心联立方程模型   
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
18.2 联立方程模型的表达和定义&lt;/span&gt;&lt;/div&gt; 

---

### 联立方程模型的一般表达：代数式1

联立方程模型形态1：

`$$\begin{alignat}{5}
Y_{t1}&amp;= &amp; &amp;+\gamma_{12}Y_{t2}+&amp;\cdots  &amp;+\gamma_{1m}Y_{tm} &amp; +\beta_{11}X_{1t}+\beta_{12}X_{t2} &amp;+\cdots+\beta_{1k}X_{tk} &amp;+\varepsilon_{t1} \\
Y_{t2}&amp;=&amp;\gamma_{21}Y_{t1} &amp;+  &amp; \cdots &amp;+\gamma_{2m}Y_{tm}&amp;+\beta_{21}X_{t1}+\beta_{22}X_{t2} &amp;+\cdots+\beta_{2k}X_{tk} &amp;+\varepsilon_{t2}\\
&amp; \vdots &amp;\vdots &amp;&amp;\vdots &amp;&amp;\vdots  \\
Y_{tm}&amp;=&amp;\gamma_{m1}Y_{t1}&amp;+\gamma_{m2}Y_{t2}+&amp; \cdots  &amp; &amp;+\beta_{m1}X_{t1} +\beta_{m2}X_{t2} &amp;+\cdots+\beta_{mk}X_{tk} &amp;+\varepsilon_{tm} 
\end{alignat}$$`

.pull-left[
- **内生变量**或联合应变量(m个)：
`\(Y_{1},Y_{2},\cdots,Y_{m}\)`
- **前定变量**(K个):
`\(X_{1},X_{2},\cdots,X_{k}\)`
- **结构随机干扰项**(m个):
`\(\varepsilon_{1},\varepsilon_{2},\cdots,\varepsilon_{m}\)`
]


.pull-right[
- **内生变量系数**
`\(\gamma\)`
- **前定变量系数**
`\(\beta\)`
- **观测个数**
`\(t=1,2,\cdots,T\)`
]

---

### 联立方程模型的定义：内生变量和前定变量

**内生变量**（endogenous vaviables）：由模型决定的变量。

- 如
`\(Y_{t1};Y_{t2}; \cdots; Y_{tm}\)`

--

**前定变量**（predetermined variables）：是**外生变量**和**滞后内生变量**的合称。

- **外生变量**（exdogenous vaviables）：不由模型决定的变量，包括**当前期的**和**滞后期的**

    - 当前期的外生变量
    `\(X_{t1}, X_{t2},\cdots, X_{tk}\)`。
    - 滞后期的外生变量，如
     `\(X_{t1}\)`的外生滞后变量：
     `\(X_{t-1,1}, X_{t-2,1},\cdots, X_{t-(T-1),1}\)`；以及
     `\(X_{tk}\)`的外生滞后变量：
     `\(X_{t-1,k}, X_{t-2,k},\cdots, X_{t-(T-1),k}\)`等。

--

- **滞后内生变量**（lagged endogenous vaviables）：当前时期下内生变量的滞后变量。

  - 如
  `\(Y_{t1}\)`的滞后内生变量：
  `\(Y_{t-1,1}, Y_{t-2,1}, \cdots, Y_{t-(T-1),1}\)`；以及
  `\(Y_{tm}\)`的滞后内生变量：
  `\(Y_{t-1,m}, Y_{t-2,m}, \cdots, Y_{t-(T-1),m}\)`等

---

### 联立方程模型的定义：结构方程和结构参数

**结构方程**（structural equations）：直接刻画经济结构或行为关系的方程系统。

- 见前述**代数式1**

**结构参数**（structural parameters）：结构方程中代表经济结果或行为关系的参数。具体又包括**内生结构系数**和**外生结构系数**

- **内生结构系数**：如上述结构方程中的
`\(\gamma_{11}, \gamma_{12},\cdots, \gamma_{1m}; \cdots; \gamma_{m1}, \gamma_{m2},\cdots, \gamma_{mm}\)`

- **外生结构系数**：如上述结构方程中的
`\(\beta_{11}, \beta_{12},\cdots, \beta_{1m}; \cdots; \beta_{m1}, \beta_{m2},\cdots, \beta_{mm};\)`


---

### 联立方程模型的一般表达：代数式2

联立方程模型形态2：我们也可以将前述**代数式1**整理成如下**代数式2**：

`$$\begin{alignat}{5}
\gamma_{11}Y_{t1} &amp;+ \gamma_{12}Y_{t2}&amp;+\cdots &amp;+\gamma_{m,m-1}Y_{t,m-1} &amp;+\gamma_{1m}Y_{tm} &amp; +\beta_{11}X_{t1}+\beta_{12}X_{t2} &amp;+\cdots+\beta_{1k}X_{tk} &amp;=\varepsilon_{t1} \\
\gamma_{21}Y_{t1} &amp;+\gamma_{22}Y_{t2} &amp;+   \cdots&amp;+\gamma_{m,m-1}Y_{t,m-1} &amp;+\gamma_{2m}Y_{tm}&amp;+\beta_{21}X_{t1}+\beta_{22}X_{t2} &amp;+\cdots+\beta_{2k}X_{tk} &amp;= \varepsilon_{t2}\\
&amp; \vdots &amp;\vdots &amp;&amp;\vdots &amp;&amp;\vdots  \\
\gamma_{m1}Y_{t1}&amp;+\gamma_{m2}Y_{t2}&amp;+ \cdots &amp;+\gamma_{m,m-1}Y_{t,m-1} &amp; +\gamma_{mm}Y_{tm}  &amp;+\beta_{m1}X_{t1} +\beta_{m2}X_{t2} &amp;+\cdots+\beta_{mk}X_{tk} &amp;=\varepsilon_{tm} 
\end{alignat}$$`

---

### 联立方程模型的一般表达：矩阵式

联立方程模型形态3：**矩阵表达**。将上述**代数式2**的m个方程进一步表达为矩阵形式


`$$\begin{equation}
    \begin{bmatrix}
    Y_1 &amp; Y_2 &amp; \cdots &amp; Y_m \\
  \end{bmatrix} _t
  \begin{bmatrix}
    \gamma_{11} &amp; \gamma_{12} &amp; \cdots &amp; \gamma_{1m} \\
    \gamma_{21} &amp; \gamma_{22} &amp; \cdots &amp; \gamma_{2m} \\
    \cdots &amp; \cdots &amp; \cdots  &amp; \cdots \\
    \gamma_{m1} &amp; \gamma_{m2} &amp; \cdots &amp; \gamma_{mm} \\ 
  \end{bmatrix} + \\
  \begin{bmatrix}
    X_1 &amp; X_2 &amp; \cdots &amp; X_m \\
  \end{bmatrix} _t
  \begin{bmatrix}
    \beta_{11} &amp; \beta_{12} &amp; \cdots &amp; \beta_{1m} \\
    \beta_{21} &amp; \beta_{22} &amp; \cdots &amp; \beta_{2m} \\
    \cdots &amp; \cdots &amp; \cdots &amp; \cdots\\
    \beta_{k1} &amp; \beta_{k2} &amp; \cdots &amp; \beta_{km} \\
  \end{bmatrix} \\ =
  \begin{bmatrix}
    \varepsilon_1 &amp; \varepsilon_2 &amp; \cdots &amp; \varepsilon_m \\
  \end{bmatrix} _t
\end{equation}$$`


---

### 联立方程模型的一般表达：矩阵式

进一步可以表达为：

`$$\begin{aligned}
&amp; \boldsymbol{y^{\prime}_t} \boldsymbol{\Gamma} &amp;+ &amp; \boldsymbol{x^{\prime}_t} \boldsymbol{B} &amp;= &amp; \boldsymbol{{\varepsilon^{\prime}_t}} \\
&amp;(1 \ast m)(m \ast m) &amp; &amp; (1 \ast k)(k \ast m) &amp; &amp; (1 \ast m)
\end{aligned}$$`

&lt;br&gt;

**复习本科知识**：加粗大写表示**矩阵**（matrix），加粗小写表示**向量**（vector）。其中**向量**默认情形下都是**列向量**（column vector）。对其**转置**（transpose）即为**行向量**（row vector）。

&gt; **思考提问**：矩阵式与代数式是等价的么？

---

### 联立方程模型的一般表达：矩阵式

对于**内生结构参数矩阵**
`\(\boldsymbol{\Gamma}\)`：

- 为确保每个方程中有一个**因变量**，则矩阵
`\(\boldsymbol{\Gamma}\)`每列中至少有一个元素为1

- 如果矩阵
`\(\boldsymbol{\Gamma}\)`表现为**上三角矩阵**（upper triangular matrix），那么联立方程模型就表现为**递归模型**（recursive model）。

`$$\begin{aligned}
y_{1t} &amp;=&amp; f_{1}\left(\mathbf{x}_{t}\right)+\varepsilon_{t1} \\ 
y_{2t} &amp;=&amp; f_{2}\left(y_{t1}, \mathbf{x}_{t}\right)+\varepsilon_{t2} \\ 
&amp; \vdots &amp; \vdots \\ 
y_{mt} &amp;=&amp; f_{m}\left(y_{t1}, y_{t2}, \ldots, y_{t,m-1}, \mathbf{x}_{t}\right)+\varepsilon_{mt} 
\end{aligned}$$`

对于**外生结构参数矩阵**
`\(\boldsymbol{B}\)`：

---

### 联立方程模型的定义：约简方程和约简系数（代数表达）

**约简型方程**（reduced equations）：仅用**前定变量**和**随机干扰项**来表达一个内生变量的方程。

`$$\begin{alignat}{5}
Y_{t1}&amp;= &amp; &amp;+\gamma_{12}Y_{t2}+&amp;\cdots  &amp;+\gamma_{1m}Y_{tm} &amp; +\beta_{11}X_{1t}+\beta_{12}X_{t2} &amp;+\cdots+\beta_{1k}X_{tk} &amp;+\varepsilon_{t1} \\
Y_{t2}&amp;=&amp;\gamma_{21}Y_{t1} &amp;+  &amp; \cdots &amp;+\gamma_{2m}Y_{tm}&amp;+\beta_{21}X_{t1}+\beta_{22}X_{t2} &amp;+\cdots+\beta_{2k}X_{tk} &amp;+\varepsilon_{t2}\\
&amp; \vdots &amp;\vdots &amp;&amp;\vdots &amp;&amp;\vdots  \\
Y_{tm}&amp;=&amp;\gamma_{m1}Y_{t1}&amp;+\gamma_{m2}Y_{t2}+&amp; \cdots  &amp; &amp;+\beta_{m1}X_{t1} +\beta_{m2}X_{t2} &amp;+\cdots+\beta_{mk}X_{tk} &amp;+\varepsilon_{tm} 
\end{alignat}$$`

以上**结构方程**（代数式1）可以转化为如下**简约方程**：

`$$\begin{alignat}{5}
Y_{t1}&amp;=  &amp; +\pi_{11}X_{t1}+\pi_{12}X_{t2} &amp;+\cdots+\pi_{1k}X_{tk} &amp; + v_{t1} \\
Y_{t2}&amp;=&amp;+\pi_{21}X_{t1}+\pi_{22}X_{t2} &amp;+\cdots+\pi_{2k}X_{tk} &amp; + v_{t2}\\
&amp; \vdots &amp;\vdots &amp;&amp;\vdots &amp;  \\
Y_{tm}&amp;=&amp;+\pi_{m1}X_{t1} +\pi_{m2}X_{t2} &amp;+\cdots+\pi_{mk}X_{tk} &amp; + v_{tm}
\end{alignat}$$`

**约简系数** （reduced coefficients）：约简方程中对应的系数。如
`\(\pi_{11},\pi_{12},\cdots, \pi_{1k}\)`和
`\(\pi_{m1},\pi_{m2},\cdots, \pi_{mk}\)`等。**约简随机干扰项**：指约简方程中的
`\(v_{1},v_2,\cdots, v_m\)`。


---

### 联立方程模型的定义：约简方程和约简系数（矩阵表达）

`$$\begin{alignat}{5}
Y_{t1}&amp;=  &amp; +\pi_{11}X_{t1}+\pi_{12}X_{t2} &amp;+\cdots+\pi_{1k}X_{tk} &amp; + v_{t1} \\
Y_{t2}&amp;=&amp;+\pi_{21}X_{t1}+\pi_{22}X_{t2} &amp;+\cdots+\pi_{2k}X_{tk} &amp; + v_{t2}\\
&amp; \vdots &amp;\vdots &amp;&amp;\vdots &amp;  \\
Y_{tm}&amp;=&amp;+\pi_{m1}X_{t1} +\pi_{m2}X_{t2} &amp;+\cdots+\pi_{mk}X_{tk} &amp; + v_{tm}
\end{alignat}$$`

上述约简方程的代数形式，可以表达为如下矩阵形式：


`$$\begin{equation}
    \begin{bmatrix}
    Y_1 &amp; Y_2 &amp; \cdots &amp; Y_m \\
  \end{bmatrix} _t = \\
  \begin{bmatrix}
    X_1 &amp; X_2 &amp; \cdots &amp; X_m \\
  \end{bmatrix} _t
  \begin{bmatrix}
    \pi_{11} &amp; \pi_{12} &amp; \cdots &amp; \pi_{1m} \\
    \pi_{21} &amp; \pi_{22} &amp; \cdots &amp; \pi_{2m} \\
    \cdots &amp; \cdots &amp; \cdots  &amp; \cdots \\
    \pi_{m1} &amp; \pi_{m2} &amp; \cdots &amp; \pi_{mm} \\ 
  \end{bmatrix}  + 
  \begin{bmatrix}
    v_1 &amp; v_2 &amp; \cdots &amp; v_m \\
  \end{bmatrix} _t
\end{equation}$$`


---

### 联立方程模型的定义：约简方程和约简系数（矩阵表达）

上述矩阵可以进一步表达为：

`$$\begin{aligned}
&amp; \boldsymbol{y^{\prime}_t} &amp; =  &amp;-\boldsymbol{x^{\prime}_t} \boldsymbol{\Pi}  &amp; + &amp; \boldsymbol{{v^{\prime}_t}}  \\
&amp;(1 \ast m) &amp; &amp; (1 \ast k)(k \ast m) &amp; &amp;  (1 \ast m) 
\end{aligned}$$`

并进一步记为：

`$$\begin{aligned}
 &amp; \boldsymbol{y^{\prime}_t} &amp; =  &amp;-\boldsymbol{x^{\prime}_t} \boldsymbol{B} \boldsymbol{\Gamma^{-1}} &amp; + &amp; \boldsymbol{{\varepsilon^{\prime}_t}} \boldsymbol{\Gamma}^{-1}  \\
&amp;(1 \ast m) &amp; &amp; (1 \ast k)(k \ast m)(m \ast m) &amp; &amp;  (1 \ast m)(m \ast m) 
\end{aligned}$$`

从而结构方程系数（/随机干扰项）和约简方程系数（/随机干扰项）有如下对应关系：

`$$\begin{align}
\boldsymbol{\Pi} &amp;= \boldsymbol{B} \boldsymbol{\Gamma^{-1}} \\
\boldsymbol{{v^{\prime}_t}}  &amp;= \boldsymbol{{\varepsilon^{\prime}_t}} \boldsymbol{\Gamma}^{-1}
\end{align}$$`

&gt; **思考提问**：怎样把一个结构模型，表达为约简模型？

---

### 联立方程模型的定义：随机干扰项的方差协方差矩阵

结构方程随机干扰项
`\(\boldsymbol{{\varepsilon^{\prime}_t}}\)`：

`$$\begin{aligned}
 \boldsymbol{y^{\prime}_t} \boldsymbol{\Gamma} +  \boldsymbol{x^{\prime}_t} \boldsymbol{B} =  \boldsymbol{{\varepsilon^{\prime}_t}} 
\end{aligned}$$`

约简方程随机干扰项
`\(\boldsymbol{{v^{\prime}_t}}\)`：

`$$\begin{aligned}
 \boldsymbol{y^{\prime}_t}  =  -\boldsymbol{x^{\prime}_t} \boldsymbol{\Pi}   +  \boldsymbol{{v^{\prime}_t}}  
 &amp;=  -\boldsymbol{x^{\prime}_t} \boldsymbol{B} \boldsymbol{\Gamma^{-1}}  +  \boldsymbol{{\varepsilon^{\prime}_t}} \boldsymbol{\Gamma}^{-1} \\
 \boldsymbol{y^{\prime}_t}    +\boldsymbol{x^{\prime}_t} \boldsymbol{\Pi}   &amp;=  \boldsymbol{{v^{\prime}_t}}  
\end{aligned}$$`

假设**结构随机干扰项**期望为0，方差为常数。也即：
`\(\mathbf{E[\varepsilon_t | x_t] = 0}; \mathbf{E[\varepsilon_t \varepsilon^{\prime}_t |x_t] = \Sigma }\)`

则容易证明**约简随机干扰项**的期望和方差分别为：

`$$\begin{align}
E\left[\mathbf{v}_{t} | \mathbf{x}_{t}\right] &amp;=\left(\mathbf{\Gamma}^{-1}\right)^{\prime} \mathbf{0}=\mathbf{0} \\ E\left[\mathbf{v}_{t} \mathbf{v}_{t}^{\prime} | \mathbf{x}_{t}\right] &amp;=\left(\mathbf{\Gamma}^{-1}\right)^{\prime} \mathbf{\Sigma} \mathbf{\Gamma}^{-1}=\mathbf{\Omega} \\
\mathbf{\Sigma} &amp;=\mathbf{\Gamma}^{\prime} \mathbf{\Omega} \mathbf{\Gamma}
\end{align}$$`

---

### 联立方程模型的定义：常用样本统计量



给定全部
`\(T\)`个样本数据集：

`$$\begin{align}
\left[\begin{array}{lll}{\mathbf{Y}} &amp; {\mathbf{X}} &amp; {\mathbf{E}}\end{array}\right]=\left[\begin{array}{ccc}{\mathbf{y}_{1}^{\prime}} &amp; {\mathbf{x}_{1}^{\prime}} &amp; {\boldsymbol{\varepsilon}_{1}^{\prime}} \\ {\mathbf{y}_{2}^{\prime}} &amp; {\mathbf{x}_{2}^{\prime}} &amp; {\boldsymbol{\varepsilon}_{2}^{\prime}} \\ {\vdots} &amp; {} \\ {\mathbf{y}_{T}^{\prime}} &amp; {\mathbf{x}_{T}^{\prime}} &amp; {\boldsymbol{\varepsilon}_{T}^{\prime}}\end{array}\right]
\end{align}$$`

则联立方程可以记为：

`$$\begin{align}
\mathbf{Y} \mathbf{\Gamma}+\mathbf{X} \mathbf{B}=\mathbf{E}
\end{align}$$`

结构随机干扰项期望和方差可以记为：

`$$\begin{align}
E[\mathbf{E} | \mathbf{X}] &amp;=\mathbf{0} \\ 
E\left[(1 / T) \mathbf{E}^{\prime} \mathbf{E} | \mathbf{X}\right] &amp;=\mathbf{\Sigma}
\end{align}$$`


---

### 联立方程模型的定义：常用样本统计量


假设如下条件成立：

`$$\begin{align}
(1 / T) \mathbf{X}^{\prime} \mathbf{X} &amp; \rightarrow \mathbf{Q} \\
(1 / T) \mathbf{X}^{\prime} \mathbf{E} &amp; \rightarrow \mathbf{0}
\end{align}$$`

则约简方程可以记为：

`$$\begin{align}
\mathbf{Y} &amp; =\mathbf{X} \boldsymbol{\Pi}+\mathbf{V} &amp;&amp; \leftarrow  \mathbf{V}=\mathbf{E} \mathbf{\Gamma}^{-1}
\end{align}$$`

从而可以得到如下常用统计量：

`$$\begin{align}
\frac{1}{T}
  \begin{bmatrix}
    {\mathbf{Y}^{\prime}} \\ 
    {\mathbf{X}^{\prime}} \\ 
{\mathbf{V}^{\prime}}
  \end{bmatrix}
  \begin{bmatrix}
    {\mathbf{Y}} &amp; {\mathbf{X}} &amp; {\mathbf{V}}
  \end{bmatrix}
\quad \rightarrow  \quad
  \begin{bmatrix}
    {\mathbf{I}^{\prime} \mathbf{Q} \mathbf{I}+\mathbf{\Omega}} &amp; {\mathbf{I} \mathbf{I}^{\prime} \mathbf{Q}} &amp; {\mathbf{\Omega}} \\
    {\mathbf{Q} \mathbf{I}} &amp; {\mathbf{Q}} &amp; {\mathbf{0}^{\prime}} \\ {\mathbf{\Omega}} &amp; {\mathbf{0}} &amp; {\mathbf{\Omega}}
  \end{bmatrix}
\end{align}$$`



---

### 案例1：凯恩斯收入决定模型（2方程模型）

以凯恩斯收入决定的联立方程为例（结构模型）：

`$$\begin{cases}
  \begin{align}
    C_t &amp;= \beta_0+\beta_1Y_t+\varepsilon_t &amp;&amp;\text{(消费函数)}\\
    Y_t &amp;= C_t+I_t &amp;&amp;\text{(收入恒等式)}
  \end{align}
\end{cases}$$`

上述结构模型中：

**内生变量**有2个：
`\(c_t;Y_t\)`

**前定变量**有1个，其中：

- **外生变量**有1个：
`\(I_t\)`

- **滞后内生变量**有0个

&gt; **思考提问**：怎样把这个结构模型转变为约简模型？（考点）

---

### 案例1：凯恩斯收入决定模型（2方程模型）

上述**结构模型**，可以变换为为如下**约简方程**：

`$$\begin{cases}
  \begin{align}
    Y_t &amp;=\frac{\beta_0}{1-\beta_1}+\frac{1}{1-\beta_1}I_t+\frac{\varepsilon_t}{1-\beta_1}
&amp;&amp;\text{(变换方程1)} \\
    C_t &amp;=\frac{\beta_0}{1-\beta_1}+\frac{\beta_1}{1-\beta_1}I_t+\frac{\varepsilon_t}{1-\beta_1}
&amp;&amp;\text{(变换方程2)}
  \end{align}
\end{cases}$$`

进一步可记为如下约简方程形式：

`$$\begin{cases}
  \begin{align}
    Y_t &amp;= \pi_{11}+\pi_{12}I_t+v_{t1} &amp;&amp;\text{(约简方程1)}\\
    C_t &amp;= \pi_{21}+\pi_{22}I_t+v_{t2} &amp;&amp;\text{(约简方程2)}
  \end{align}
\end{cases}$$`

易知：**结构系数**共有2个
`\(\beta_0;\beta_1\)`；而**约简系数**共有4个
`\(\pi_{11},\pi_{12};\pi_{21},\pi_{22}\)`（实际上只有3个！）



---

### 案例1：凯恩斯收入决定模型（2方程模型）

其中**约简系数**和**结构系数**的关系为：

`$$\begin{cases}
  \begin{align}
    \pi_{11} &amp; = \frac{\beta_0}{1-\beta_1}; 
    &amp; \pi_{12} &amp; = \frac{1}{1-\beta_1} &amp; \\ 
    \pi_{21} &amp; = \frac{\beta_0}{1-\beta_1}; 
    &amp; \pi_{22} &amp; = \frac{\beta_1}{1-\beta_1} \\
    v_{t1} &amp; = \frac{\varepsilon_t}{1-\beta_1};&amp; v_{t2} &amp; = \frac{\varepsilon_t}{1-\beta_1}
  \end{align}
\end{cases}$$`



---

### 案例2：小型宏观经济模型（3方程联立模型）

考虑如下的**小型宏观经济模型**（结构方程）：

`$$\begin{cases}
  \begin{aligned} 
    \text { consumption: }  c_{t} &amp;=\alpha_{0}+\alpha_{1} y_{t}+\alpha_{2} c_{t-1}+\varepsilon_{t, c} \\ 
    \text { investment: }  i_{t} &amp;=\beta_{0}+\beta_{1} r_{t}+\beta_{2}\left(y_{t}-y_{t-1}\right)+\varepsilon_{t, j} \\ 
    \text { demand: }  y_{t} &amp;=c_{t}+i_{t}+g_{t} 
  \end{aligned}
\end{cases}$$`

其中：
`\(c_t\)`表示消费；
`\(y_t\)`表示产出；
`\(i_t\)`表示投资；
`\(r_t\)`表示利率；
`\(g_t\)`表示政府支出。


**内生变量**有3个：
`\(c_t;i_t;Y_t\)`

**前定变量**有4个，其中：

- **外生变量**有2个：
`\(r_t;g_t\)`

- **滞后内生变量**有2个：
`\(y_{t-1};c_{t-1}\)`

结构系数共有6个：
`\(\alpha_0,\alpha_1,\alpha_2;\beta_0,\beta_1,\beta_2;\)`

---

### 案例2：小型宏观经济模型（3方程联立模型）

上述**结构方程**可以变换为如下**约简方程**：（HOW TO??）

`$$\begin{cases}
  \begin{align}
    c_{t}  = &amp;  [{\alpha_{0}}{\left(1-\beta_{2}\right)}+\beta_{0} \alpha_{1}+\alpha_{1} \beta_{1}  r_{t}+\alpha_{1} g_{t}+\alpha_{2}\left(1-\beta_{2}\right) c_{t-1}-\alpha_{1} \beta_{2} y_{t-1} \\
    +&amp;\left(1-\beta_{2}\right) \varepsilon_{t, c}+\alpha_{1} \varepsilon_{t, j}] /{\Lambda} \\ 
    i_{t}  = &amp; [\alpha_{0} \beta_{2}+\beta_{0}\left(1-\alpha_{1}\right)+\beta_{1}\left(1-\alpha_{1}\right) r_{t}+\beta_{2} g_{t}+\alpha_{2} \beta_{2} c_{t-1}-\beta_{2}\left(1-\alpha_{1}\right) y_{t-1} \\
    +&amp;\beta_{2} \varepsilon_{t, c}+\left(1-\alpha_{1}\right) \varepsilon_{t, j}]/{\Lambda} \\ 
    y_{t} = &amp; [\alpha_{0}+\beta_{0}+\beta_{1} r_{t}+g_{t}+\alpha_{2} c_{t-1}-\beta_{2} y_{t-1}
    +\varepsilon_{t, c}+\varepsilon_{t, j}] /{\Lambda} 
  \end{align}
\end{cases}$$`

其中：
`\(\Lambda = 1- \alpha_1 -\beta_2\)`。或者将上述**约简方程**记为：

`$$\begin{cases}
  \begin{aligned}
    c_{t} &amp; =  \pi_{11} +\pi_{12}r_t +\pi_{13}g_t +\pi_{14}c_{t-1} +\pi_{15}y_{t-1} +v_{t1} \\
    i_{t} &amp; =  \pi_{21} +\pi_{22}r_t +\pi_{23}g_t +\pi_{24}c_{t-1} +\pi_{25}y_{t-1} +v_{t2} \\
    i_{t} &amp; =  \pi_{31} +\pi_{32}r_t +\pi_{33}g_t +\pi_{34}c_{t-1} +\pi_{35}y_{t-1} +v_{t3}
  \end{aligned}
\end{cases}$$`

易知**约简系数**共有15个！！

---

### 案例2：小型宏观经济模型（3方程联立模型）

**思考**：

- 结构方程和约简方程有什么用？

--

- （结构方程中的）消费函数，利率
`\(i_t\)`不会对消费
`\(c_t\)`产生影响？

    - 从约简方程中则可以很快得到答案
    `\(\frac{\Delta c_t}{\Delta r_t} = \frac{\alpha_1 \beta_1}{\Lambda}\)`

--

- （结构方程中的）消费函数，收入
`\(y_t\)`对消费
`\(c_t\)`产生影响，具体是来自什么原因？

    - 进行中介变换也容易得到答案
    `\(\frac{\Delta c_t}{ \Delta y_t} = \frac{\Delta c_t / \Delta r_t}{\Delta y_t / \Delta r_t} = \frac{\alpha_1 \beta_1 / \Lambda}{ \beta_1 / \Lambda} = \alpha_1\)`

---

### 案例2：小型宏观经济模型（3方程联立模型）

因为约简方程的矩阵形式可以表达为：

`$$\begin{aligned}
 \boldsymbol{y^{\prime}_t}  =  &amp;-\boldsymbol{x^{\prime}_t} \boldsymbol{\Pi}   +  \boldsymbol{{v^{\prime}_t}}  
 =  -\boldsymbol{x^{\prime}_t} \boldsymbol{B} \boldsymbol{\Gamma^{-1}}  +  \boldsymbol{{\varepsilon^{\prime}_t}} \boldsymbol{\Gamma}^{-1} 
\end{aligned}$$`

容易得到如下相关矩阵：

.pull-left[

`$$\begin{align}
\mathbf{y}^{\prime} &amp; =
  \begin{bmatrix}
    c &amp; i &amp; y
  \end{bmatrix}\\
\mathbf{x}^{\prime} &amp; =
  \begin{bmatrix}
    1 &amp; r &amp; g &amp; c_{-1} &amp; y_{-1}
  \end{bmatrix}
\end{align}$$`

`$$\begin{align}
\mathbf{B}=
  \begin{bmatrix}
    {-\alpha_{0}} &amp; {-\beta_{0}} &amp; {0} \\
    {0} &amp; {-\beta_{1}} &amp; {0} \\ 
    {0} &amp; {0} &amp; {-1} \\ {-\alpha_{2}} &amp; {0} &amp; {0} \\ 
    {0} &amp; {\beta_{2}} &amp; {0}
  \end{bmatrix}
\end{align}$$`

]


.pull-right[

`$$\begin{align}
\Gamma &amp;= 
  \begin{bmatrix}
    {1} &amp; {0} &amp; {-1} \\ 
   {0} &amp; {1} &amp; {-1} \\
    {-\alpha_{1}} &amp; {-\beta_{2}} &amp; {1}
  \end{bmatrix} \\
  \mathbf{\Gamma}^{-1} &amp;=\frac{1}{\Lambda}
  \begin{bmatrix}
    {1-\beta_{2}} &amp; {\beta_{2}} &amp; {1} \\ 
    {\alpha_{1}} &amp; {1-\alpha_{1}} &amp; {1} \\ 
    {\alpha_{1}} &amp; {\beta_{2}} &amp; {1}
  \end{bmatrix}
\end{align}$$`




]

---

### 案例2：小型宏观经济模型（3方程联立模型）

根据约简方程的矩阵表达式：

`$$\begin{aligned}
 \boldsymbol{y^{\prime}_t}  =  &amp;-\boldsymbol{x^{\prime}_t} \boldsymbol{\Pi}   +  \boldsymbol{{v^{\prime}_t}}  
 =  -\boldsymbol{x^{\prime}_t} \boldsymbol{B} \boldsymbol{\Gamma^{-1}}  +  \boldsymbol{{\varepsilon^{\prime}_t}} \boldsymbol{\Gamma}^{-1} 
\end{aligned}$$`

根据前述计算结果，则可以得到约简系数与结构系数的关系为：

`$$\begin{align}
\boldsymbol{\Pi}^{\prime}=\frac{1}{\Lambda}
  \begin{bmatrix}
    {\alpha_{0}\left(1-\beta_{2}\right)+\beta_{0} \alpha_{1}} &amp; {\alpha_{1} \beta_{1}} &amp; {\alpha_{1}} &amp; {\alpha_{2}\left(1-\beta_{2}\right)} &amp; {-\beta_{2} \alpha_{1}} \\ 
    {\alpha_{0} \beta_{2}+\beta_{0}\left(1-\alpha_{1}\right)} &amp; {\beta_{1}\left(1-\alpha_{1}\right)} &amp; {\beta_{2}} &amp; {\alpha_{2} \beta_{2}} &amp; {-\beta_{2}\left(1-\alpha_{1}\right)} \\ 
    {\alpha_{0}+\beta_{0}} &amp; {\beta_{1}} &amp; {1} &amp; {\alpha_{2}} &amp; {-\beta_{2}}
  \end{bmatrix}
\end{align}$$`

其中：
`\(\Lambda = 1- \alpha_1 -\beta_2\)`。

&gt; **难点**：矩阵的逆的计算。

&gt; 掌握了就是快刀一把，手起刀落，麻利干脆！

---

### 附录：逆矩阵求解方法和步骤

A.用初等行运算（高斯－若尔当）来求逆矩阵：

1. 构造**增广矩阵**

2. 对增广矩阵进行多次变换，直至达到目标。


&lt;br&gt;

B.用余子式、代数余子式和伴随来求逆矩阵

1. 计算**余子式矩阵**和**代数余子式矩阵**

2. 计算**伴随矩阵**：就是代数余子式矩阵的**转置**

3. 计算原矩阵**行列式**：原矩阵**顶行**的每个元素乘以其对应"代数余子式矩阵"**顶行**元素。

4. 计算得出逆矩阵：**1/行列式** X **伴随矩阵**




---
class: center, middle,duke-orange

## 18.3 OLS估计方法还合适么？

---
layout: true
  
&lt;div class="my-header"&gt;&lt;/div&gt;

&lt;div class="my-footer"&gt;&lt;span&gt;huhuaping@   第18章 为什么要关心联立方程模型   
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;&amp;emsp;
18.3 OLS估计方法还合适么？&lt;/span&gt;&lt;/div&gt; 

---

### 内生变量问题

以凯恩斯收入决定模型为例，我们将可以证明
`\(Y_t\)`
和
`\(u_t\)`
将会出现相关，从而违背CLRM假设。

`$$\begin{cases}
  \begin{align}
    C_t &amp;= \beta_0+\beta_1Y_t+u_t   &amp;(0&lt;\beta_1&lt;1)  &amp;&amp;\text{(消费函数)}\\
    Y_t &amp;= C_t+I_t  &amp; &amp;&amp;\text{(收入恒等式)}
  \end{align}
\end{cases}$$`

将上述结构方程进行变换，得到：

`$$\begin{align}
Y_t &amp;= \beta_0+\beta_1Y_t+ I_t +u_t   \\
Y_t &amp;= \frac{\beta_0}{1-\beta_1}+\frac{1}{1-\beta_1}I_t+\frac{1}{1-\beta_1}u_t   &amp;&amp; \text{(式1：约简方程)}\\
E(Y_t)&amp;=\frac{\beta_0}{1-\beta_1}+\frac{1}{1-\beta_1}I_t &amp;&amp; \text{(式2：两边取期望)} 
\end{align}$$`

---

### 内生变量问题

进一步地：

`$$\begin{align}
Y_t - E(Y_t)&amp; = \frac{u_t}{1-\beta_1} &amp;&amp; \text{(式1 - 式2)}\\
u_t-E(u_t) &amp;= u_t &amp;&amp; \text{(式3：期望等于0)} \\
cov(Y_t,u_t) &amp;= E([Y_t-E(Y_t)][u_t-E(u_t)])  &amp;&amp; \text{(式4：协方差定义式)}\\ 
&amp;=\frac{E(u^2_t)}{1-\beta_1} &amp;&amp; \text{(式5：方差定义式)}\\
&amp;=\frac{\sigma^2}{1-\beta_1}\neq 0 &amp;&amp; \text{(式6：方差不为0)}
\end{align}$$`

因此，凯恩斯模型的需求方程，将会不满足CLRM假设中
`\(Y_t\)`
与
`\(u_t\)`
不相关的假设。从而使用OLS方法对需求方程不能得到**最优线性无偏估计量**（BLUE）。

---

### 系数的OLS估计量是有偏的

下面将进一步证明，使用OLS方法估计
`\(\beta_1\)`
是有偏的，也即
`\(E(\hat{\beta}_1) \neq \beta_1\)`。证明过程如下：

`$$\begin{cases}
  \begin{align}
    C_t &amp;= \beta_0+\beta_1Y_t+u_t   &amp;(0&lt;\beta_1&lt;1)  &amp;&amp;\text{(消费函数)}\\
    Y_t &amp;= C_t+I_t  &amp; &amp;&amp;\text{(收入恒等式)}
  \end{align}
\end{cases}$$`

`$$\begin{align}
\hat{\beta}_1 
= \frac{\sum{c_ty_t}}{\sum{y^2_t}}
= \frac{\sum{C_ty_t}}{\sum{y^2_t}}
= \frac{\sum{\left [ (\beta_0+\beta_1Y_t+u_t)y_t \right ]}}{\sum{y^2_t}} 
 = \beta_1 + \frac{\sum{u_ty_t}}{\sum{y^2_t}} 
&amp;&amp; \text{(式1)}
\end{align}$$`

对式1两边取期望，因此有：

`$$\begin{align}
E(\hat{\beta}_1) &amp;= \beta_1 + E \left ( \frac{\sum{u_ty_t}}{\sum{y^2_t}} \right )
\end{align}$$`

问题是：
`\(E \left ( \frac{\sum{u_ty_t}}{\sum{y^2_t}} \right )\)`
是否等于0？我们可以证明它将不等于0（证明过程见后）。

---

### 证明附录1

`$$\begin{align}
 \frac{\sum{c_ty_t}}{\sum{y^2_t}}
&amp;= \frac{\sum{(C_t-\bar{C})(Y_t - \bar{Y})}}{\sum{y^2_t}}
= \frac{\sum{(C_t-\bar{C})y_t}}{\sum{y^2_t}} \\
&amp; =\frac{\sum{C_ty_t}-\sum{\bar{C}y_t}}{\sum{y^2_t}}
 =\frac{\sum{C_ty_t}-\sum{\bar{C}(Y_t- \bar{Y})}}{\sum{y^2_t}} \\
&amp; = \frac{\sum{C_ty_t}-\bar{C}\sum{Y_t}- \sum{\bar{C}\bar{Y}}}{\sum{y^2_t}} 
= \frac{\sum{C_ty_t}-\bar{C}\sum{Y_t}- n{\bar{C}\bar{Y}}}{\sum{y^2_t}}
= \frac{\sum{C_ty_t}}{\sum{y^2_t}}
\end{align}$$`

`$$\begin{align}
\hat{\beta_1} &amp; = \frac{\sum\left(\beta_{0}+\beta_{1} Y_{t}+u_{t}\right) y_{t}}{\sum y_{t}^{2}} 
= \frac{\sum{\beta_{0}y_t} +\sum{\beta_1Y_ty_t}+\sum{u_{t}y_t} }{\sum y_{t}^{2}} \\
&amp; = \frac{\beta_1\sum{(y_t+\bar{Y})y_t}+\sum{u_{t}y_t} }{\sum y_{t}^{2}}
=\beta_{1}+\frac{\sum y_{t} u_{t}}{\sum y_{t}^{2}}
\end{align}$$`

`$$\begin{align}
 \Leftarrow &amp;\sum{y_t} =0  ; &amp;&amp;  \frac{\sum{Y_ty_t}}{y^2_t} = 1
\end{align}$$`

---

### 证明附录2

依概率取极限：

`$$\begin{align}
\operatorname{plim}\left(\hat{\beta}_{1}\right) &amp;=\operatorname{plim}\left(\beta_{1}\right)+\operatorname{plim}\left(\frac{\sum y_{t} u_{t}}{\sum y_{t}^{2}}\right) \\
&amp;=\operatorname{plim}\left(\beta_{1}\right)+\operatorname{plim}\left(\frac{\sum y_{t} u_{t} / n}{\sum y_{t}^{2} / n}\right) =\beta_{1}+\frac{\operatorname{plim}\left(\sum y_{t} u_{t} / n\right)}{\operatorname{plim}\left(\sum y_{t}^{2} / n\right)} 
\end{align}$$`

而我们已经证明过：

`$$\begin{align}
cov(Y_t,u_t) &amp;= E([Y_t-E(Y_t)][u_t-E(u_t)])  =\frac{E(u^2_t)}{1-\beta_1} 
=\frac{\sigma^2}{1-\beta_1}\neq 0 
\end{align}$$`

因此，
`\(E \left ( \frac{\sum{u_ty_t}}{\sum{y^2_t}} \right ) \neq 0\)`得证。

---

### 数值模拟：人为控制的总体

`$$\begin{align}
C_t &amp;= \beta_0+\beta_1Y_t+u_t   &amp;(0&lt;\beta_1&lt;1)  &amp;&amp;\text{(消费函数)}\\
Y_t &amp;= C_t+I_t  &amp; &amp;&amp;\text{(收入恒等式)}
\end{align}$$`

`$$\begin{align}
C_t &amp;= 2+ 0.8Y_t+u_t   &amp;(0&lt;\beta_1&lt;1)  &amp;&amp;\text{(消费函数)}\\
Y_t &amp;= C_t+I_t  &amp; &amp;&amp;\text{(收入恒等式)}
\end{align}$$`

人为控制的总体被设置为：

- `\(\beta_0=2, \beta_1=0.8, I_t \leftarrow \text{给定值}\)`

- `\(E(u_t)=0, var(u_t)=\sigma^2=0.04\)`

- `\(E(u_tu_{t+j})=0,j \neq 0\)`

- `\(cov(u_t,I_t)=0\)`

---

### 数值模拟：模拟数据集

给定条件下的模拟数据为：

<div id="htmlwidget-bfda2f1872e7bff0ba17" style="width:100%;height:auto;" class="datatables html-widget"></div>
<script type="application/json" data-for="htmlwidget-bfda2f1872e7bff0ba17">{"x":{"filter":"none","caption":"<caption><\/caption>","data":[["1","2","3","4","5","6","7","8","9","10","11","12","13","14","15","16","17","18","19","20"],[18.15697,19.5998,21.93468,21.55145,21.88427,22.42648,25.4094,22.69523,24.36465,24.39334,24.09215,24.8745,25.3158,26.30465,25.78235,26.08018,27.2444,28.00963,30.89301,28.98706],[16.15697,17.5998,19.73468,19.35145,19.48427,20.02648,22.8094,20.09523,21.56465,21.59334,21.09215,21.8745,22.1158,23.10465,22.38235,22.68018,23.6444,24.40963,27.09301,25.18706],[2,2,2.2,2.2,2.4,2.4,2.6,2.6,2.8,2.8,3,3,3.2,3.2,3.4,3.4,3.6,3.6,3.8,3.8],[-0.368606,-0.0800400000000003,0.186935999999999,0.110289999999999,-0.0231460000000041,0.085295999999996,0.481879999999997,-0.0609539999999988,0.0729299999999995,0.0786680000000004,-0.181570000000001,-0.0251000000000019,-0.136839999999999,0.060929999999999,-0.243530000000003,-0.183964,-0.151119999999999,0.00192599999999743,0.378601999999997,-0.00258800000000292]],"container":"<table class=\"display\">\n  <thead>\n    <tr>\n      <th> <\/th>\n      <th>Y<\/th>\n      <th>C<\/th>\n      <th>I<\/th>\n      <th>u<\/th>\n    <\/tr>\n  <\/thead>\n<\/table>","options":{"dom":"tip","columnDefs":[{"className":"dt-center","targets":"_all"},{"visible":false,"targets":0},{"orderable":false,"targets":0}],"pageLength":8,"digits":4,"order":[],"autoWidth":false,"orderClasses":false,"lengthMenu":[8,10,25,50,100],"rowCallback":"function(row, data) {\nDTWidget.formatRound(this, row, data, 1, 4, 3, \",\", \".\");\nDTWidget.formatRound(this, row, data, 2, 4, 3, \",\", \".\");\nDTWidget.formatRound(this, row, data, 4, 4, 3, \",\", \".\");\n}"}},"evals":["options.rowCallback"],"jsHooks":[]}</script>

---

### 数值模拟：手工计算

根据前述公式，可以计算得到回归系数：

容易计算出：
`\(\sum{u_ty_t}\)`
=3.8000

以及:
`\(\sum{y^2_t}\)`
=184.0000

以及：
`\(\frac{\sum{u_ty_t}}{\sum{y^2_t}}\)`
=0.0207

因此：
`\(\hat{\beta}_1 = \beta_1 + \frac{\sum{u_ty_t}}{\sum{y^2_t}}\)`
=0.8+0.0207= 0.8207

这也意味着：
`\(\hat{\beta_1}\)` 
比真值
`\(\beta_1=0.8\)`
有0.0207的偏差。

---

### 数值模拟：散点图

&lt;img src="SEM-slide-part1-why_files/figure-html/scatter-YC-1.png" style="display: block; margin: auto;" /&gt;

---

### 数值模拟：回归报告1

下面我们利用模拟的数据，进行回归分析，得到原始报告：


```

Call:
lm(formula = mod_monte$mod.C, data = monte)

Residuals:
    Min      1Q  Median      3Q     Max 
-0.2700 -0.1586 -0.0013  0.0927  0.4631 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)   1.4940     0.3541    4.22  0.00052 ***
Y             0.8207     0.0143   57.21  &lt; 2e-16 ***
---
Signif. codes:  
0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.2 on 18 degrees of freedom
Multiple R-squared:  0.995,	Adjusted R-squared:  0.994 
F-statistic: 3.27e+03 on 1 and 18 DF,  p-value: &lt;2e-16
```

---

### 数值模拟：回归报告2

下面我们对原始报告进行整理，得到精简报告：

`$$\begin{alignedat}{999}
&amp;\widehat{C}=&amp;&amp;+1.49&amp;&amp;+0.82Y\\
&amp;\text{(t)}&amp;&amp;(4.2188)&amp;&amp;(57.2090)\\
&amp;\text{(se)}&amp;&amp;(0.3541)&amp;&amp;(0.0143)\\
&amp;\text{(fitness)}&amp;&amp; n=20;&amp;&amp; R^2=0.9945;&amp;&amp; \bar{R^2}=0.9942\\
&amp; &amp;&amp; F^{\ast}=3272.87;&amp;&amp; p=0.0000\\
\end{alignedat}$$`

这样直接OLS回归的结果也表明是有偏的。


---

### 数值模拟：样本回归线

这是样本回归线。

&lt;img src="SEM-slide-part1-why_files/figure-html/scatter-YC-fit-1.png" style="display: block; margin: auto;" /&gt;


---

### 结论和要点


- 与单方程模型对比，联立方程模型涉及多于一个因变量或内生变量，从而有多少个内生变量就需要有多少个方程。

- 联立方程模裂的一个特有性质是，一个方程中的内生变量(即回归子)作为解释变量而出现在方程组的另一个方程之中。

- 这使得内生解释变量变成了随机的，而且常常和它作为解释变量所在方程中的误差项有相关关系。

- 在这种情况下，经典OLS未必适用，因为这样得到的估计量是不一致的。就是说，不管样本容量有多大，这些估计量都不会收敛于其真实总体值

- 凯恩斯模型的蒙特卡洛模拟，说明了当一个回归方程中的回归元与干扰项相关时(这正是联立方程模型的典型情况) ，用OLS方法估计其参数会内在地导致偏误。


---
layout:false
background-image: url("pic/thank-you-gif-funny-little-yellow.gif")
class: inverse,center
# 本章结束
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"highlightStyle": "github",
"highlightLines": true,
"countIncrementalSlides": false,
"ratio": "16:9"
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
