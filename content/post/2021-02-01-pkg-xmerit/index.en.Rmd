---
title: R包开发：xmerit
author: huhuaping
date: '2021-02-01'
slug: pkg-xmerit
categories:
  - Econometrics
  - R
tags:
  - package
subtitle: ''
summary: ''
authors: []
lastmod: '2021-02-01T21:12:57+08:00'
featured: no
image:
  caption: ''
  focal_point: ''
  preview_only: no
projects: []
output:
  blogdown::html_page:
    toc: true
    number_sections: true
---

# 缘由

> R包`xmetrics`定位于辅助计量经济学和统计学课程进行高效的、可重现的（reproducable）教学内容准备和演示。

R包命名的原则应该坚持：a.词形或发音与表意一致性，也即与开发R包核心功能定位的一致；b.不能太范化或通用，避免后期用户搜索的混淆，或推广传播的混乱。

拟定开发的R包命名`xmetrics`，音近于计量经济学英文**Econometrics**，`X`也有多种用途或神通广大的含义，而且metrics本身就是测量或度量的含义。通过google搜索关键词"xmetrics"的重合度或范化度，仅发现一款游泳穿戴设备名为"Xmetrics"（见[网页](https://swimswam.com/xmetrics-the-worlds-first-activity-tracker-for-swimmers/)）。继续google搜索关键词"R xmetrics"，发现一个定位为机器学习（Machine Learning）的R包命名为"Metrics"（见[CRAN](https://cran.r-project.org/web/packages/Metrics/index.html)）。



```{r, echo=FALSE, comment="", eval=FALSE}
require("xmerit")

lx.est
```


功能类似R包主要有：

- `equatiomatic`（见github仓库[datalorax/equatiomatic](https://github.com/datalorax/equatiomatic)）

> The goal of `equatiomatic` is to reduce the pain associated with writing LaTeX code from a fitted model. In the future, the package aims to support any model supported by `broom`.


# 开发思路

math equation输出需要考虑的几个方面：

- 支持纯latex符号公式（symbol equation）、模型结果数值化（value equation）以及二者的混合；

- 支持计量经济学数学公式（math equation）的各类理论表达，如总体回归模型PRM、总体回归函数PRF、样本回归模型（SRM）、样本回归函数（SRF）等；

- 支持多种latex美化效果，包括`align`、`alignedat`等排列对齐环境；

- 支持灵活个性化的参数符号（如$\alpha,\beta,\gamma,\cdots$）和下标符号（如$X_i, u_i, u_t$）选择等；

- 支持多种模型估计方法，包括OLS回归、虚拟变量回归（ANOVA）等；

- 与通用R包保持接口一致，如包`broom`等；





# 一些工具函数

## 将xls文件高保真地转换为xlsx文件

- R函数名称：convert_xls_as_xlsx(input_dir, export_dir)

- R代码位置："D:/github/article-west/R/xls2xlsx.R"

## df数据列元素进行快速粘合输出

```{r, eval=FALSE, echo=FALSE}
#----- fun get pasted string of df column --------
pasted.str <- function(dt, v){
  out <- paste0(paste0("'", unlist(unique(dt[,v])), "'"), collapse = ",")
  return(out)
}

```



